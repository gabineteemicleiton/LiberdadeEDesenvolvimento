<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Painel Administrativo - Liberdade & Desenvolvimento</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Leaflet.js para Mapa Interativo -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="user-authentication.js"></script>
    
    <!-- jsPDF para geração de relatórios -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    
    <style>
        .card-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
            margin-top: 20px;
        }
        .card {
            background-color: white;
            border-radius: 12px;
            border: 1px solid #eee;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            padding: 20px;
            width: 250px;
            text-align: center;
        }
        .card-icon {
            font-size: 30px;
            color: #1e40af;
            margin-bottom: 10px;
        }
        .badge {
            margin-top: 10px;
            display: inline-block;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            color: white;
        }
        .badge.aprovado { background-color: #16a34a; }
        .badge.concluido { background-color: #2563eb; }
        .badge.andamento { background-color: #facc15; color: #000; }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-blue: #1e40af;
            --primary-yellow: #fbbf24;
            --white: #ffffff;
            --light-gray: #f8fafc;
            --medium-gray: #e2e8f0;
            --dark-gray: #94a3b8;
            --text-dark: #1e293b;
            --text-secondary: #64748b;
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --transition: all 0.3s ease;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.12);
            --sidebar-width: 280px;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--light-gray);
            min-height: 100vh;
            color: var(--text-dark);
            overflow-x: hidden;
        }

        /* Header institucional */
        .institutional-header {
            background: linear-gradient(-45deg, #063970, #0959a3, #063970);
            background-size: 400% 400%;
            animation: gradient 15s ease infinite;
            border-bottom: 3px solid #FFCC00;
            padding: 1.5rem 2rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            height: 90px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
        }

        .header-brand {
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .brand-logo {
            width: 60px;
            height: 60px;
            border-radius: 8px;
            background: var(--white);
            padding: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .brand-text h1 {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--white);
            margin-bottom: 0.25rem;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
            line-height: 1.2;
        }

        .brand-text p {
            font-size: 0.95rem;
            color: rgba(255,255,255,0.9);
            text-shadow: 0 1px 2px rgba(0,0,0,0.2);
            font-weight: 500;
        }

        .vereador-header-photo {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            border: 3px solid #FFCC00;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            object-fit: cover;
            transition: var(--transition);
        }

        .vereador-header-photo:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 16px rgba(0,0,0,0.3);
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.5rem 1rem;
            background: var(--light-gray);
            border-radius: 12px;
            border: 1px solid var(--medium-gray);
        }

        .user-avatar {
            width: 35px;
            height: 35px;
            background: linear-gradient(135deg, var(--primary-blue) 0%, #1e3a8a 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
            font-size: 0.9rem;
        }

        .user-details span {
            display: block;
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        .user-details strong {
            font-size: 0.85rem;
            color: var(--text-dark);
            font-weight: 600;
        }

        .sync-btn {
            background: linear-gradient(135deg, var(--success) 0%, #059669 100%);
            color: var(--white);
            border: none;
            padding: 0.6rem 1.2rem;
            border-radius: 10px;
            cursor: pointer;
            transition: var(--transition);
            font-size: 0.85rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-right: 1rem;
        }

        .sync-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
        }

        .sync-btn:active {
            transform: translateY(0);
        }

        .sync-btn i {
            animation: none;
        }

        .sync-btn.syncing i {
            animation: rotate 1s linear infinite;
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .logout-btn {
            background: linear-gradient(135deg, var(--danger) 0%, #dc2626 100%);
            color: var(--white);
            border: none;
            padding: 0.6rem 1.2rem;
            border-radius: 10px;
            cursor: pointer;
            transition: var(--transition);
            font-size: 0.85rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .logout-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);
        }



        /* Layout principal */
        .main-layout {
            display: flex;
            margin-top: 80px;
            min-height: calc(100vh - 80px);
        }

        /* Sidebar */
        .sidebar {
            width: var(--sidebar-width);
            background: var(--white);
            border-right: 1px solid var(--medium-gray);
            padding: 2rem 0;
            position: fixed;
            left: 0;
            top: 80px;
            bottom: 0;
            overflow-y: auto;
            z-index: 900;
        }

        .sidebar-nav {
            list-style: none;
        }

        .nav-item {
            margin-bottom: 0.5rem;
        }

        .nav-link {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem 2rem;
            color: var(--text-secondary);
            text-decoration: none;
            transition: var(--transition);
            border-right: 3px solid transparent;
            font-weight: 500;
        }

        .nav-link:hover {
            background: var(--light-gray);
            color: var(--primary-blue);
        }

        .nav-link.active {
            background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);
            color: var(--primary-blue);
            border-right-color: var(--primary-blue);
        }

        .nav-icon {
            font-size: 1.1rem;
            width: 20px;
            text-align: center;
        }

        /* Conteúdo principal */
        .main-content {
            margin-left: var(--sidebar-width);
            padding: 2rem;
            min-height: 100vh;
            background: #f8fafc;
            transition: margin-left 0.3s ease;
        }

        /* Seções do painel */
        .panel-section {
            display: none;
        }

        .panel-section.active {
            display: block;
            animation: fadeIn 0.4s ease-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .section-header {
            background: linear-gradient(135deg, #1e40af 0%, #1e3a8a 100%);
            border-radius: 20px;
            padding: 2.5rem;
            margin-bottom: 3rem;
            box-shadow: 0 12px 35px rgba(30, 64, 175, 0.25);
            border: 1px solid rgba(255,255,255,0.1);
            position: relative;
            overflow: hidden;
            color: var(--white);
        }

        .section-header::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 100px;
            height: 100px;
            background: rgba(255,255,255,0.1);
            border-radius: 50%;
            transform: translate(30px, -30px);
        }

        .section-title {
            font-size: 2rem;
            font-weight: 700;
            color: #fff;
            text-shadow: 0 1px 4px rgba(0,0,0,0.25);
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .section-title i {
            font-size: 1.5rem;
            color: rgba(255,255,255,0.9);
        }

        .section-subtitle {
            color: rgba(255,255,255,0.9);
            text-shadow: 0 1px 2px rgba(0,0,0,0.2);
            font-size: 1.1rem;
            line-height: 1.5;
        }

        /* Cards informativos */
        .info-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-bottom: 3rem;
        }

        .info-card {
            background: #f7f9fc;
            border-radius: 20px;
            padding: 2.5rem;
            box-shadow: 0 8px 25px rgba(0,0,0,0.08);
            border: 1px solid rgba(255,255,255,0.8);
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }

        .info-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-blue), var(--primary-yellow));
        }

        .info-card:hover {
            transform: translateY(-6px);
            box-shadow: 0 12px 35px rgba(0,0,0,0.12);
        }

        .card-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1rem;
        }

        .card-icon {
            width: 70px;
            height: 70px;
            border-radius: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.6rem;
            color: var(--white);
            box-shadow: 0 4px 15px rgba(0,0,0,0.15);
            transition: var(--transition);
        }

        .card-icon.primary {
            background: linear-gradient(135deg, #1e40af 0%, #1e3a8a 100%);
        }

        .card-icon.success {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }

        .card-icon.warning {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
        }

        .card-icon.purple {
            background: linear-gradient(135deg, #7c3aed 0%, #6d28d9 100%);
        }

        .info-card:hover .card-icon {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(0,0,0,0.2);
        }

        /* Card do Mandato */
        .mandato-card {
            background: linear-gradient(135deg, #1e40af 0%, #1e3a8a 100%);
            border-radius: 24px;
            padding: 2.5rem;
            margin-bottom: 3rem;
            color: var(--white);
            box-shadow: 0 12px 35px rgba(30, 64, 175, 0.25);
            position: relative;
            overflow: hidden;
        }

        .mandato-card::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 100px;
            height: 100px;
            background: rgba(255,255,255,0.1);
            border-radius: 50%;
            transform: translate(30px, -30px);
        }

        .mandato-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .mandato-icon {
            width: 80px;
            height: 80px;
            background: rgba(255,255,255,0.2);
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            color: var(--white);
        }

        .mandato-info h3 {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .mandato-info p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .status-badge {
            padding: 0.75rem 1.5rem;
            border-radius: 30px;
            font-weight: 600;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .status-badge.ativo {
            background: #10b981;
            color: var(--white);
        }

        .mandato-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 2rem;
        }

        .stat-item {
            text-align: center;
            padding: 1rem;
            background: rgba(255,255,255,0.1);
            border-radius: 16px;
            backdrop-filter: blur(10px);
        }

        .stat-number {
            display: block;
            font-size: 2.5rem;
            font-weight: 700;
            color: #FFCC00;
            margin-bottom: 0.5rem;
        }

        .stat-label {
            font-size: 0.9rem;
            opacity: 0.9;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Estilos da Seção de Configurações */
        .config-container {
            display: grid;
            gap: 2rem;
        }

        .config-card {
            background: #f7f9fc;
            border-radius: 20px;
            padding: 2.5rem;
            box-shadow: 0 8px 25px rgba(0,0,0,0.08);
            border: 1px solid rgba(255,255,255,0.8);
            position: relative;
            overflow: hidden;
        }

        .config-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-blue), var(--primary-yellow));
        }

        .config-card h3 {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--text-dark);
            margin-bottom: 2rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .config-card h3 i {
            color: var(--primary-blue);
            font-size: 1.2rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 0.5rem;
            font-size: 0.95rem;
        }

        .form-control {
            width: 100%;
            padding: 1rem;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            font-size: 1rem;
            transition: var(--transition);
            background: var(--white);
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary-blue);
            box-shadow: 0 0 0 3px rgba(30, 64, 175, 0.1);
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
        }

        .config-actions {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-top: 3rem;
            flex-wrap: wrap;
        }

        .config-actions button {
            padding: 1rem 2rem;
            border: none;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 1rem;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-blue) 0%, #1e3a8a 100%);
            color: var(--white);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #6b7280 0%, #4b5563 100%);
            color: var(--white);
        }

        .btn-danger {
            background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);
            color: var(--white);
        }

        .config-actions button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
        }

        /* Estilos para Upload de Imagem */
        .image-upload-container {
            border: 2px dashed #e5e7eb;
            border-radius: 12px;
            padding: 2rem;
            text-align: center;
            transition: var(--transition);
            background: #f9fafb;
        }

        .image-upload-container:hover {
            border-color: var(--primary-blue);
            background: #f3f4f6;
        }

        .image-preview {
            margin-bottom: 1.5rem;
        }

        .image-preview img {
            max-width: 150px;
            max-height: 150px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            object-fit: cover;
        }

        .upload-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }

        .btn-upload, .btn-remove {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-upload {
            background: linear-gradient(135deg, var(--primary-blue) 0%, #1e3a8a 100%);
            color: var(--white);
        }

        .btn-remove {
            background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);
            color: var(--white);
        }

        .btn-upload:hover, .btn-remove:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(0,0,0,0.15);
        }

        .upload-info {
            color: var(--text-secondary);
            font-size: 0.85rem;
            display: block;
            margin-top: 0.5rem;
        }

        /* Estilos para Editores Dinâmicos */
        .dynamic-editor {
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            background: #f9fafb;
            position: relative;
        }

        .dynamic-editor h4 {
            margin: 0 0 1rem 0;
            color: var(--primary-blue);
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .remove-item {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #dc2626;
            color: white;
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }

        .remove-item:hover {
            background: #b91c1c;
            transform: scale(1.1);
        }

        .icon-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(40px, 1fr));
            gap: 0.5rem;
            margin-top: 0.5rem;
            max-height: 120px;
            overflow-y: auto;
            border: 1px solid #e5e7eb;
            border-radius: 4px;
            padding: 0.5rem;
        }

        .icon-option {
            width: 40px;
            height: 40px;
            border: 1px solid #e5e7eb;
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
            background: white;
        }

        .icon-option:hover, .icon-option.selected {
            border-color: var(--primary-blue);
            background: #eff6ff;
            color: var(--primary-blue);
        }

        .status-selector {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
            margin-top: 0.5rem;
        }

        .status-option {
            padding: 0.5rem 1rem;
            border: 1px solid #e5e7eb;
            border-radius: 20px;
            cursor: pointer;
            transition: var(--transition);
            font-size: 0.85rem;
            background: white;
        }

        .status-option:hover, .status-option.selected {
            border-color: var(--primary-blue);
            background: var(--primary-blue);
            color: white;
        }

        .status-option.aprovado { background-color: #10b981; border-color: #10b981; color: white; }
        .status-option.concluido { background-color: #3b82f6; border-color: #3b82f6; color: white; }
        .status-option.andamento { background-color: #f59e0b; border-color: #f59e0b; color: white; }
        .status-option.pendente { background-color: #ef4444; border-color: #ef4444; color: white; }

        .card-preview {
            margin-top: 1rem;
            padding: 1rem;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            background: white;
        }

        .preview-label {
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .no-items {
            text-align: center;
            padding: 2rem;
            color: var(--text-secondary);
            font-style: italic;
        }

        /* Estilos para Separadores da Navegação */
        .nav-divider {
            padding: 1.5rem 2rem 0.5rem 2rem;
            margin-top: 1rem;
            border-top: 1px solid var(--medium-gray);
        }

        .nav-divider span {
            font-size: 0.7rem;
            font-weight: 700;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* Estilos para Editores Específicos de Conteúdo */
        .content-editor {
            background: var(--white);
            border-radius: 16px;
            padding: 0;
            box-shadow: var(--shadow);
            border: 1px solid var(--medium-gray);
            margin-bottom: 2rem;
        }

        .content-editor-header {
            background: linear-gradient(135deg, var(--primary-blue) 0%, #1e3a8a 100%);
            color: var(--white);
            padding: 1.5rem 2rem;
            border-radius: 16px 16px 0 0;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .content-editor-header h2 {
            margin: 0;
            font-size: 1.3rem;
            font-weight: 700;
        }

        .content-editor-body {
            padding: 2rem;
        }

        .rich-text-editor {
            border: 2px solid var(--medium-gray);
            border-radius: 8px;
            min-height: 200px;
            padding: 1rem;
            font-family: inherit;
            line-height: 1.6;
            transition: var(--transition);
        }

        .rich-text-editor:focus {
            border-color: var(--primary-blue);
            box-shadow: 0 0 0 3px rgba(30, 64, 175, 0.1);
            outline: none;
        }

        .editor-toolbar {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
            padding: 1rem;
            background: var(--light-gray);
            border-radius: 8px;
            flex-wrap: wrap;
        }

        .toolbar-btn {
            padding: 0.5rem 0.75rem;
            background: var(--white);
            border: 1px solid var(--medium-gray);
            border-radius: 6px;
            cursor: pointer;
            transition: var(--transition);
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .toolbar-btn:hover, .toolbar-btn.active {
            background: var(--primary-blue);
            color: var(--white);
            border-color: var(--primary-blue);
        }

        .image-upload-zone {
            border: 2px dashed var(--medium-gray);
            border-radius: 12px;
            padding: 2rem;
            text-align: center;
            transition: var(--transition);
            cursor: pointer;
            background: var(--light-gray);
        }

        .image-upload-zone:hover {
            border-color: var(--primary-blue);
            background: #eff6ff;
        }

        .image-upload-zone.dragover {
            border-color: var(--primary-blue);
            background: #eff6ff;
            transform: scale(1.02);
        }

        .upload-icon {
            font-size: 3rem;
            color: var(--text-secondary);
            margin-bottom: 1rem;
        }

        .upload-text {
            color: var(--text-dark);
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .upload-hint {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        /* ===== ESTILOS PARA MAPA ELEITORAL (GEORREFERENCIAMENTO) ===== */
        .geo-stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: var(--white);
            border-radius: 12px;
            padding: 1.5rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            border-left: 4px solid;
            transition: var(--transition);
            box-shadow: var(--shadow);
        }

        .stat-card.blue { border-left-color: var(--primary-blue); }
        .stat-card.yellow { border-left-color: var(--primary-yellow); }
        .stat-card.green { border-left-color: var(--success); }
        .stat-card.purple { border-left-color: #8b5cf6; }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .stat-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: var(--white);
        }

        .stat-card.blue .stat-icon { background: var(--primary-blue); }
        .stat-card.yellow .stat-icon { background: var(--primary-yellow); }
        .stat-card.green .stat-icon { background: var(--success); }
        .stat-card.purple .stat-icon { background: #8b5cf6; }

        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            color: var(--text-dark);
            line-height: 1;
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .color-input-container {
            display: flex;
            gap: 0.5rem;
            align-items: center;
        }

        .color-input-container input[type="color"] {
            width: 50px;
            height: 40px;
            border: 2px solid var(--medium-gray);
            border-radius: 8px;
            cursor: pointer;
            transition: var(--transition);
        }

        .btn-auto-color {
            padding: 0.5rem 1rem;
            background: var(--light-gray);
            border: 1px solid var(--medium-gray);
            border-radius: 6px;
            cursor: pointer;
            transition: var(--transition);
            font-size: 0.9rem;
            color: var(--text-dark);
        }

        .btn-auto-color:hover {
            background: var(--primary-blue);
            color: var(--white);
            border-color: var(--primary-blue);
        }

        .geo-visualization {
            margin: 2rem 0;
        }

        .geo-chart-container {
            background: var(--white);
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: var(--shadow);
            border: 1px solid var(--medium-gray);
        }

        .geo-chart-container h3 {
            margin-bottom: 1rem;
            color: var(--primary-blue);
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .chart-electoral {
            max-height: 400px;
            width: 100%;
        }

        .bairros-lista {
            display: grid;
            gap: 1rem;
        }

        .bairro-item {
            background: var(--white);
            border-radius: 12px;
            padding: 1.5rem;
            border: 1px solid var(--medium-gray);
            transition: var(--transition);
        }

        .bairro-item:hover {
            box-shadow: var(--shadow);
            transform: translateY(-1px);
        }

        .bairro-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .bairro-info {
            flex: 1;
        }

        .bairro-nome {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--text-dark);
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .bairro-cor {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            border: 2px solid var(--white);
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .bairro-stats {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .bairro-stat {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .bairro-acoes {
            display: flex;
            gap: 0.5rem;
        }

        .geo-actions {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
            flex-wrap: wrap;
        }

        /* ===== ESTILOS PARA RAIO-X VOTOS ===== */
        .raio-x-stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .raio-x-form-grid {
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
        }

        .filtros-container {
            background: var(--white);
            border-radius: 12px;
            padding: 1.5rem;
            margin: 2rem 0;
            box-shadow: var(--shadow);
            border: 1px solid var(--medium-gray);
        }

        .filtros-container h3 {
            color: var(--primary-blue);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .filtros-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            align-items: end;
        }

        .raio-x-charts {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin: 2rem 0;
        }

        .chart-card {
            background: var(--white);
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: var(--shadow);
            border: 1px solid var(--medium-gray);
        }

        .chart-card h3 {
            margin-bottom: 1rem;
            color: var(--primary-blue);
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .chart-raio-x {
            max-height: 400px;
            width: 100%;
        }

        .tabela-container {
            background: var(--white);
            border-radius: 12px;
            padding: 1.5rem;
            margin: 2rem 0;
            box-shadow: var(--shadow);
            border: 1px solid var(--medium-gray);
        }

        .tabela-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .tabela-header h3 {
            color: var(--primary-blue);
            margin: 0;
        }

        .tabela-acoes {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .tabela-acoes input,
        .tabela-acoes select {
            padding: 0.5rem;
            border: 1px solid var(--medium-gray);
            border-radius: 6px;
            font-size: 0.9rem;
        }

        .tabela-wrapper {
            overflow-x: auto;
            border-radius: 8px;
            border: 1px solid var(--medium-gray);
        }

        .raio-x-tabela {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9rem;
        }

        .raio-x-tabela th {
            background: var(--light-gray);
            padding: 1rem 0.75rem;
            text-align: left;
            font-weight: 600;
            color: var(--text-dark);
            border-bottom: 2px solid var(--medium-gray);
            white-space: nowrap;
        }

        .raio-x-tabela td {
            padding: 0.875rem 0.75rem;
            border-bottom: 1px solid var(--medium-gray);
            vertical-align: middle;
        }

        .raio-x-tabela tr:hover {
            background: #f8fafc;
        }

        .raio-x-actions {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
            flex-wrap: wrap;
        }

        .btn-acao.warning {
            background: var(--warning);
            color: var(--white);
        }

        .btn-acao.warning:hover {
            background: #d97706;
        }

        .votos-badge {
            background: var(--primary-blue);
            color: var(--white);
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        /* Responsividade */
        @media (max-width: 768px) {
            .geo-stats-grid,
            .raio-x-stats-grid {
                grid-template-columns: 1fr;
            }
            
            .raio-x-charts {
                grid-template-columns: 1fr;
            }
            
            .filtros-grid {
                grid-template-columns: 1fr;
            }
            
            .geo-actions,
            .raio-x-actions {
                flex-direction: column;
            }
            
            .tabela-header {
                flex-direction: column;
                align-items: stretch;
            }
            
            .tabela-acoes {
                flex-direction: column;
                align-items: stretch;
            }
            
            .bairro-header {
                flex-direction: column;
                align-items: stretch;
            }
            
            .bairro-acoes {
                justify-content: flex-end;
            }
        }



        /* ===== ESTILOS ESPECÍFICOS PARA ANÁLISE DE VOTOS ===== */
        .votos-stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card.purple { 
            border-left-color: #8b5cf6; 
        }

        .stat-card.purple .stat-icon { 
            background: #8b5cf6; 
        }

        .votos-form-grid {
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
        }

        .filtros-container {
            background: var(--white);
            border-radius: 12px;
            padding: 1.5rem;
            margin: 2rem 0;
            box-shadow: var(--shadow);
            border: 1px solid var(--medium-gray);
        }

        .filtros-container h3 {
            color: var(--primary-blue);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .filtros-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            align-items: end;
        }

        .votos-visualization {
            margin: 2rem 0;
        }

        .votos-charts-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
        }

        .chart-card {
            background: var(--white);
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: var(--shadow);
            border: 1px solid var(--medium-gray);
        }

        .chart-card h3 {
            margin-bottom: 1rem;
            color: var(--primary-blue);
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .chart-votos {
            max-height: 400px;
            width: 100%;
        }

        .tabela-container {
            background: var(--white);
            border-radius: 12px;
            padding: 1.5rem;
            margin: 2rem 0;
            box-shadow: var(--shadow);
            border: 1px solid var(--medium-gray);
        }

        .tabela-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .tabela-header h3 {
            color: var(--primary-blue);
            margin: 0;
        }

        .tabela-acoes {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .tabela-acoes input,
        .tabela-acoes select {
            padding: 0.5rem;
            border: 1px solid var(--medium-gray);
            border-radius: 6px;
            font-size: 0.9rem;
        }

        .tabela-wrapper {
            overflow-x: auto;
            border-radius: 8px;
            border: 1px solid var(--medium-gray);
        }

        .votos-tabela {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9rem;
        }

        .votos-tabela th {
            background: var(--light-gray);
            padding: 1rem 0.75rem;
            text-align: left;
            font-weight: 600;
            color: var(--text-dark);
            border-bottom: 2px solid var(--medium-gray);
            white-space: nowrap;
        }

        .votos-tabela td {
            padding: 0.875rem 0.75rem;
            border-bottom: 1px solid var(--medium-gray);
            vertical-align: middle;
        }

        .votos-tabela tr:hover {
            background: #f8fafc;
        }

        .tabela-totalizadores {
            display: flex;
            gap: 2rem;
            margin-top: 1.5rem;
            padding-top: 1rem;
            border-top: 2px solid var(--medium-gray);
        }

        .totalizador {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.25rem;
        }

        .totalizador-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
            font-weight: 600;
        }

        .totalizador-valor {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-blue);
        }

        .votos-actions {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
            flex-wrap: wrap;
        }

        .registro-votos {
            background: var(--white);
            border-radius: 8px;
            padding: 1rem;
            border: 1px solid var(--medium-gray);
            margin-bottom: 0.5rem;
            transition: var(--transition);
        }

        .registro-votos:hover {
            box-shadow: var(--shadow);
            transform: translateY(-1px);
        }

        .registro-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 0.75rem;
        }

        .registro-info {
            flex: 1;
        }

        .registro-titulo {
            font-weight: 700;
            color: var(--text-dark);
            margin-bottom: 0.5rem;
        }

        .registro-detalhes {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 0.5rem;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .detalhe-item {
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .votos-badge {
            background: var(--primary-blue);
            color: var(--white);
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        /* Responsividade para Análise de Votos */
        @media (max-width: 768px) {
            .votos-charts-container {
                grid-template-columns: 1fr;
            }
            
            .votos-stats-grid {
                grid-template-columns: 1fr;
            }
            
            .filtros-grid {
                grid-template-columns: 1fr;
            }
            
            .votos-actions {
                flex-direction: column;
            }
            
            .tabela-header {
                flex-direction: column;
                align-items: stretch;
            }
            
            .tabela-acoes {
                flex-direction: column;
                align-items: stretch;
            }
            
            .tabela-totalizadores {
                justify-content: center;
                text-align: center;
            }
            
            .votos-tabela {
                font-size: 0.8rem;
            }
            
            .votos-tabela th,
            .votos-tabela td {
                padding: 0.5rem 0.25rem;
            }
        }

        .card-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--text-dark);
            line-height: 1;
        }

        .card-title {
            font-size: 1rem;
            color: var(--text-secondary);
            font-weight: 500;
            margin-bottom: 0.5rem;
        }

        .card-description {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .card-trend {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-top: 0.75rem;
            font-size: 0.8rem;
        }

        .trend-positive {
            color: var(--success);
        }

        .trend-neutral {
            color: var(--text-secondary);
        }

        /* Cards de ação rápida */
        .quick-actions {
            margin-top: 2rem;
        }

        .actions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .action-card {
            background: var(--white);
            border: 2px solid var(--medium-gray);
            border-radius: 12px;
            padding: 1.25rem;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            text-decoration: none;
            color: inherit;
        }

        .action-card:hover {
            border-color: var(--primary-blue);
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        .action-icon {
            width: 60px;
            height: 60px;
            margin: 0 auto 1.5rem auto;
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
            font-size: 1.5rem;
            transition: var(--transition);
        }

        .action-card:nth-child(1) .action-icon {
            background: linear-gradient(135deg, #1e40af 0%, #1e3a8a 100%);
        }

        .action-card:nth-child(2) .action-icon {
            background: linear-gradient(135deg, #7c3aed 0%, #6d28d9 100%);
        }

        .action-card:nth-child(3) .action-icon {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }

        .action-card:nth-child(4) .action-icon {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
        }

        .action-card:hover .action-icon {
            transform: scale(1.1);
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
        }

        .action-title {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text-dark);
        }

        /* Responsividade */
        @media (max-width: 1024px) {
            .sidebar {
                transform: translateX(-100%);
                transition: transform 0.3s ease;
            }

            .sidebar.open {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
                overflow-x: hidden;
                max-width: 100vw;
            }

            .institutional-header {
                padding: 1rem;
            }

            .header-brand .brand-text h1 {
                font-size: 1.1rem;
            }

            /* Previne overflow horizontal em todas as seções */
            .panel-section,
            .section-content,
            .dashboard-cards,
            .stats-grid,
            .actions-grid {
                overflow-x: hidden;
                max-width: 100%;
            }

            /* Cards responsivos */
            .stats-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
            }

            .actions-grid {
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            }

            /* Formulários mais compactos */
            .form-row {
                grid-template-columns: 1fr;
                gap: 1rem;
            }

            .user-info {
                display: none;
            }
        }

        @media (max-width: 768px) {
            .main-content {
                padding: 1rem;
            }

            .info-cards {
                grid-template-columns: 1fr;
                gap: 1rem;
            }

            .actions-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
            }

            .institutional-header {
                padding: 0.75rem;
                flex-wrap: wrap;
            }

            .brand-logo {
                width: 35px;
                height: 35px;
                font-size: 1rem;
            }

            .brand-text h1 {
                font-size: 0.9rem !important;
                line-height: 1.2;
            }

            .brand-text p {
                font-size: 0.7rem !important;
            }

            .user-info {
                display: none !important;
            }

            /* Cards responsivos */
            .card, .info-card {
                padding: 1rem !important;
                margin: 0.5rem 0 !important;
            }

            .card h3 {
                font-size: 1.1rem !important;
            }

            .card .number {
                font-size: 1.8rem !important;
            }

            /* Botões de ação responsivos */
            .action-btn {
                width: 100% !important;
                margin: 0.25rem 0 !important;
                padding: 0.75rem !important;
                font-size: 0.85rem !important;
            }

            /* Tabelas responsivas */
            .table-container {
                overflow-x: auto;
                width: 100%;
                max-width: 100%;
            }

            table {
                width: 100%;
                font-size: 0.8rem;
                table-layout: auto;
            }

            table th,
            table td {
                white-space: nowrap;
                overflow: hidden;
                text-overflow: ellipsis;
                max-width: 150px;
            }

            /* Força quebra de linha em células quando necessário */
            @media (max-width: 768px) {
                table th,
                table td {
                    white-space: normal;
                    word-wrap: break-word;
                    max-width: 120px;
                    padding: 0.5rem 0.25rem;
                }
                
                table {
                    font-size: 0.7rem;
                }
            }

            /* CSS universal para prevenir overflow horizontal */
            * {
                box-sizing: border-box;
            }

            html, body {
                overflow-x: hidden;
                max-width: 100vw;
            }

            .main-content,
            .panel-section,
            .section-content,
            .dashboard-cards,
            .card,
            .stats-card,
            .action-card,
            .form-container,
            .content-editor,
            .table-container {
                max-width: 100%;
                overflow-x: hidden;
                word-wrap: break-word;
            }

            /* Garante que grids não extrapolem */
            .stats-grid,
            .actions-grid,
            .form-grid,
            .dashboard-cards {
                grid-template-columns: 1fr;
                width: 100%;
                max-width: 100%;
            }

            /* Corrige elementos com largura fixa problemática */
            .wide-content {
                width: 100% !important;
                max-width: 100% !important;
            }

            /* Formulários responsivos */
            .form-group {
                margin-bottom: 1rem;
            }

            .form-group input,
            .form-group select,
            .form-group textarea {
                width: 100% !important;
                font-size: 0.9rem !important;
            }

            /* Navegação responsiva */
            .section-header h2 {
                font-size: 1.3rem !important;
            }

            .nav-button {
                padding: 0.5rem 1rem !important;
                font-size: 0.8rem !important;
            }
        }

        /* Botão do menu mobile */
        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            font-size: 1.5rem;
            color: var(--text-dark);
            cursor: pointer;
            padding: 0.5rem;
        }

        @media (max-width: 1024px) {
            .mobile-menu-btn {
                display: block;
            }
        }

        /* Overlay para mobile */
        .sidebar-overlay {
            display: none;
            position: fixed;
            top: 80px;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 850;
        }

        @media (max-width: 1024px) {
            .sidebar-overlay.active {
                display: block;
            }
        }

        /* Estilos para formulários */
        .form-container {
            background: var(--white);
            border-radius: 16px;
            padding: 2rem;
            box-shadow: var(--shadow);
            border: 1px solid var(--medium-gray);
            margin-bottom: 2rem;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--text-dark);
            font-size: 0.9rem;
        }

        .form-input, .form-textarea {
            width: 100%;
            padding: 0.875rem;
            border: 2px solid var(--medium-gray);
            border-radius: 10px;
            font-size: 0.95rem;
            transition: var(--transition);
            background: var(--white);
            font-family: inherit;
        }

        .form-input:focus, .form-textarea:focus {
            outline: none;
            border-color: var(--primary-blue);
            box-shadow: 0 0 0 3px rgba(30, 64, 175, 0.1);
        }

        .form-textarea {
            resize: vertical;
            min-height: 120px;
        }

        .form-actions {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-blue) 0%, #1e3a8a 100%);
            color: var(--white);
            border: none;
            padding: 0.875rem 1.5rem;
            border-radius: 10px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .btn-secondary {
            background: var(--white);
            color: var(--text-secondary);
            border: 2px solid var(--medium-gray);
            padding: 0.875rem 1.5rem;
            border-radius: 10px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-secondary:hover {
            border-color: var(--primary-blue);
            color: var(--primary-blue);
            transform: translateY(-2px);
        }

        /* Mensagens enviadas */
        .mensagens-enviadas {
            background: var(--white);
            border-radius: 16px;
            padding: 1.5rem;
            box-shadow: var(--shadow);
            border: 1px solid var(--medium-gray);
        }

        .mensagens-enviadas h4 {
            color: var(--text-dark);
            margin-bottom: 1rem;
            font-size: 1.1rem;
        }

        .lista-mensagens {
            max-height: 400px;
            overflow-y: auto;
        }

        .mensagem-item {
            background: var(--light-gray);
            border-radius: 10px;
            padding: 1rem;
            margin-bottom: 0.75rem;
            border-left: 4px solid var(--primary-blue);
        }

        .mensagem-item:last-child {
            margin-bottom: 0;
        }

        .mensagem-assunto {
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 0.5rem;
        }

        .mensagem-conteudo {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
        }

        .mensagem-data {
            font-size: 0.8rem;
            color: var(--dark-gray);
        }

        /* Gráficos e estatísticas */
        .grafico-container, .mapa-estatistico {
            background: var(--white);
            border-radius: 16px;
            padding: 2rem;
            box-shadow: var(--shadow);
            border: 1px solid var(--medium-gray);
            margin-top: 1.5rem;
        }

        .bairro-stat {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1rem;
            margin-bottom: 0.75rem;
            background: var(--light-gray);
            border-radius: 10px;
            border-left: 4px solid var(--primary-blue);
        }

        .bairro-nome {
            font-weight: 600;
            color: var(--text-dark);
        }

        .bairro-count {
            background: var(--primary-blue);
            color: var(--white);
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .bairro-bar {
            height: 8px;
            background: var(--medium-gray);
            border-radius: 4px;
            margin: 0.5rem 0;
            overflow: hidden;
        }

        .bairro-fill {
            height: 100%;
            background: linear-gradient(135deg, var(--primary-blue) 0%, #1e3a8a 100%);
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        /* Estilos do mapa estatístico */
        .mapa-grid {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .area-mapa {
            background: var(--light-gray);
            border-radius: 12px;
            padding: 1.5rem;
            border-left: 4px solid var(--primary-blue);
            transition: var(--transition);
        }

        .area-mapa:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        .area-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .area-nome {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-dark);
        }

        .area-stats {
            text-align: right;
        }

        .area-count {
            display: block;
            font-weight: 600;
            color: var(--primary-blue);
            font-size: 0.9rem;
        }

        .area-percent {
            display: block;
            color: var(--text-secondary);
            font-size: 0.8rem;
        }

        .area-visual {
            margin-top: 1rem;
        }

        .area-bar {
            height: 12px;
            background: var(--medium-gray);
            border-radius: 6px;
            overflow: hidden;
        }

        .area-fill {
            height: 100%;
            background: linear-gradient(135deg, var(--primary-blue) 0%, #1e3a8a 100%);
            border-radius: 6px;
            transition: width 0.8s ease;
        }

        /* Responsividade dos formulários */
        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
                gap: 1rem;
            }

            .form-container {
                padding: 1.5rem;
            }

            .form-actions {
                flex-direction: column;
            }

            .btn-primary, .btn-secondary {
                justify-content: center;
            }

            .area-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.5rem;
            }

            .area-stats {
                text-align: left;
            }
        }

        /* Estilos da seção Gestão de Eleitores */
        .gestao-content {
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }

        /* Filtros */
        .filtros-container {
            background: var(--white);
            border-radius: 16px;
            padding: 1.5rem;
            box-shadow: var(--shadow);
            border: 1px solid var(--medium-gray);
        }

        .filtros-container h4 {
            color: var(--text-dark);
            margin-bottom: 1rem;
            font-size: 1.1rem;
        }

        .filtros-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            align-items: end;
        }

        .filtro-group {
            display: flex;
            flex-direction: column;
        }

        .filtro-label {
            font-size: 0.9rem;
            font-weight: 500;
            color: var(--text-dark);
            margin-bottom: 0.5rem;
        }

        .filtro-select {
            padding: 0.75rem;
            border: 2px solid var(--medium-gray);
            border-radius: 8px;
            font-size: 0.9rem;
            background: var(--white);
            transition: var(--transition);
        }

        .filtro-select:focus {
            outline: none;
            border-color: var(--primary-blue);
            box-shadow: 0 0 0 3px rgba(30, 64, 175, 0.1);
        }

        .btn-filtro-limpar {
            background: var(--white);
            color: var(--text-secondary);
            border: 2px solid var(--medium-gray);
            padding: 0.75rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
            font-weight: 500;
        }

        .btn-filtro-limpar:hover {
            border-color: var(--danger);
            color: var(--danger);
        }

        /* Estatísticas */
        .stats-container {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 2rem;
            flex-wrap: wrap;
        }

        .stats-cards {
            display: flex;
            gap: 1rem;
            flex: 1;
        }

        .stat-card {
            background: var(--white);
            border-radius: 12px;
            padding: 1.25rem;
            box-shadow: var(--shadow);
            border: 1px solid var(--medium-gray);
            display: flex;
            align-items: center;
            gap: 1rem;
            min-width: 160px;
            flex: 1;
        }

        .stat-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            color: var(--white);
            background: linear-gradient(135deg, var(--primary-blue) 0%, #1e3a8a 100%);
        }

        .stat-icon.success {
            background: linear-gradient(135deg, var(--success) 0%, #059669 100%);
        }

        .stat-icon.warning {
            background: linear-gradient(135deg, var(--warning) 0%, #d97706 100%);
        }

        .stat-content {
            flex: 1;
        }

        .stat-number {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-dark);
            line-height: 1;
        }

        .stat-label {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-top: 0.25rem;
        }

        /* Ações */
        .acoes-container {
            display: flex;
            gap: 0.75rem;
            flex-wrap: wrap;
        }

        .btn-acao {
            background: linear-gradient(135deg, var(--primary-blue) 0%, #1e3a8a 100%);
            color: var(--white);
            border: none;
            padding: 0.75rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.85rem;
            font-weight: 600;
            white-space: nowrap;
        }

        .btn-acao:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        .btn-acao.secondary {
            background: var(--white);
            color: var(--text-secondary);
            border: 2px solid var(--medium-gray);
        }

        .btn-acao.secondary:hover {
            border-color: var(--danger);
            color: var(--danger);
        }

        /* Tabela */
        .tabela-container {
            background: var(--white);
            border-radius: 16px;
            box-shadow: var(--shadow);
            border: 1px solid var(--medium-gray);
            overflow: hidden;
        }

        .tabela-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--medium-gray);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .tabela-header h4 {
            color: var(--text-dark);
            font-size: 1.1rem;
            margin: 0;
        }

        .tabela-info {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .tabela-wrapper {
            overflow-x: auto;
        }

        .tabela-eleitores {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9rem;
        }

        .tabela-eleitores th {
            background: var(--light-gray);
            color: var(--text-dark);
            font-weight: 600;
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid var(--medium-gray);
            white-space: nowrap;
        }

        .tabela-eleitores td {
            padding: 1rem;
            border-bottom: 1px solid var(--medium-gray);
            color: var(--text-dark);
        }

        .tabela-eleitores tr:hover {
            background: var(--light-gray);
        }

        .btn-presenca {
            background: linear-gradient(135deg, var(--success) 0%, #059669 100%);
            color: var(--white);
            border: none;
            padding: 0.5rem 0.75rem;
            border-radius: 6px;
            cursor: pointer;
            transition: var(--transition);
            font-size: 0.8rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .btn-presenca:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(16, 185, 129, 0.3);
        }

        .btn-presenca.presente {
            background: linear-gradient(135deg, var(--primary-blue) 0%, #1e3a8a 100%);
        }

        .btn-presenca.presente:hover {
            box-shadow: 0 2px 8px rgba(30, 64, 175, 0.3);
        }

        /* Estado vazio */
        .estado-vazio {
            text-align: center;
            padding: 3rem;
            color: var(--text-secondary);
        }

        .estado-vazio i {
            font-size: 3rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        /* Responsividade da gestão */
        @media (max-width: 1024px) {
            .stats-container {
                flex-direction: column;
                gap: 1rem;
            }

            .stats-cards {
                flex-direction: column;
            }

            .acoes-container {
                justify-content: center;
            }
        }

        @media (max-width: 768px) {
            .filtros-grid {
                grid-template-columns: 1fr;
            }

            .stats-cards {
                gap: 0.75rem;
            }

            .stat-card {
                min-width: unset;
            }

            .tabela-wrapper {
                font-size: 0.8rem;
            }

            .tabela-eleitores th,
            .tabela-eleitores td {
                padding: 0.75rem 0.5rem;
            }
        }

        /* Estilos da seção Nova Mensagem */
        .nova-mensagem-content {
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }

        .form-email-container {
            background: var(--white);
            border-radius: 16px;
            padding: 2rem;
            box-shadow: var(--shadow);
            border: 1px solid var(--medium-gray);
        }

        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .destinatario-container {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .form-select {
            padding: 0.75rem;
            border: 2px solid var(--medium-gray);
            border-radius: 8px;
            font-size: 0.9rem;
            background: var(--white);
            transition: var(--transition);
        }

        .form-select:focus {
            outline: none;
            border-color: var(--primary-blue);
            box-shadow: 0 0 0 3px rgba(30, 64, 175, 0.1);
        }

        .form-actions {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
            margin-top: 1.5rem;
        }

        .btn-secondary {
            background: var(--white);
            color: var(--text-secondary);
            border: 2px solid var(--medium-gray);
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
            font-weight: 600;
        }

        .btn-secondary:hover {
            border-color: var(--primary-blue);
            color: var(--primary-blue);
        }

        /* Status do envio */
        .status-envio {
            background: var(--white);
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: var(--shadow);
            border-left: 4px solid var(--success);
            margin: 1rem 0;
        }

        .status-envio.erro {
            border-left-color: var(--danger);
        }

        .status-content {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .status-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.1rem;
            color: var(--white);
            background: var(--success);
        }

        .status-envio.erro .status-icon {
            background: var(--danger);
        }

        .status-text {
            font-size: 1rem;
            font-weight: 500;
            color: var(--text-dark);
        }

        /* Histórico de e-mails */
        .historico-emails {
            background: var(--white);
            border-radius: 16px;
            padding: 1.5rem;
            box-shadow: var(--shadow);
            border: 1px solid var(--medium-gray);
        }

        .historico-emails h4 {
            color: var(--text-dark);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .emails-list {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .email-item {
            padding: 1rem;
            border: 1px solid var(--medium-gray);
            border-radius: 8px;
            background: var(--light-gray);
            transition: var(--transition);
        }

        .email-item:hover {
            background: var(--white);
            box-shadow: var(--shadow);
        }

        .email-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 0.5rem;
        }

        .email-assunto {
            font-weight: 600;
            color: var(--text-dark);
            font-size: 0.95rem;
        }

        .email-data {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .email-destinatario {
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
        }

        .email-preview {
            font-size: 0.85rem;
            color: var(--text-dark);
            line-height: 1.4;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        /* Estado vazio do histórico */
        .emails-vazio {
            text-align: center;
            padding: 2rem;
            color: var(--text-secondary);
        }

        .emails-vazio i {
            font-size: 2rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        /* Loader de envio */
        .loader-envio {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
            padding: 1rem;
            margin-top: 1rem;
            background: rgba(30, 64, 175, 0.1);
            border-radius: 8px;
            border: 1px solid rgba(30, 64, 175, 0.2);
        }

        .loader-spinner {
            color: var(--primary-blue);
            font-size: 1.2rem;
        }

        .loader-envio span {
            color: var(--primary-blue);
            font-weight: 500;
        }

        /* Alerta de configuração */
        .config-alert {
            background: rgba(245, 158, 11, 0.1);
            border: 1px solid rgba(245, 158, 11, 0.3);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .config-alert i {
            color: var(--warning);
            font-size: 1.1rem;
        }

        .config-alert-text {
            color: var(--text-dark);
            font-size: 0.9rem;
        }

        /* ===== ESTILOS PARA MAPA ELEITORAL ===== */
        .mapa-stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .filtros-mapa-container {
            background: var(--white);
            border-radius: 12px;
            padding: 1.5rem;
            margin: 2rem 0;
            box-shadow: var(--shadow);
            border: 1px solid var(--medium-gray);
        }

        .filtros-mapa-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .filtros-mapa-header h3 {
            color: var(--primary-blue);
            margin: 0;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .filtros-mapa-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .filtro-grupo {
            display: flex;
            flex-direction: column;
        }

        .filtro-grupo label {
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
        }

        .filtro-grupo select {
            padding: 10px;
            border: 2px solid var(--light-gray);
            border-radius: 6px;
            font-size: 0.9rem;
            transition: border-color 0.3s ease;
            background: white;
        }

        .filtro-grupo select:focus {
            outline: none;
            border-color: var(--primary-blue);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .mapa-principal-container {
            background: var(--white);
            border-radius: 12px;
            padding: 1.5rem;
            margin: 2rem 0;
            box-shadow: var(--shadow);
            border: 1px solid var(--medium-gray);
        }

        .mapa-controles {
            margin-bottom: 1.5rem;
        }

        .controles-header h3 {
            color: var(--primary-blue);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .controles-grid {
            display: flex;
            gap: 0.75rem;
            flex-wrap: wrap;
        }

        .btn-controle {
            background: var(--primary-blue);
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-controle:hover {
            background: #1d4ed8;
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(30, 64, 175, 0.3);
        }

        .mapa-interativo-container {
            position: relative;
            border-radius: 8px;
            overflow: hidden;
            border: 1px solid var(--light-gray);
            width: 100%;
            max-width: 100%;
            box-sizing: border-box;
        }
        
        /* Responsividade específica para Mapa Eleitoral */
        .mapa-principal-container {
            width: 100%;
            max-width: 100%;
            overflow: hidden;
            box-sizing: border-box;
        }
        
        .filtros-mapa-container,
        .cadastro-bairro-container,
        .lista-bairros-container,
        .grafico-distribuicao-container,
        .acoes-mapa-container {
            width: 100%;
            max-width: 100%;
            box-sizing: border-box;
            overflow: hidden;
        }
        
        .filtros-mapa-grid,
        .cadastro-form-grid {
            width: 100%;
            max-width: 100%;
            display: grid;
            gap: 15px;
        }
        
        .lista-bairros-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            width: 100%;
            max-width: 100%;
        }

        .mapa-eleitoral {
            width: 100%;
            height: 500px;
            background: #f8fafc;
            max-width: 100%;
            box-sizing: border-box;
        }

        .mapa-loading {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(248, 250, 252, 0.9);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 10;
        }

        .mapa-loading.hidden {
            display: none;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid var(--light-gray);
            border-top: 4px solid var(--primary-blue);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 1rem;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .mapa-loading p {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin: 0;
        }

        .grafico-distribuicao-container {
            background: var(--white);
            border-radius: 12px;
            padding: 1.5rem;
            margin: 2rem 0;
            box-shadow: var(--shadow);
            border: 1px solid var(--medium-gray);
        }

        .grafico-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .grafico-header h3 {
            color: var(--primary-blue);
            margin: 0;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .grafico-controles select {
            padding: 6px 10px;
            border: 2px solid var(--light-gray);
            border-radius: 6px;
            font-size: 0.85rem;
            background: white;
        }

        .grafico-wrapper {
            position: relative;
            height: 400px;
            width: 100%;
        }

        .chart-mapa {
            max-height: 400px;
            width: 100%;
        }

        .cadastro-bairro-container {
            background: var(--white);
            border-radius: 12px;
            padding: 1.5rem;
            margin: 2rem 0;
            box-shadow: var(--shadow);
            border: 1px solid var(--medium-gray);
        }

        .cadastro-header h3 {
            color: var(--primary-blue);
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .cadastro-form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .form-grupo {
            display: flex;
            flex-direction: column;
        }

        .form-grupo.span-2 {
            grid-column: 1 / -1;
        }

        .form-grupo label {
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
        }

        .form-grupo input,
        .form-grupo textarea {
            padding: 12px;
            border: 2px solid var(--light-gray);
            border-radius: 6px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
            background: white;
        }

        .form-grupo input:focus,
        .form-grupo textarea:focus {
            outline: none;
            border-color: var(--primary-blue);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .color-picker-container {
            display: flex;
            gap: 0.5rem;
            align-items: center;
        }

        .color-picker-container input[type="color"] {
            width: 50px;
            height: 42px;
            border: 2px solid var(--light-gray);
            border-radius: 6px;
            cursor: pointer;
            padding: 2px;
        }

        .btn-auto-color {
            background: var(--primary-yellow);
            color: var(--text-dark);
            border: none;
            padding: 10px 12px;
            border-radius: 6px;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-auto-color:hover {
            background: #eab308;
            transform: translateY(-1px);
        }

        .cadastro-acoes {
            display: flex;
            gap: 1rem;
            justify-content: flex-start;
        }

        .lista-bairros-container {
            background: var(--white);
            border-radius: 12px;
            padding: 1.5rem;
            margin: 2rem 0;
            box-shadow: var(--shadow);
            border: 1px solid var(--medium-gray);
        }

        .lista-bairros-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .lista-bairros-header h3 {
            color: var(--primary-blue);
            margin: 0;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .lista-controles {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .lista-controles input,
        .lista-controles select {
            padding: 8px 12px;
            border: 2px solid var(--light-gray);
            border-radius: 6px;
            font-size: 0.9rem;
        }

        .lista-bairros-grid {
            display: grid;
            gap: 1rem;
        }

        .bairro-card {
            background: var(--light-bg);
            border: 1px solid var(--light-gray);
            border-radius: 8px;
            padding: 1.5rem;
            transition: all 0.3s ease;
        }

        .bairro-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .bairro-card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .bairro-info {
            flex: 1;
        }

        .bairro-nome {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 0.5rem;
        }

        .bairro-cor-indicator {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            border: 2px solid white;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .bairro-stats {
            display: flex;
            gap: 1.5rem;
            flex-wrap: wrap;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .bairro-stat {
            display: flex;
            align-items: center;
            gap: 0.4rem;
        }

        .bairro-acoes {
            display: flex;
            gap: 0.5rem;
        }

        .acoes-mapa-container {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
            flex-wrap: wrap;
            justify-content: center;
        }

        /* Responsividade para Mapa Eleitoral */
        @media (max-width: 768px) {
            .mapa-stats-grid {
                grid-template-columns: 1fr;
            }
            
            .filtros-mapa-grid {
                grid-template-columns: 1fr;
            }
            
            .cadastro-form-grid {
                grid-template-columns: 1fr;
            }
            
            .form-grupo.span-2 {
                grid-column: 1;
            }
            
            .lista-bairros-header {
                flex-direction: column;
                align-items: stretch;
            }
            
            .lista-controles {
                flex-direction: column;
            }
            
            .mapa-eleitoral {
                height: 350px;
                max-width: 100%;
                overflow: hidden;
            }
            
            .mapa-principal-container {
                overflow: hidden;
                max-width: 100%;
            }
            
            .mapa-interativo-container {
                width: 100%;
                max-width: 100%;
                overflow: hidden;
            }
            
            .filtros-mapa-container {
                overflow-x: auto;
                max-width: 100%;
            }
            
            .filtros-mapa-grid {
                min-width: 300px;
            }
            
            .cadastro-form-grid {
                grid-template-columns: 1fr;
            }
            
            .cadastro-form-grid .span-2 {
                grid-column: 1;
            }
            
            .lista-bairros-grid {
                grid-template-columns: 1fr;
            }
            
            .acoes-mapa-container {
                flex-direction: column;
                gap: 10px;
            }
            
            .grafico-wrapper {
                max-width: 100%;
                overflow: hidden;
            }
            
            .controles-grid {
                justify-content: center;
            }
            
            .acoes-mapa-container {
                flex-direction: column;
            }
        }

        /* ===== ESTILOS PARA RELATÓRIOS E GRÁFICOS ===== */
        .relatorios-content {
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }

        .export-buttons {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            margin-bottom: 1.5rem;
        }

        .btn-export {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.25rem;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
        }

        .btn-pdf {
            background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);
            color: white;
        }



        .btn-dados {
            background: linear-gradient(135deg, var(--primary-blue) 0%, #1e3a8a 100%);
            color: white;
        }

        .btn-export:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .graficos-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 1.5rem;
        }

        .grafico-card {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            border: 1px solid var(--border-light);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        .grafico-card h4 {
            margin: 0 0 1rem 0;
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-dark);
            text-align: center;
        }

        .grafico-card canvas {
            max-width: 100%;
            height: 250px !important;
        }

        /* ===== ESTILOS PARA RESPOSTAS AUTOMÁTICAS ===== */
        .respostas-content {
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }

        .nova-resposta-form {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            border: 1px solid var(--border-light);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        .respostas-lista h4 {
            margin: 0 0 1rem 0;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-dark);
        }

        .respostas-cards {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .resposta-card {
            background: white;
            border-radius: 8px;
            padding: 1rem;
            border: 1px solid var(--border-light);
            position: relative;
        }

        .resposta-palavras {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 0.75rem;
        }

        .palavra-tag {
            background: rgba(30, 64, 175, 0.1);
            color: var(--primary-blue);
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .resposta-texto {
            color: var(--text-secondary);
            font-size: 0.9rem;
            line-height: 1.4;
            margin-bottom: 0.75rem;
        }

        .resposta-actions {
            display: flex;
            gap: 0.5rem;
            justify-content: flex-end;
        }

        .btn-resposta {
            padding: 0.4rem 0.8rem;
            border: none;
            border-radius: 6px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .btn-edit {
            background: rgba(245, 158, 11, 0.1);
            color: #d97706;
        }

        .btn-delete {
            background: rgba(239, 68, 68, 0.1);
            color: #dc2626;
        }

        .btn-resposta:hover {
            transform: translateY(-1px);
        }

        /* ===== ESTILOS PARA GESTÃO DE NOTÍCIAS ===== */
        .noticias-content {
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }

        .nova-noticia-form {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            border: 1px solid var(--border-light);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        .nova-noticia-form h4 {
            margin: 0 0 1.5rem 0;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-dark);
        }

        .char-counter {
            color: var(--text-secondary);
            font-size: 0.8rem;
            margin-top: 0.25rem;
        }

        .form-hint {
            color: var(--text-secondary);
            font-size: 0.8rem;
            margin-top: 0.25rem;
        }

        .noticias-lista {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            border: 1px solid var(--border-light);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        .lista-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border-light);
        }

        .lista-header h4 {
            margin: 0;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-dark);
        }

        .lista-filtros select {
            padding: 0.5rem 1rem;
            border: 1px solid var(--border-light);
            border-radius: 6px;
            font-size: 0.9rem;
        }

        .noticias-cards {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .noticia-card {
            background: white;
            border: 1px solid var(--border-light);
            border-radius: 8px;
            padding: 1.25rem;
            transition: all 0.2s ease;
        }

        .noticia-card:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .noticia-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .noticia-info h5 {
            margin: 0 0 0.5rem 0;
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-dark);
            line-height: 1.3;
        }

        .noticia-meta {
            display: flex;
            align-items: center;
            gap: 1rem;
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .categoria-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 16px;
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .categoria-badge.health { background: #dcfce7; color: #166534; }
        .categoria-badge.education { background: #fef3c7; color: #92400e; }
        .categoria-badge.infrastructure { background: #dbeafe; color: #1e40af; }
        .categoria-badge.sports { background: #f3e8ff; color: #7c3aed; }
        .categoria-badge.economy { background: #ecfdf5; color: #059669; }
        .categoria-badge.environment { background: #f0fdf4; color: #16a34a; }
        .categoria-badge.security { background: #fef2f2; color: #dc2626; }

        .noticia-resumo {
            color: var(--text-secondary);
            font-size: 0.9rem;
            line-height: 1.4;
            margin-bottom: 1rem;
        }

        .noticia-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .tag-item {
            background: rgba(30, 64, 175, 0.1);
            color: var(--primary-blue);
            padding: 0.2rem 0.6rem;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 500;
        }

        .noticia-actions {
            display: flex;
            gap: 0.5rem;
            justify-content: flex-end;
            padding-top: 1rem;
            border-top: 1px solid var(--border-light);
        }

        .btn-noticia {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 6px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.4rem;
        }

        .btn-edit-noticia {
            background: rgba(245, 158, 11, 0.1);
            color: #d97706;
        }

        .btn-delete-noticia {
            background: rgba(239, 68, 68, 0.1);
            color: #dc2626;
        }

        .btn-view-noticia {
            background: rgba(30, 64, 175, 0.1);
            color: var(--primary-blue);
        }

        .btn-noticia:hover {
            transform: translateY(-1px);
        }

        /* ===== ESTILOS PARA GERENCIAR CONTEÚDO ===== */
        .conteudo-management {
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }

        .nova-noticia-card,
        .lista-noticias-card {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            border: 1px solid var(--border-light);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border-light);
        }

        .card-header h3 {
            margin: 0;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-dark);
        }

        .form-grid-conteudo {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .editor-toolbar {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 0.75rem;
            padding: 0.75rem;
            background: #f8fafc;
            border: 1px solid var(--border-light);
            border-radius: 8px 8px 0 0;
        }

        .editor-btn {
            padding: 0.5rem 0.75rem;
            background: white;
            border: 1px solid var(--border-light);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
            color: var(--text-secondary);
        }

        .editor-btn:hover {
            background: var(--primary-blue);
            color: white;
            border-color: var(--primary-blue);
        }

        .editor-content {
            min-height: 200px;
            padding: 1rem;
            border: 1px solid var(--border-light);
            border-top: none;
            border-radius: 0 0 8px 8px;
            outline: none;
            line-height: 1.6;
            background: white;
        }

        .editor-content:focus {
            border-color: var(--primary-blue);
            box-shadow: 0 0 0 3px rgba(30, 64, 175, 0.1);
        }

        .editor-content[contenteditable]:empty::before {
            content: attr(placeholder);
            color: var(--text-secondary);
            font-style: italic;
        }

        .char-counter-conteudo {
            color: var(--text-secondary);
            font-size: 0.8rem;
            margin-top: 0.5rem;
            display: block;
        }

        .filtros-noticias select {
            padding: 0.5rem 1rem;
            border: 1px solid var(--border-light);
            border-radius: 6px;
            font-size: 0.9rem;
            background: white;
        }

        .tabela-noticias-container {
            overflow-x: auto;
        }

        .tabela-noticias {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }

        .tabela-noticias th,
        .tabela-noticias td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid var(--border-light);
        }

        .tabela-noticias th {
            background: #f8fafc;
            font-weight: 600;
            color: var(--text-dark);
            position: sticky;
            top: 0;
        }

        .tabela-noticias img {
            width: 60px;
            height: 40px;
            object-fit: cover;
            border-radius: 6px;
        }

        .noticia-titulo {
            font-weight: 500;
            color: var(--text-dark);
            max-width: 300px;
            word-wrap: break-word;
        }

        .noticia-data {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .acoes-noticia {
            display: flex;
            gap: 0.5rem;
        }

        .btn-acao {
            padding: 0.4rem 0.8rem;
            border: none;
            border-radius: 6px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.4rem;
        }

        .btn-editar {
            background: rgba(245, 158, 11, 0.1);
            color: #d97706;
        }

        .btn-excluir {
            background: rgba(239, 68, 68, 0.1);
            color: #dc2626;
        }

        .btn-acao:hover {
            transform: translateY(-1px);
        }

        .estado-vazio {
            text-align: center;
            padding: 3rem 2rem;
            color: var(--text-secondary);
        }

        .estado-vazio i {
            font-size: 3rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        .estado-vazio h4 {
            margin: 0 0 0.5rem 0;
            font-size: 1.1rem;
            color: var(--text-dark);
        }

        .estado-vazio p {
            margin: 0;
            font-size: 0.9rem;
        }

        /* ===== RESPONSIVIDADE ===== */
        @media (max-width: 768px) {
            .export-buttons {
                flex-direction: column;
            }
            
            .btn-export {
                justify-content: center;
            }
            
            .graficos-grid {
                grid-template-columns: 1fr;
            }
            
            .lista-header {
                flex-direction: column;
                gap: 1rem;
                align-items: stretch;
            }
            
            .noticia-header {
                flex-direction: column;
                gap: 0.75rem;
            }
            
            .noticia-actions {
                flex-wrap: wrap;
            }
            
            .form-grid-conteudo {
                grid-template-columns: 1fr;
            }
            
            .card-header {
                flex-direction: column;
                gap: 1rem;
                align-items: stretch;
            }
            
            .editor-toolbar {
                flex-wrap: wrap;
            }
            
            .acoes-noticia {
                flex-direction: column;
            }
        }

        /* Responsividade da nova mensagem */
        @media (max-width: 768px) {
            .form-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
            }

            .destinatario-container {
                gap: 0.5rem;
            }

            .form-actions {
                flex-direction: column;
                gap: 0.75rem;
            }

            .btn-primary,
            .btn-secondary {
                width: 100%;
                justify-content: center;
            }

            .email-header {
                flex-direction: column;
                gap: 0.25rem;
            }
        }

        /* Modal Este Mandato é Seu */
        .mandato-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            padding: 1rem;
        }

        .mandato-modal.active {
            display: flex;
        }

        .mandato-content {
            background: var(--white);
            border-radius: 20px;
            max-width: 900px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.25);
            animation: modalSlideUp 0.3s ease-out;
        }

        @keyframes modalSlideUp {
            from {
                opacity: 0;
                transform: translateY(30px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .mandato-header {
            background: linear-gradient(135deg, var(--primary-blue), #1e3a8a);
            color: var(--white);
            padding: 2rem;
            border-radius: 20px 20px 0 0;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .mandato-header h2 {
            font-size: 1.5rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .close-mandato {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: var(--white);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }

        .close-mandato:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: rotate(90deg);
        }

        .mandato-body {
            padding: 2rem;
        }

        .mandato-intro {
            text-align: center;
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: linear-gradient(135deg, #fef3c7, #fef9e7);
            border-radius: 12px;
            border-left: 4px solid var(--primary-yellow);
        }

        .mandato-intro p {
            font-size: 1.1rem;
            color: var(--text-dark);
            line-height: 1.6;
            margin: 0;
        }

        .mandato-tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 2rem;
            background: var(--light-gray);
            padding: 0.5rem;
            border-radius: 12px;
        }

        .tab-btn {
            flex: 1;
            background: transparent;
            border: none;
            padding: 0.875rem 1.5rem;
            border-radius: 8px;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            color: var(--text-secondary);
        }

        .tab-btn.active {
            background: var(--white);
            color: var(--primary-blue);
            box-shadow: var(--shadow);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .sugestoes-form {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            padding: 0.875rem 1rem;
            border: 2px solid var(--medium-gray);
            border-radius: 8px;
            font-size: 1rem;
            transition: var(--transition);
            font-family: inherit;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--primary-blue);
            box-shadow: 0 0 0 3px rgba(30, 64, 175, 0.1);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 120px;
        }

        .enviar-sugestao-btn {
            background: linear-gradient(135deg, var(--primary-blue), #1e3a8a);
            color: var(--white);
            border: none;
            padding: 1rem 2rem;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .enviar-sugestao-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(30, 64, 175, 0.3);
        }

        .enviar-sugestao-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        /* Chat do Assistente */
        .chat-container {
            background: var(--light-gray);
            border-radius: 12px;
            height: 500px;
            display: flex;
            flex-direction: column;
        }

        .chat-messages {
            flex: 1;
            padding: 1rem;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .bot-message {
            display: flex;
            gap: 1rem;
            align-items: flex-start;
        }

        .user-message {
            display: flex;
            gap: 1rem;
            align-items: flex-start;
            flex-direction: row-reverse;
        }

        .message-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            flex-shrink: 0;
        }

        .bot-message .message-avatar {
            background: linear-gradient(135deg, var(--primary-blue), #1e3a8a);
            color: var(--white);
        }

        .user-message .message-avatar {
            background: linear-gradient(135deg, var(--primary-yellow), #f59e0b);
            color: var(--primary-blue);
        }

        .message-content {
            background: var(--white);
            padding: 1rem;
            border-radius: 12px;
            box-shadow: var(--shadow);
            max-width: 80%;
        }

        .user-message .message-content {
            background: linear-gradient(135deg, var(--primary-blue), #1e3a8a);
            color: var(--white);
        }

        .quick-options {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .quick-options button {
            background: var(--light-gray);
            border: 1px solid var(--medium-gray);
            padding: 0.5rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            transition: var(--transition);
            text-align: left;
            font-size: 0.9rem;
        }

        .quick-options button:hover {
            background: var(--primary-blue);
            color: var(--white);
            border-color: var(--primary-blue);
        }

        .chat-input-container {
            padding: 1rem;
            background: var(--white);
            border-radius: 0 0 12px 12px;
            display: flex;
            gap: 0.5rem;
        }

        .chat-input-container input {
            flex: 1;
            padding: 0.875rem 1rem;
            border: 2px solid var(--medium-gray);
            border-radius: 8px;
            font-size: 1rem;
            transition: var(--transition);
        }

        .chat-input-container input:focus {
            outline: none;
            border-color: var(--primary-blue);
        }

        .chat-input-container button {
            background: var(--primary-blue);
            color: var(--white);
            border: none;
            padding: 0.875rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            transition: var(--transition);
        }

        .chat-input-container button:hover {
            background: #1e3a8a;
        }

        /* Responsividade */
        @media (max-width: 768px) {
            .mandato-content {
                margin: 0.5rem;
                max-height: 95vh;
            }

            .mandato-header {
                padding: 1.5rem;
            }

            .mandato-body {
                padding: 1.5rem;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .mandato-tabs {
                flex-direction: column;
            }

            .tab-btn {
                justify-content: flex-start;
            }

            .chat-container {
                height: 400px;
            }
        }

        /* CSS para os novos módulos de gerenciamento de conteúdo */
        .content-editor-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .editor-card {
            background: var(--white);
            border-radius: 12px;
            box-shadow: var(--shadow);
            border: 1px solid var(--medium-gray);
            overflow: hidden;
        }

        .editor-card .card-header {
            background: linear-gradient(135deg, var(--primary-blue) 0%, #1e3a8a 100%);
            color: var(--white);
            padding: 1rem 1.5rem;
            border-bottom: 1px solid var(--medium-gray);
        }

        .editor-card .card-header h3 {
            margin: 0;
            font-size: 1.1rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .form-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1rem;
            padding: 1.5rem;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .form-group label {
            font-weight: 600;
            color: var(--text-dark);
            font-size: 0.9rem;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            padding: 0.75rem;
            border: 2px solid var(--medium-gray);
            border-radius: 8px;
            font-size: 0.9rem;
            transition: var(--transition);
            font-family: inherit;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--primary-blue);
            box-shadow: 0 0 0 3px rgba(30, 64, 175, 0.1);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }

        .char-counter {
            font-size: 0.8rem;
            color: var(--text-secondary);
            text-align: right;
            margin-top: 0.25rem;
        }

        .upload-section {
            margin-top: 1rem;
            padding: 1rem;
            background: var(--light-gray);
            border-radius: 8px;
        }

        .preview-container {
            margin-top: 1rem;
            padding: 1rem;
            border: 2px dashed var(--medium-gray);
            border-radius: 8px;
            text-align: center;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .preview-image {
            max-width: 100%;
            max-height: 200px;
            border-radius: 8px;
        }

        .galeria-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .galeria-item {
            background: var(--white);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: var(--shadow);
            border: 1px solid var(--medium-gray);
            transition: var(--transition);
        }

        .galeria-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .galeria-thumb {
            width: 100%;
            height: 120px;
            object-fit: cover;
            background: var(--light-gray);
        }

        .galeria-info {
            padding: 1rem;
        }

        .galeria-titulo {
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
        }

        .galeria-tipo {
            font-size: 0.8rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .galeria-acoes {
            display: flex;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }

        .btn-galeria {
            padding: 0.25rem 0.5rem;
            border: none;
            border-radius: 4px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: var(--transition);
        }

        .btn-galeria.edit {
            background: var(--warning);
            color: var(--white);
        }

        .btn-galeria.delete {
            background: var(--danger);
            color: var(--white);
        }

        .lista-container {
            background: var(--white);
            border-radius: 12px;
            box-shadow: var(--shadow);
            border: 1px solid var(--medium-gray);
            overflow: hidden;
            margin-top: 2rem;
        }

        .lista-header {
            background: var(--light-gray);
            padding: 1.5rem;
            border-bottom: 1px solid var(--medium-gray);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .lista-header h3 {
            margin: 0;
            color: var(--text-dark);
            font-size: 1.1rem;
        }

        .lista-filtros select {
            padding: 0.5rem;
            border: 1px solid var(--medium-gray);
            border-radius: 6px;
            font-size: 0.9rem;
        }

        .projeto-item,
        .noticia-item {
            padding: 1.5rem;
            border-bottom: 1px solid var(--medium-gray);
            transition: var(--transition);
        }

        .projeto-item:hover,
        .noticia-item:hover {
            background: var(--light-gray);
        }

        .projeto-item:last-child,
        .noticia-item:last-child {
            border-bottom: none;
        }

        .item-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .item-titulo {
            font-weight: 600;
            color: var(--text-dark);
            font-size: 1rem;
            margin-bottom: 0.5rem;
        }

        .item-meta {
            display: flex;
            gap: 1rem;
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .item-status {
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .status-aprovado {
            background: #dcfce7;
            color: #166534;
        }

        .status-andamento {
            background: #fef3c7;
            color: #92400e;
        }

        .status-rejeitado {
            background: #fef2f2;
            color: #dc2626;
        }

        .status-estudo {
            background: #dbeafe;
            color: #1e40af;
        }

        .item-descricao {
            color: var(--text-secondary);
            line-height: 1.5;
            margin-bottom: 1rem;
        }

        .item-acoes {
            display: flex;
            gap: 0.5rem;
        }

        .btn-item {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 6px;
            font-size: 0.8rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .btn-item.edit {
            background: var(--warning);
            color: var(--white);
        }

        .btn-item.edit:hover {
            background: #d97706;
        }

        .btn-item.delete {
            background: var(--danger);
            color: var(--white);
        }

        .btn-item.delete:hover {
            background: #dc2626;
        }

        .lista-vazia {
            padding: 3rem;
            text-align: center;
            color: var(--text-secondary);
        }

        .lista-vazia i {
            font-size: 3rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        /* Responsividade para os novos módulos */
        @media (max-width: 768px) {
            .content-editor-grid {
                grid-template-columns: 1fr;
            }

            .form-grid {
                padding: 1rem;
            }

            .lista-header {
                flex-direction: column;
                gap: 1rem;
                align-items: stretch;
            }

            .item-header {
                flex-direction: column;
                gap: 1rem;
            }

            .item-acoes {
                justify-content: flex-start;
            }

            .galeria-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            }
        }

        /* Estilos para Georreferenciamento */
        .geo-stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .geo-form-container {
            background: #f8fafc;
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
            border: 1px solid #e2e8f0;
        }

        .geo-form-container h3 {
            color: var(--primary-blue);
            font-size: 1.2rem;
            margin-bottom: 1.5rem;
            font-weight: 600;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
        }

        .form-group input,
        .form-group select {
            padding: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
            background: white;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--primary-blue);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .form-actions {
            display: flex;
            gap: 1rem;
            justify-content: flex-start;
        }

        .geo-list-container {
            background: white;
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
            border: 1px solid #e2e8f0;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .list-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .list-header h3 {
            color: var(--primary-blue);
            font-size: 1.2rem;
            font-weight: 600;
            margin: 0;
        }

        .list-actions {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .list-actions input,
        .list-actions select {
            padding: 8px 12px;
            border: 2px solid #e2e8f0;
            border-radius: 6px;
            font-size: 0.9rem;
        }

        .bairros-lista {
            display: grid;
            gap: 1rem;
        }

        .bairro-item {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
        }

        .bairro-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .bairro-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .bairro-cor {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            border: 2px solid white;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .bairro-details h4 {
            margin: 0;
            color: var(--text-dark);
            font-size: 1.1rem;
            font-weight: 600;
        }

        .bairro-details p {
            margin: 0.25rem 0 0 0;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .bairro-actions {
            display: flex;
            gap: 0.5rem;
        }

        .btn-sm {
            padding: 6px 12px;
            font-size: 0.8rem;
            border-radius: 4px;
        }

        .geo-map-container {
            background: white;
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
            border: 1px solid #e2e8f0;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .geo-map-container h3 {
            color: var(--primary-blue);
            font-size: 1.2rem;
            margin-bottom: 1.5rem;
            font-weight: 600;
        }

        .mapa-geo {
            width: 100%;
            height: 500px;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
            background: #f8fafc;
            margin-bottom: 1rem;
        }

        .geo-map-info {
            margin-bottom: 1.5rem;
        }

        .location-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .location-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem;
            background: #f1f5f9;
            border-radius: 6px;
            border: 1px solid #e2e8f0;
        }

        .location-item i {
            color: var(--primary-blue);
            font-size: 1rem;
            width: 16px;
        }

        .location-item span {
            color: var(--text-dark);
            font-weight: 500;
            font-size: 0.9rem;
        }

        .map-controls {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        .map-controls .btn {
            min-width: 120px;
        }

        /* Overlay da sidebar mobile */
        .sidebar-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 999;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .sidebar-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        /* Melhorias no botão mobile */
        @media (max-width: 768px) {
            .mobile-menu-toggle {
                display: block !important;
                background: rgba(255, 255, 255, 0.15) !important;
                backdrop-filter: blur(4px) !important;
                padding: 0.75rem !important;
                border-radius: 8px !important;
            }
        }

        .geo-chart-container {
            background: white;
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
            border: 1px solid #e2e8f0;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .geo-chart-container h3 {
            color: var(--primary-blue);
            font-size: 1.2rem;
            margin-bottom: 1.5rem;
            font-weight: 600;
        }

        .chart-wrapper {
            position: relative;
            height: 400px;
            width: 100%;
        }

        .geo-actions {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 2rem;
        }

        /* Responsividade para Georreferenciamento */
        @media (max-width: 768px) {
            .geo-stats-grid {
                grid-template-columns: 1fr;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .list-header {
                flex-direction: column;
                align-items: stretch;
            }
            
            .list-actions {
                flex-direction: column;
            }
            
            .bairro-item {
                flex-direction: column;
                align-items: stretch;
                gap: 1rem;
            }
            
            .bairro-info {
                justify-content: center;
            }
            
            .bairro-actions {
                justify-content: center;
            }
            
            .form-actions {
                flex-direction: column;
            }
            
            .geo-actions {
                flex-direction: column;
            }
            
            .mapa-geo {
                height: 300px;
            }
            
            /* Layout responsivo do painel */
            .sidebar {
                transform: translateX(-100%);
                z-index: 1000;
            }
            
            .sidebar.active {
                transform: translateX(0);
            }
            
            .main-content {
                margin-left: 0 !important;
                padding: 1rem !important;
            }
            
            .location-stats {
                grid-template-columns: 1fr;
            }
            
            .map-controls {
                flex-direction: column;
            }
            
            .map-controls .btn {
                min-width: auto;
            }
        }

        /* Layout para tablets */
        @media (min-width: 769px) and (max-width: 1024px) {
            .main-content {
                margin-left: var(--sidebar-width);
                padding: 1.5rem;
            }
            
            .location-stats {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* Layout para desktop */
        @media (min-width: 1025px) {
            .main-content {
                margin-left: var(--sidebar-width);
                padding: 2rem;
            }
            
            .location-stats {
                grid-template-columns: repeat(4, 1fr);
            }
        }
    </style>
</head>
<body>

    
    <!-- Header institucional -->
    <header class="institutional-header">
        <div class="header-brand">
            <button class="mobile-menu-btn" id="mobileMenuBtn">
                <i class="fas fa-bars"></i>
            </button>
            
            <div class="logo-section">
                <img src="logo.png" alt="Logo Gabinete" class="brand-logo">
                
                <div class="brand-text">
                    <h1>Liberdade & Desenvolvimento</h1>
                    <p>Emicleiton Rubem da Conceição - Monte Santo/BA</p>
                </div>
            </div>
            
            <img src="vereador.png" alt="Vereador Emicleiton Rubem" class="vereador-header-photo">
        </div>
        
        <div class="header-actions">
            <button class="sync-btn" onclick="forcarSincronizacaoSite()" title="Forçar atualização do site público">
                <i class="fas fa-sync-alt"></i>
                Sincronizar Site
            </button>
            
            <div class="user-info">
                <div class="user-avatar">
                    <i class="fas fa-user"></i>
                </div>
                <div class="user-details">
                    <strong>Vereador Emicleiton</strong>
                    <span>Administrador</span>
                </div>
            </div>
            
            <button class="logout-btn" onclick="logout()">
                <i class="fas fa-sign-out-alt"></i>
                Sair
            </button>
        </div>
    </header>

    <!-- Overlay do sidebar mobile -->
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="closeSidebar()"></div>

    <!-- Layout principal -->
    <div class="main-layout">
        <!-- Sidebar -->
        <nav class="sidebar" id="sidebar">
            <ul class="sidebar-nav">
                <li class="nav-item">
                    <a href="#" class="nav-link active" data-section="inicio">
                        <i class="nav-icon fas fa-home"></i>
                        <span>Início</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-section="cadastro">
                        <i class="nav-icon fas fa-user-plus"></i>
                        <span>Cadastro de Eleitores</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-section="gestao">
                        <i class="nav-icon fas fa-users-cog"></i>
                        <span>Gestão de Eleitores</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-section="comunicacao">
                        <i class="nav-icon fas fa-comments"></i>
                        <span>Comunicação</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-section="nova-mensagem">
                        <i class="nav-icon fas fa-paper-plane"></i>
                        <span>Nova Mensagem</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="painel_interacoes.html" class="nav-link">
                        <span class="nav-icon">📥</span>
                        <span>Interações</span>
                    </a>
                </li>
                <!-- Separador: Edição do Site -->
                <li class="nav-divider">
                    <span>EDITAR SITE PÚBLICO</span>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-section="editar-cabecalho">
                        <i class="nav-icon fas fa-header"></i>
                        <span>🔵 Cabeçalho</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-section="editar-botoes">
                        <i class="nav-icon fas fa-mouse-pointer"></i>
                        <span>🟡 Botões de Ação</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-section="editar-mandato">
                        <i class="nav-icon fas fa-landmark"></i>
                        <span>🟢 Mandato Atual</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-section="editar-biografia">
                        <i class="nav-icon fas fa-user-circle"></i>
                        <span>🟣 Biografia</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-section="projetos-admin">
                        <i class="nav-icon fas fa-lightbulb"></i>
                        <span>🟠 Projetos</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-section="agenda-admin">
                        <i class="nav-icon fas fa-calendar"></i>
                        <span>🔵 Agenda Pública</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-section="noticias-admin">
                        <i class="nav-icon fas fa-newspaper"></i>
                        <span>🟣 Notícias</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-section="galeria-admin">
                        <i class="nav-icon fas fa-images"></i>
                        <span>🟢 Galeria</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-section="editar-contato">
                        <i class="nav-icon fas fa-address-book"></i>
                        <span>🟡 Contato</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-section="editar-rodape">
                        <i class="nav-icon fas fa-anchor"></i>
                        <span>🟠 Rodapé</span>
                    </a>
                </li>

                <li class="nav-item">
                    <a href="#" class="nav-link" data-section="gerenciar-conteudo">
                        <i class="nav-icon fas fa-edit"></i>
                        <span>Editor de Texto</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-section="configuracoes">
                        <i class="nav-icon fas fa-cog"></i>
                        <span>Configurações</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-section="relatorios">
                        <i class="nav-icon fas fa-chart-bar"></i>
                        <span>Relatórios</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-section="mapa-eleitoral">
                        <i class="nav-icon fas fa-map-marked-alt"></i>
                        <span>🗺️ Mapa Eleitoral</span>
                    </a>
                </li>

                <li class="nav-item">
                    <a href="#" class="nav-link" onclick="logout()">
                        <i class="nav-icon fas fa-sign-out-alt"></i>
                        <span>Sair</span>
                    </a>
                </li>
            </ul>
        </nav>

        <!-- Conteúdo principal -->
        <main class="main-content">
            <!-- Seção Início -->
            <section class="panel-section active" id="inicio">
                <div class="section-header">
                    <h2 class="section-title">
                        <i class="fas fa-tachometer-alt"></i>
                        Liberdade & Desenvolvimento
                    </h2>
                    <p class="section-subtitle">Sistema completo de gestão política • Bem-vindo, vereador Emicleiton!</p>
                </div>

                <!-- Card do Mandato Atual -->
                <div class="mandato-card">
                    <div class="mandato-header">
                        <div class="mandato-icon">
                            <i class="fas fa-landmark"></i>
                        </div>
                        <div class="mandato-info">
                            <h3>Mandato Atual</h3>
                            <p>2021 - 2024</p>
                        </div>
                        <div class="mandato-status">
                            <span class="status-badge ativo">Em Exercício</span>
                        </div>
                    </div>
                    <div class="mandato-stats">
                        <div class="stat-item">
                            <span class="stat-number">3</span>
                            <span class="stat-label">Anos de Mandato</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-number">42</span>
                            <span class="stat-label">Projetos Ativos</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-number">1,247</span>
                            <span class="stat-label">Cidadãos Atendidos</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-number">95%</span>
                            <span class="stat-label">Satisfação</span>
                        </div>
                    </div>
                </div>

                <!-- Cards informativos -->
                <div class="info-cards">
                    <div class="info-card">
                        <div class="card-header">
                            <div class="card-icon primary">
                                <i class="fas fa-users"></i>
                            </div>
                        </div>
                        <div class="card-value" id="totalEleitores">1,247</div>
                        <div class="card-title">Total de Eleitores Cadastrados</div>
                        <div class="card-description">Cidadãos registrados no sistema</div>
                        <div class="card-trend">
                            <i class="fas fa-arrow-up trend-positive"></i>
                            <span class="trend-positive">+12% este mês</span>
                        </div>
                    </div>

                    <div class="info-card">
                        <div class="card-header">
                            <div class="card-icon success">
                                <i class="fas fa-birthday-cake"></i>
                            </div>
                        </div>
                        <div class="card-value" id="aniversariantesHoje">8</div>
                        <div class="card-title">Aniversariantes do Dia</div>
                        <div class="card-description">Eleitores fazendo aniversário hoje</div>
                        <div class="card-trend">
                            <i class="fas fa-calendar trend-neutral"></i>
                            <span class="trend-neutral">Data: <span id="dataAtual"></span></span>
                        </div>
                    </div>

                    <div class="info-card">
                        <div class="card-header">
                            <div class="card-icon warning">
                                <i class="fas fa-headset"></i>
                            </div>
                        </div>
                        <div class="card-value" id="atendimentosHoje">23</div>
                        <div class="card-title">Atendimentos Registrados Hoje</div>
                        <div class="card-description">Solicitações e consultas recebidas</div>
                        <div class="card-trend">
                            <i class="fas fa-arrow-up trend-positive"></i>
                            <span class="trend-positive">+5 desde ontem</span>
                        </div>
                    </div>
                </div>

                <!-- Ações rápidas -->
                <div class="quick-actions">
                    <h3 style="margin-bottom: 1rem; color: var(--text-dark); font-weight: 600;">Ações Rápidas</h3>
                    <div class="actions-grid">
                        <a href="#" class="action-card" onclick="novoEleitor()">
                            <div class="action-icon">
                                <i class="fas fa-user-plus"></i>
                            </div>
                            <div class="action-title">Novo Eleitor</div>
                        </a>

                        <a href="#" class="action-card" onclick="novaMensagem()">
                            <div class="action-icon">
                                <i class="fas fa-envelope"></i>
                            </div>
                            <div class="action-title">Nova Mensagem</div>
                        </a>

                        <a href="#" class="action-card" onclick="gerarRelatorio()">
                            <div class="action-icon">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <div class="action-title">Gerar Relatório</div>
                        </a>

                        <a href="#" class="action-card" onclick="verMapa()">
                            <div class="action-icon">
                                <i class="fas fa-map"></i>
                            </div>
                            <div class="action-title">Ver Mapa</div>
                        </a>

                        <a href="editor-completo.html" class="action-card" target="_blank">
                            <div class="action-icon" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%);">
                                <i class="fas fa-edit"></i>
                            </div>
                            <div class="action-title">Editor Completo</div>
                        </a>
                    </div>
                </div>
            </section>

            <!-- Seção Cadastro de Eleitores -->
            <section class="panel-section" id="cadastro">
                <div class="section-header">
                    <h2 class="section-title">Cadastro de Eleitores</h2>
                    <p class="section-subtitle">Gerencie o cadastro de eleitores do gabinete</p>
                </div>
                
                <div class="cadastro-content">
                    <div class="form-container">
                        <form id="cadastroEleitorForm" class="eleitor-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="nomeCompleto" class="form-label">Nome Completo *</label>
                                    <input type="text" id="nomeCompleto" class="form-input" required>
                                </div>
                                <div class="form-group">
                                    <label for="dataNascimento" class="form-label">Data de Nascimento *</label>
                                    <input type="date" id="dataNascimento" class="form-input" required>
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="telefone" class="form-label">Telefone *</label>
                                    <input type="tel" id="telefone" class="form-input" required>
                                </div>
                                <div class="form-group">
                                    <label for="email" class="form-label">E-mail</label>
                                    <input type="email" id="email" class="form-input">
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="endereco" class="form-label">Endereço *</label>
                                    <input type="text" id="endereco" class="form-input" required>
                                </div>
                                <div class="form-group">
                                    <label for="bairro" class="form-label">Bairro *</label>
                                    <select id="bairro" class="form-input" required>
                                        <option value="">Selecione o bairro</option>
                                        <option value="Centro">Centro</option>
                                        <option value="São José">São José</option>
                                        <option value="Santa Luzia">Santa Luzia</option>
                                        <option value="Vila Nova">Vila Nova</option>
                                        <option value="Alto da Boa Vista">Alto da Boa Vista</option>
                                        <option value="Outros">Outros</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="form-actions">
                                <button type="submit" class="btn-primary">
                                    <i class="fas fa-save"></i>
                                    Cadastrar Eleitor
                                </button>
                                <button type="button" class="btn-secondary" onclick="limparFormulario()">
                                    <i class="fas fa-eraser"></i>
                                    Limpar Formulário
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </section>

            <!-- Seção Comunicação -->
            <section class="panel-section" id="comunicacao">
                <div class="section-header">
                    <h2 class="section-title">Comunicação</h2>
                    <p class="section-subtitle">Gerencie mensagens e comunicados</p>
                </div>
                
                <div class="comunicacao-content">
                    <div class="form-container">
                        <form id="mensagemForm" class="mensagem-form">
                            <div class="form-group">
                                <label for="assuntoMensagem" class="form-label">Assunto *</label>
                                <input type="text" id="assuntoMensagem" class="form-input" required placeholder="Digite o assunto da mensagem">
                            </div>
                            
                            <div class="form-group">
                                <label for="conteudoMensagem" class="form-label">Mensagem *</label>
                                <textarea id="conteudoMensagem" class="form-textarea" rows="6" required placeholder="Digite o conteúdo da mensagem..."></textarea>
                            </div>
                            
                            <div class="form-actions">
                                <button type="submit" class="btn-primary">
                                    <i class="fas fa-paper-plane"></i>
                                    Enviar Mensagem
                                </button>
                                <button type="button" class="btn-secondary" onclick="limparMensagem()">
                                    <i class="fas fa-eraser"></i>
                                    Limpar
                                </button>
                            </div>
                        </form>
                    </div>
                    
                    <!-- Lista de mensagens enviadas -->
                    <div class="mensagens-enviadas">
                        <h4>Mensagens Enviadas Recentemente</h4>
                        <div id="listaMensagens" class="lista-mensagens">
                            <!-- Mensagens serão carregadas aqui -->
                        </div>
                    </div>
                </div>
            </section>

            <!-- Seção Relatórios -->
            <section class="panel-section" id="relatorios">
                <div class="section-header">
                    <h2 class="section-title">Relatórios</h2>
                    <p class="section-subtitle">Visualize dados e estatísticas</p>
                </div>
                
                <div class="relatorios-content">
                    <div class="info-cards">
                        <div class="info-card">
                            <div class="card-header">
                                <div class="card-icon primary">
                                    <i class="fas fa-download"></i>
                                </div>
                            </div>
                            <div class="card-title">Relatório de Eleitores</div>
                            <div class="card-description">Exportar lista completa de eleitores cadastrados</div>
                            <div style="margin-top: 1rem;">
                                <button onclick="exportarRelatorioPDF()" class="btn-primary">
                                    <i class="fas fa-file-pdf"></i>
                                    Baixar PDF
                                </button>
                            </div>
                        </div>
                        
                        <div class="info-card">
                            <div class="card-header">
                                <div class="card-icon success">
                                    <i class="fas fa-chart-pie"></i>
                                </div>
                            </div>
                            <div class="card-title">Estatísticas por Bairro</div>
                            <div class="card-description">Visualizar distribuição de eleitores</div>
                            <div style="margin-top: 1rem;">
                                <button onclick="mostrarEstatisticas()" class="btn-primary">
                                    <i class="fas fa-chart-bar"></i>
                                    Ver Estatísticas
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div id="estatisticasContainer" style="display: none;">
                        <h4>Distribuição de Eleitores por Bairro</h4>
                        <div id="graficoEstatisticas" class="grafico-container">
                            <!-- Gráfico será inserido aqui -->
                        </div>
                    </div>
                </div>
            </section>

            <!-- Seção Gestão de Eleitores -->
            <section class="panel-section" id="gestao">
                <div class="section-header">
                    <h2 class="section-title">Gestão de Eleitores</h2>
                    <p class="section-subtitle">Visualize, filtre e gerencie a base de eleitores cadastrados</p>
                </div>
                
                <div class="gestao-content">
                    <!-- Filtros Dinâmicos -->
                    <div class="filtros-container">
                        <h4>Filtros</h4>
                        <div class="filtros-grid">
                            <div class="filtro-group">
                                <label for="filtroBairro" class="filtro-label">Bairro</label>
                                <select id="filtroBairro" class="filtro-select">
                                    <option value="">Todos os bairros</option>
                                    <option value="Centro">Centro</option>
                                    <option value="São José">São José</option>
                                    <option value="Santa Luzia">Santa Luzia</option>
                                    <option value="Vila Nova">Vila Nova</option>
                                    <option value="Alto da Boa Vista">Alto da Boa Vista</option>
                                    <option value="Outros">Outros</option>
                                </select>
                            </div>
                            
                            <div class="filtro-group">
                                <label for="filtroIdade" class="filtro-label">Faixa Etária</label>
                                <select id="filtroIdade" class="filtro-select">
                                    <option value="">Todas as idades</option>
                                    <option value="16-24">16-24 anos</option>
                                    <option value="25-34">25-34 anos</option>
                                    <option value="35-49">35-49 anos</option>
                                    <option value="50+">50+ anos</option>
                                </select>
                            </div>
                            
                            <div class="filtro-group">
                                <label for="filtroGenero" class="filtro-label">Gênero</label>
                                <select id="filtroGenero" class="filtro-select">
                                    <option value="">Todos os gêneros</option>
                                    <option value="Masculino">Masculino</option>
                                    <option value="Feminino">Feminino</option>
                                    <option value="Outro">Outro</option>
                                </select>
                            </div>
                            
                            <div class="filtro-group">
                                <button onclick="limparFiltros()" class="btn-filtro-limpar">
                                    <i class="fas fa-times"></i>
                                    Limpar Filtros
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Estatísticas e Ações -->
                    <div class="stats-container">
                        <div class="stats-cards">
                            <div class="stat-card">
                                <div class="stat-icon">
                                    <i class="fas fa-users"></i>
                                </div>
                                <div class="stat-content">
                                    <div class="stat-number" id="totalExibidos">0</div>
                                    <div class="stat-label">Eleitores Exibidos</div>
                                </div>
                            </div>
                            
                            <div class="stat-card">
                                <div class="stat-icon success">
                                    <i class="fas fa-check-circle"></i>
                                </div>
                                <div class="stat-content">
                                    <div class="stat-number" id="totalPresentes">0</div>
                                    <div class="stat-label">Presentes no Evento</div>
                                </div>
                            </div>
                            
                            <div class="stat-card">
                                <div class="stat-icon warning">
                                    <i class="fas fa-percentage"></i>
                                </div>
                                <div class="stat-content">
                                    <div class="stat-number" id="percentualPresenca">0%</div>
                                    <div class="stat-label">Taxa de Presença</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="acoes-container">
                            <button onclick="exportarEleitoresPDF()" class="btn-acao">
                                <i class="fas fa-file-pdf"></i>
                                Exportar PDF
                            </button>
                            <button onclick="marcarTodosPresentes()" class="btn-acao">
                                <i class="fas fa-check-double"></i>
                                Marcar Todos Presentes
                            </button>
                            <button onclick="limparPresencas()" class="btn-acao secondary">
                                <i class="fas fa-user-times"></i>
                                Limpar Presenças
                            </button>
                        </div>
                    </div>
                    
                    <!-- Tabela de Eleitores -->
                    <div class="tabela-container">
                        <div class="tabela-header">
                            <h4>Lista de Eleitores</h4>
                            <div class="tabela-info">
                                <span id="infoTabela">Carregando...</span>
                            </div>
                        </div>
                        
                        <div class="tabela-wrapper">
                            <table class="tabela-eleitores" id="tabelaEleitores">
                                <thead>
                                    <tr>
                                        <th>Nome Completo</th>
                                        <th>Idade</th>
                                        <th>Gênero</th>
                                        <th>Bairro</th>
                                        <th>Telefone</th>
                                        <th>Presença</th>
                                    </tr>
                                </thead>
                                <tbody id="corpoTabela">
                                    <!-- Dados serão inseridos aqui -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Seção Nova Mensagem -->
            <section class="panel-section" id="nova-mensagem">
                <div class="section-header">
                    <h2 class="section-title">📨 Nova Mensagem</h2>
                    <p class="section-subtitle">Envie e-mails diretamente para eleitores cadastrados</p>
                </div>
                
                <div class="nova-mensagem-content">
                    <div class="form-email-container">
                        <form id="formEmail" onsubmit="enviarEmailReal(event)">
                            <div class="form-grid">
                                <div class="form-group">
                                    <label for="nomeRemetente" class="form-label">
                                        <i class="fas fa-user"></i>
                                        Nome do Remetente *
                                    </label>
                                    <input type="text" id="nomeRemetente" class="form-input" 
                                           placeholder="Seu nome completo" required>
                                </div>
                                
                                <div class="form-group">
                                    <label for="emailRemetente" class="form-label">
                                        <i class="fas fa-at"></i>
                                        E-mail do Remetente *
                                    </label>
                                    <input type="email" id="emailRemetente" class="form-input" 
                                           placeholder="seu@email.com" required>
                                </div>
                                
                                <div class="form-group">
                                    <label for="assuntoEmail" class="form-label">
                                        <i class="fas fa-tag"></i>
                                        Assunto *
                                    </label>
                                    <input type="text" id="assuntoEmail" class="form-input" 
                                           placeholder="Digite o assunto da mensagem" required>
                                </div>
                                
                                <div class="form-group">
                                    <label for="destinatarioEmail" class="form-label">
                                        <i class="fas fa-envelope"></i>
                                        Destinatário
                                    </label>
                                    <select id="destinatarioEmail" class="form-select" required>
                                        <option value="">Selecione o destinatário...</option>
                                        <option value="gabinete.emicleiton@gmail.com">Gabinete - gabinete.emicleiton@gmail.com</option>
                                        <option value="assessoria.emicleiton@gmail.com">Assessoria - assessoria.emicleiton@gmail.com</option>
                                        <option value="comunicacao.emicleiton@gmail.com">Comunicação - comunicacao.emicleiton@gmail.com</option>
                                    </select>
                                </div>
                            </div>
                            
                            <!-- Campo oculto título -->
                            <input type="hidden" id="tituloFixo" value="Mensagem do Gabinete Digital">
                            
                            <div class="form-group">
                                <label for="mensagemEmail" class="form-label">
                                    <i class="fas fa-comment-alt"></i>
                                    Mensagem *
                                </label>
                                <textarea id="mensagemEmail" class="form-textarea" rows="8" 
                                          placeholder="Digite sua mensagem aqui..." required></textarea>
                            </div>
                            
                            <div class="form-actions">
                                <button type="submit" class="btn-primary" id="btnEnviarReal">
                                    <i class="fas fa-paper-plane"></i>
                                    Enviar E-mail
                                </button>
                                <button type="button" class="btn-secondary" onclick="limparFormularioEmailReal()">
                                    <i class="fas fa-eraser"></i>
                                    Limpar Formulário
                                </button>
                            </div>
                            
                            <!-- Loader -->
                            <div id="loaderEnvio" class="loader-envio" style="display: none;">
                                <div class="loader-spinner">
                                    <i class="fas fa-spinner fa-spin"></i>
                                </div>
                                <span>Enviando e-mail...</span>
                            </div>
                        </form>
                    </div>
                    
                    <!-- Status do envio -->
                    <div id="statusEnvio" class="status-envio" style="display: none;">
                        <div class="status-content">
                            <i class="status-icon"></i>
                            <span class="status-text"></span>
                        </div>
                    </div>
                    
                    <!-- Histórico de e-mails -->
                    <div class="historico-emails">
                        <h4>
                            <i class="fas fa-history"></i>
                            Últimos E-mails Enviados
                        </h4>
                        <div id="listaEmails" class="emails-list">
                            <!-- E-mails serão inseridos aqui -->
                        </div>
                    </div>
                </div>
            </section>

            <!-- Seção Relatórios e Gráficos -->
            <section class="panel-section" id="relatorios">
                <div class="section-header">
                    <h2 class="section-title">📊 Relatórios e Gráficos</h2>
                    <p class="section-subtitle">Análise visual dos dados de atendimento e exportação de relatórios</p>
                </div>
                
                <div class="relatorios-content">
                    <!-- Botões de Exportação -->
                    <div class="export-buttons">
                        <button class="btn-export btn-pdf" onclick="exportarRelatorioEleitorePDF()">
                            <i class="fas fa-file-pdf"></i>
                            Exportar PDF
                        </button>
                        <button class="btn-export btn-dados" onclick="atualizarGraficos()">
                            <i class="fas fa-sync-alt"></i>
                            Atualizar Dados
                        </button>
                    </div>
                    
                    <!-- Grid de Gráficos -->
                    <div class="graficos-grid">
                        <div class="grafico-card">
                            <h4>Atendimentos por Tipo</h4>
                            <canvas id="graficoTipos" width="400" height="200"></canvas>
                        </div>
                        
                        <div class="grafico-card">
                            <h4>Atendimentos por Mês</h4>
                            <canvas id="graficoMeses" width="400" height="200"></canvas>
                        </div>
                        
                        <div class="grafico-card">
                            <h4>Status dos Atendimentos</h4>
                            <canvas id="graficoStatus" width="400" height="200"></canvas>
                        </div>
                        
                        <div class="grafico-card">
                            <h4>Evolução Mensal</h4>
                            <canvas id="graficoEvolucao" width="400" height="200"></canvas>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Seção Respostas Automáticas -->
            <section class="panel-section" id="respostas-automaticas">
                <div class="section-header">
                    <h2 class="section-title">🤖 Respostas Automáticas</h2>
                    <p class="section-subtitle">Configurar respostas baseadas em palavras-chave</p>
                </div>
                
                <div class="respostas-content">
                    <!-- Formulário para Nova Resposta -->
                    <div class="nova-resposta-form">
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="palavrasChave" class="form-label">
                                    <i class="fas fa-key"></i>
                                    Palavras-chave (separadas por vírgula)
                                </label>
                                <input type="text" id="palavrasChave" class="form-input" 
                                       placeholder="ex: saúde, posto, médico">
                            </div>
                            
                            <div class="form-group">
                                <label for="respostaTexto" class="form-label">
                                    <i class="fas fa-reply"></i>
                                    Resposta Automática
                                </label>
                                <textarea id="respostaTexto" class="form-textarea" rows="4" 
                                          placeholder="Digite a resposta que será enviada automaticamente..."></textarea>
                            </div>
                        </div>
                        
                        <div class="form-actions">
                            <button type="button" class="btn-primary" onclick="adicionarRespostaAutomatica()">
                                <i class="fas fa-plus"></i>
                                Adicionar Resposta
                            </button>
                        </div>
                    </div>
                    
                    <!-- Lista de Respostas Configuradas -->
                    <div class="respostas-lista">
                        <h4>Respostas Configuradas</h4>
                        <div id="listaRespostasAutomaticas" class="respostas-cards">
                            <!-- Respostas serão listadas aqui -->
                        </div>
                    </div>
                </div>
            </section>

            <!-- Seção Gestão de Notícias -->
            <section class="panel-section" id="noticias">
                <div class="section-header">
                    <h2 class="section-title">📰 Gestão de Notícias</h2>
                    <p class="section-subtitle">Publique e gerencie notícias do site público</p>
                </div>
                
                <div class="noticias-content">
                    <!-- Formulário para Nova Notícia -->
                    <div class="nova-noticia-form">
                        <h4>📝 Publicar Nova Notícia</h4>
                        <form id="formNoticia" onsubmit="publicarNoticia(event)">
                            <div class="form-grid">
                                <div class="form-group">
                                    <label for="tituloNoticia" class="form-label">
                                        <i class="fas fa-heading"></i>
                                        Título da Notícia *
                                    </label>
                                    <input type="text" id="tituloNoticia" class="form-input" 
                                           placeholder="Digite o título da notícia" required maxlength="120">
                                </div>
                                
                                <div class="form-group">
                                    <label for="categoriaNoticia" class="form-label">
                                        <i class="fas fa-tags"></i>
                                        Categoria
                                    </label>
                                    <select id="categoriaNoticia" class="form-select" required>
                                        <option value="">Selecione uma categoria...</option>
                                        <option value="health">Saúde</option>
                                        <option value="education">Educação</option>
                                        <option value="infrastructure">Infraestrutura</option>
                                        <option value="sports">Esporte</option>
                                        <option value="economy">Economia</option>
                                        <option value="environment">Meio Ambiente</option>
                                        <option value="security">Segurança</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="resumoNoticia" class="form-label">
                                    <i class="fas fa-align-left"></i>
                                    Resumo da Notícia *
                                </label>
                                <textarea id="resumoNoticia" class="form-textarea" rows="3" 
                                          placeholder="Escreva um resumo da notícia (máximo 200 caracteres)" 
                                          required maxlength="200"></textarea>
                                <small class="char-counter">0/200 caracteres</small>
                            </div>
                            
                            <div class="form-group">
                                <label for="imagemNoticia" class="form-label">
                                    <i class="fas fa-image"></i>
                                    URL da Imagem
                                </label>
                                <input type="url" id="imagemNoticia" class="form-input" 
                                       placeholder="https://exemplo.com/imagem.jpg">
                                <small class="form-hint">Deixe em branco para usar imagem padrão</small>
                            </div>
                            
                            <div class="form-group">
                                <label for="conteudoNoticia" class="form-label">
                                    <i class="fas fa-file-alt"></i>
                                    Texto Completo *
                                </label>
                                <textarea id="conteudoNoticia" class="form-textarea" rows="8" 
                                          placeholder="Escreva o conteúdo completo da notícia..." required></textarea>
                            </div>
                            
                            <div class="form-group">
                                <label for="tagsNoticia" class="form-label">
                                    <i class="fas fa-hashtag"></i>
                                    Tags (separadas por vírgula)
                                </label>
                                <input type="text" id="tagsNoticia" class="form-input" 
                                       placeholder="ex: saúde pública, infraestrutura, benefícios">
                            </div>
                            
                            <div class="form-actions">
                                <button type="submit" class="btn-primary">
                                    <i class="fas fa-bullhorn"></i>
                                    Publicar Notícia
                                </button>
                                <button type="button" class="btn-secondary" onclick="limparFormularioNoticia()">
                                    <i class="fas fa-eraser"></i>
                                    Limpar Formulário
                                </button>
                            </div>
                        </form>
                    </div>
                    
                    <!-- Lista de Notícias Publicadas -->
                    <div class="noticias-lista">
                        <div class="lista-header">
                            <h4>📋 Notícias Publicadas</h4>
                            <div class="lista-filtros">
                                <select id="filtroCategoriaNoticias" onchange="filtrarNoticias()">
                                    <option value="">Todas as categorias</option>
                                    <option value="health">Saúde</option>
                                    <option value="education">Educação</option>
                                    <option value="infrastructure">Infraestrutura</option>
                                    <option value="sports">Esporte</option>
                                    <option value="economy">Economia</option>
                                    <option value="environment">Meio Ambiente</option>
                                    <option value="security">Segurança</option>
                                </select>
                            </div>
                        </div>
                        
                        <div id="listaNoticias" class="noticias-cards">
                            <!-- Notícias serão listadas aqui -->
                        </div>
                    </div>
                </div>
            </section>

            <!-- Seção Gerenciar Conteúdo -->
            <section class="panel-section" id="gerenciar-conteudo">
                <div class="section-header">
                    <h2 class="section-title">✏️ Gerenciar Conteúdo</h2>
                    <p class="section-subtitle">Cadastre e gerencie notícias para o site público</p>
                </div>
                
                <div class="conteudo-management">
                    <!-- Formulário para Nova Notícia -->
                    <div class="nova-noticia-card">
                        <div class="card-header">
                            <h3>📰 Cadastrar Nova Notícia</h3>
                            <button class="btn-primary" id="btnNovaNoticia" onclick="toggleFormularioNoticia()">
                                <i class="fas fa-plus"></i>
                                Nova Notícia
                            </button>
                        </div>
                        
                        <div class="formulario-noticia" id="formularioNoticia" style="display: none;">
                            <form id="formNoticiaConteudo" onsubmit="salvarNoticia(event)">
                                <div class="form-grid-conteudo">
                                    <div class="form-group">
                                        <label for="tituloNoticiaConteudo" class="form-label">
                                            <i class="fas fa-heading"></i>
                                            Título *
                                        </label>
                                        <input type="text" id="tituloNoticiaConteudo" class="form-input" 
                                               placeholder="Digite o título da notícia" required maxlength="150">
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="imagemNoticia" class="form-label">
                                            <i class="fas fa-image"></i>
                                            URL da Imagem
                                        </label>
                                        <input type="url" id="imagemNoticia" class="form-input" 
                                               placeholder="https://exemplo.com/imagem.jpg">
                                        <small class="form-hint">Deixe em branco para usar imagem padrão</small>
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label for="videoNoticia" class="form-label">
                                        <i class="fab fa-youtube"></i>
                                        Link do YouTube (opcional)
                                    </label>
                                    <input type="url" id="videoNoticia" class="form-input" 
                                           placeholder="https://www.youtube.com/watch?v=...">
                                    <small class="form-hint">Cole o link completo do vídeo do YouTube</small>
                                </div>
                                
                                <div class="form-group">
                                    <label for="textoNoticia" class="form-label">
                                        <i class="fas fa-file-alt"></i>
                                        Texto da Notícia *
                                    </label>
                                    <div class="editor-toolbar">
                                        <button type="button" class="editor-btn" onclick="formatText('bold')">
                                            <i class="fas fa-bold"></i>
                                        </button>
                                        <button type="button" class="editor-btn" onclick="formatText('italic')">
                                            <i class="fas fa-italic"></i>
                                        </button>
                                        <button type="button" class="editor-btn" onclick="formatText('underline')">
                                            <i class="fas fa-underline"></i>
                                        </button>
                                        <button type="button" class="editor-btn" onclick="insertList()">
                                            <i class="fas fa-list"></i>
                                        </button>
                                    </div>
                                    <div id="textoNoticia" class="editor-content" contenteditable="true" 
                                         placeholder="Digite o texto completo da notícia aqui. Você pode usar formatação HTML básica..."></div>
                                    <small class="char-counter-conteudo">0 caracteres</small>
                                </div>
                                
                                <div class="form-actions">
                                    <button type="submit" class="btn-primary">
                                        <i class="fas fa-save"></i>
                                        Salvar Notícia
                                    </button>
                                    <button type="button" class="btn-secondary" onclick="cancelarEdicao()">
                                        <i class="fas fa-times"></i>
                                        Cancelar
                                    </button>
                                </div>
                                
                                <!-- Campo oculto para ID da notícia em edição -->
                                <input type="hidden" id="noticiaEditandoId" value="">
                            </form>
                        </div>
                    </div>
                    
                    <!-- Lista de Notícias -->
                    <div class="lista-noticias-card">
                        <div class="card-header">
                            <h3>📋 Notícias Cadastradas</h3>
                            <div class="filtros-noticias">
                                <select id="filtroStatusNoticia" onchange="filtrarNoticiasConteudo()">
                                    <option value="">Todas as notícias</option>
                                    <option value="recente">Recentes</option>
                                    <option value="antiga">Mais antigas</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="tabela-noticias-container">
                            <table class="tabela-noticias" id="tabelaNoticias">
                                <thead>
                                    <tr>
                                        <th>Imagem</th>
                                        <th>Título</th>
                                        <th>Data</th>
                                        <th>Ações</th>
                                    </tr>
                                </thead>
                                <tbody id="corpoTabelaNoticias">
                                    <!-- Notícias serão listadas aqui -->
                                </tbody>
                            </table>
                            
                            <div id="estadoVazioNoticias" class="estado-vazio" style="display: none;">
                                <i class="fas fa-newspaper"></i>
                                <h4>Nenhuma notícia cadastrada</h4>
                                <p>Clique em "Nova Notícia" para criar sua primeira notícia</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Seção Georreferenciamento -->
            <section class="panel-section" id="georreferenciamento">
                <div class="section-header">
                    <h2 class="section-title">🗺️ Georreferenciamento</h2>
                    <p class="section-subtitle">Visualize a distribuição geográfica dos eleitores</p>
                </div>
                
                <div class="geo-content">
                    <div class="mapa-container">
                        <h4>Distribuição de Eleitores por Bairro - Monte Santo/BA</h4>
                        <div id="mapaEstatistico" class="mapa-estatistico">
                            <!-- Mapa estatístico será inserido aqui -->
                        </div>
                    </div>
                </div>
            </section>

            <!-- Nova Seção: Editar Conteúdo do Site -->
            <section class="panel-section" id="conteudo-site">
                <div class="section-header">
                    <h2 class="section-title">🌐 Editar Conteúdo do Site</h2>
                    <p class="section-subtitle">Gerencie todo o conteúdo do site público sem tocar no código</p>
                </div>

                <div class="content-editor-grid">
                    <!-- Cabeçalho do Site -->
                    <div class="editor-card">
                        <div class="card-header">
                            <h3><i class="fas fa-heading"></i> Cabeçalho do Site</h3>
                        </div>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="tituloSite">Título Principal</label>
                                <input type="text" id="tituloSite" placeholder="Gabinete Digital" maxlength="50">
                            </div>
                            <div class="form-group">
                                <label for="subtituloSite">Nome do Vereador</label>
                                <input type="text" id="subtituloSite" placeholder="Emicleiton Rubem da Conceição" maxlength="80">
                            </div>
                            <div class="form-group">
                                <label for="cidadeSite">Cidade</label>
                                <input type="text" id="cidadeSite" placeholder="Monte Santo - BA" maxlength="50">
                            </div>
                        </div>
                    </div>

                    <!-- Hero Section -->
                    <div class="editor-card">
                        <div class="card-header">
                            <h3><i class="fas fa-star"></i> Seção Principal (Hero)</h3>
                        </div>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="sloganPrincipal">Slogan Principal</label>
                                <textarea id="sloganPrincipal" placeholder="Trabalhando com transparência e dedicação pelo futuro da nossa cidade" maxlength="200"></textarea>
                            </div>
                            <div class="form-group">
                                <label for="whatsappNumero">Número WhatsApp</label>
                                <input type="tel" id="whatsappNumero" placeholder="75999999999" maxlength="15">
                            </div>
                        </div>
                    </div>

                    <!-- Informações do Vereador -->
                    <div class="editor-card">
                        <div class="card-header">
                            <h3><i class="fas fa-user-tie"></i> Informações do Vereador</h3>
                        </div>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="nomeCompletoVereador">Nome Completo</label>
                                <input type="text" id="nomeCompletoVereador" placeholder="Emicleiton Rubem da Conceição" maxlength="80">
                            </div>
                            <div class="form-group">
                                <label for="cargoVereador">Cargo</label>
                                <input type="text" id="cargoVereador" placeholder="Vereador de Monte Santo - BA" maxlength="60">
                            </div>
                        </div>
                        
                        <!-- Upload da Imagem do Vereador -->
                        <div class="form-group">
                            <label for="imagemVereador">Foto do Vereador</label>
                            <div class="image-upload-container">
                                <input type="file" id="imagemVereador" accept="image/*" style="display: none;">
                                <div class="image-preview" id="imagePreview">
                                    <img id="previewImg" src="vereador.png" alt="Foto atual" style="max-width: 150px; border-radius: 10px;">
                                </div>
                                <div class="upload-buttons">
                                    <button type="button" onclick="document.getElementById('imagemVereador').click()" class="btn-upload">
                                        <i class="fas fa-camera"></i> Escolher Nova Foto
                                    </button>
                                    <button type="button" onclick="removerImagemVereador()" class="btn-remove">
                                        <i class="fas fa-trash"></i> Remover
                                    </button>
                                </div>
                                <small class="upload-info">Formatos aceitos: JPG, PNG. Tamanho máximo: 2MB</small>
                            </div>
                        </div>
                    </div>

                    <!-- Card Mandato Atual -->
                    <div class="editor-card">
                        <div class="card-header">
                            <h3><i class="fas fa-landmark"></i> Mandato Atual</h3>
                        </div>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="periodoMandato">Período do Mandato</label>
                                <input type="text" id="periodoMandato" placeholder="2021 - 2024" maxlength="20">
                            </div>
                            <div class="form-group">
                                <label for="statusMandato">Status do Mandato</label>
                                <select id="statusMandato">
                                    <option value="Em Exercício">Em Exercício</option>
                                    <option value="Licenciado">Licenciado</option>
                                    <option value="Afastado">Afastado</option>
                                    <option value="Suplente">Suplente</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Estatísticas do Mandato -->
                    <div class="editor-card">
                        <div class="card-header">
                            <h3><i class="fas fa-chart-line"></i> Estatísticas do Mandato</h3>
                        </div>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="anosExercicio">Anos de Exercício</label>
                                <input type="text" id="anosExercicio" placeholder="3" maxlength="10">
                            </div>
                            <div class="form-group">
                                <label for="projetosAprovados">Projetos Ativos</label>
                                <input type="text" id="projetosAprovados" placeholder="42" maxlength="10">
                            </div>
                            <div class="form-group">
                                <label for="cidadaosAtendidos">Cidadãos Atendidos</label>
                                <input type="text" id="cidadaosAtendidos" placeholder="1,247" maxlength="15">
                            </div>
                            <div class="form-group">
                                <label for="nivelSatisfacao">Taxa de Satisfação</label>
                                <input type="text" id="nivelSatisfacao" placeholder="95%" maxlength="10">
                            </div>
                        </div>
                    </div>

                    <!-- Cards Informativos -->
                    <div class="editor-card">
                        <div class="card-header">
                            <h3><i class="fas fa-info-circle"></i> Cards Informativos do Painel</h3>
                        </div>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="totalEleitoresCadastrados">Eleitores Cadastrados</label>
                                <input type="text" id="totalEleitoresCadastrados" placeholder="1,247" maxlength="15">
                            </div>
                            <div class="form-group">
                                <label for="projetosEmAndamento">Projetos em Andamento</label>
                                <input type="text" id="projetosEmAndamento" placeholder="42" maxlength="10">
                            </div>
                            <div class="form-group">
                                <label for="eventosPrevistos">Eventos Previstos</label>
                                <input type="text" id="eventosPrevistos" placeholder="8" maxlength="10">
                            </div>
                            <div class="form-group">
                                <label for="totalMensagens">Mensagens Recebidas</label>
                                <input type="text" id="totalMensagens" placeholder="89" maxlength="10">
                            </div>
                        </div>
                    </div>

                    <!-- Botões de Ação do Site -->
                    <div class="editor-card">
                        <div class="card-header">
                            <h3><i class="fas fa-mouse-pointer"></i> Botões de Ação (Amarelos)</h3>
                        </div>
                        <div id="botoesContainer">
                            <!-- Botões serão carregados dinamicamente -->
                        </div>
                        <div class="form-actions" style="margin-top: 1rem;">
                            <button type="button" class="btn-acao primary" onclick="adicionarBotao()">
                                <i class="fas fa-plus"></i> Adicionar Novo Botão
                            </button>
                        </div>
                    </div>

                    <!-- Cards do Mandato -->
                    <div class="editor-card">
                        <div class="card-header">
                            <h3><i class="fas fa-clipboard-list"></i> Cards de Mandato/Projetos</h3>
                        </div>
                        <div id="cardsMandatoContainer">
                            <div class="card-container">
                              <div class="card">
                                <div class="card-icon"><i class="fas fa-clinic-medical"></i></div>
                                <h3>Nova UBS São José</h3>
                                <p>Aprovação unânime do projeto para construção de nova Unidade Básica de Saúde, beneficiando mais de 3.000 famílias</p>
                                <span class="badge aprovado">APROVADO</span>
                              </div>
                              <div class="card">
                                <div class="card-icon"><i class="fas fa-basketball-ball"></i></div>
                                <h3>Quadras Poliesportivas</h3>
                                <p>Construção de 3 quadras poliesportivas em bairros periféricos, promovendo o esporte e a inclusão social</p>
                                <span class="badge concluido">CONCLUÍDO</span>
                              </div>
                              <div class="card">
                                <div class="card-icon"><i class="fas fa-hand-holding-usd"></i></div>
                                <h3>Programa de Microcrédito</h3>
                                <p>Criação de linha de crédito facilitado para microempreendedores, fortalecendo a economia local</p>
                                <span class="badge andamento">EM ANDAMENTO</span>
                              </div>
                              <div class="card">
                                <div class="card-icon"><i class="fas fa-laptop-code"></i></div>
                                <h3>Programa Futuro Digital</h3>
                                <p>Inclusão digital através de cursos gratuitos de informática para jovens e idosos</p>
                                <span class="badge aprovado">APROVADO</span>
                              </div>
                            </div>
                        </div>
                        <div class="form-actions" style="margin-top: 1rem;">
                            <button type="button" class="btn-acao primary" onclick="adicionarCardMandato()">
                                <i class="fas fa-plus"></i> Adicionar Novo Card
                            </button>
                        </div>
                    </div>

                    <!-- Cards de Estatísticas Azuis -->
                    <div class="editor-card">
                        <div class="card-header">
                            <h3><i class="fas fa-chart-bar"></i> Cards de Estatísticas (Azuis)</h3>
                        </div>
                        <div id="cardsEstatisticasContainer">
                            <!-- Cards de estatísticas serão carregados dinamicamente -->
                        </div>
                        <div class="form-actions" style="margin-top: 1rem;">
                            <button type="button" class="btn-acao primary" onclick="adicionarCardEstatistica()">
                                <i class="fas fa-plus"></i> Adicionar Nova Estatística
                            </button>
                        </div>
                    </div>

                    <!-- Rodapé -->
                    <div class="editor-card">
                        <div class="card-header">
                            <h3><i class="fas fa-anchor"></i> Rodapé do Site</h3>
                        </div>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="textoInstitucional">Texto Institucional</label>
                                <textarea id="textoInstitucional" placeholder="Gabinete comprometido com a transparência..." maxlength="300"></textarea>
                            </div>
                            <div class="form-group">
                                <label for="telefoneContato">Telefone de Contato</label>
                                <input type="tel" id="telefoneContato" placeholder="(75) 3276-2234" maxlength="20">
                            </div>
                            <div class="form-group">
                                <label for="emailContato">E-mail de Contato</label>
                                <input type="email" id="emailContato" placeholder="contato@gabinete.com" maxlength="50">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="form-actions">
                    <button type="button" class="btn-acao primary" onclick="salvarEAplicarConfiguracoes()">
                        <i class="fas fa-rocket"></i> Salvar e Aplicar ao Site
                    </button>
                    <button type="button" class="btn-acao secondary" onclick="carregarConfiguracaoCompleta()">
                        <i class="fas fa-refresh"></i> Recarregar Configurações
                    </button>
                    <button type="button" class="btn-acao danger" onclick="resetarTodasConfiguracoes()">
                        <i class="fas fa-undo"></i> Restaurar Padrão
                    </button>
                </div>
                
                <div class="config-info" style="margin-top: 1rem; padding: 1rem; background: #eff6ff; border-radius: 8px; border-left: 4px solid #3b82f6;">
                    <h4 style="margin: 0 0 0.5rem 0; color: #1e40af;"><i class="fas fa-info-circle"></i> Informações Importantes</h4>
                    <ul style="margin: 0; color: #1e40af;">
                        <li>Todas as alterações são salvas automaticamente no painel administrativo</li>
                        <li>Para aplicar as mudanças no site público, clique em "Salvar e Aplicar ao Site"</li>
                        <li>O upload de imagens é validado (máximo 2MB, formatos JPG/PNG)</li>
                        <li>Você pode adicionar, remover e reordenar todos os elementos do site</li>
                    </ul>
                </div>
            </section>

            <!-- Nova Seção: Gerenciar Projetos -->
            <section class="panel-section" id="projetos-admin">
                <div class="section-header">
                    <h2 class="section-title">💡 Gerenciar Projetos</h2>
                    <p class="section-subtitle">Adicione, edite e organize os projetos de lei e iniciativas</p>
                </div>

                <!-- Formulário de Projeto -->
                <div class="form-container">
                    <div class="form-header">
                        <h3><i class="fas fa-plus"></i> Adicionar Novo Projeto</h3>
                    </div>
                    <form id="formProjeto" onsubmit="adicionarProjeto(event)">
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="projeto_titulo">Título do Projeto</label>
                                <input type="text" id="projeto_titulo" required maxlength="100" placeholder="Ex: Lei da Transparência Municipal">
                            </div>
                            <div class="form-group">
                                <label for="projeto_categoria">Categoria</label>
                                <select id="projeto_categoria" required>
                                    <option value="">Selecione a categoria</option>
                                    <option value="saude">Saúde</option>
                                    <option value="educacao">Educação</option>
                                    <option value="infraestrutura">Infraestrutura</option>
                                    <option value="social">Social</option>
                                    <option value="geral">Geral</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="projeto_descricao">Descrição do Projeto</label>
                            <textarea id="projeto_descricao" required placeholder="Descreva os objetivos e benefícios do projeto..." maxlength="500"></textarea>
                            <div class="char-counter">0/500 caracteres</div>
                        </div>
                        <div class="form-actions">
                            <button type="button" class="btn-acao primary" id="btnAdicionarProjeto">
                                <i class="fas fa-plus"></i> Adicionar Projeto
                            </button>
                            <button type="button" class="btn-acao secondary" onclick="limparFormularioProjeto()">
                                <i class="fas fa-eraser"></i> Limpar
                            </button>
                        </div>
                    </form>
                </div>

                <!-- Lista de Projetos -->
                <div class="lista-container">
                    <div class="lista-header">
                        <h3>Projetos Cadastrados</h3>
                        <div class="lista-filtros">
                            <select id="filtroStatusProjetos" onchange="filtrarProjetos()">
                                <option value="">Todos os status</option>
                                <option value="aprovado">Aprovados</option>
                                <option value="andamento">Em Andamento</option>
                                <option value="rejeitado">Rejeitados</option>
                                <option value="estudo">Em Estudo</option>
                            </select>
                        </div>
                    </div>
                    <div id="listaProjetos"></div>
                </div>
            </section>

            <!-- Nova Seção: Gerenciar Notícias -->
            <section class="panel-section" id="noticias-admin">
                <div class="section-header">
                    <h2 class="section-title">📰 Gerenciar Notícias</h2>
                    <p class="section-subtitle">Publique e gerencie as notícias do gabinete</p>
                </div>

                <!-- Formulário de Notícia -->
                <div class="form-container">
                    <div class="form-header">
                        <h3><i class="fas fa-newspaper"></i> Publicar Nova Notícia</h3>
                    </div>
                    <form id="formNoticiaAdmin" onsubmit="publicarNoticiaAdmin(event)">
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="tituloNoticiaAdmin">Título da Notícia</label>
                                <input type="text" id="tituloNoticiaAdmin" required maxlength="120">
                            </div>
                            <div class="form-group">
                                <label for="categoriaNoticiaAdmin">Categoria</label>
                                <select id="categoriaNoticiaAdmin" required>
                                    <option value="">Selecione a categoria</option>
                                    <option value="politica">Política</option>
                                    <option value="saude">Saúde</option>
                                    <option value="educacao">Educação</option>
                                    <option value="infraestrutura">Infraestrutura</option>
                                    <option value="social">Social</option>
                                    <option value="eventos">Eventos</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="conteudoNoticiaAdmin">Conteúdo da Notícia</label>
                            <textarea id="conteudoNoticiaAdmin" required placeholder="Conteúdo completo da notícia..." maxlength="2000"></textarea>
                            <div class="char-counter">0/2000 caracteres</div>
                        </div>
                        <div class="form-actions">
                            <button type="submit" class="btn-acao primary">
                                <i class="fas fa-paper-plane"></i> Publicar Notícia
                            </button>
                            <button type="button" class="btn-acao secondary" onclick="limparFormularioNoticiaAdmin()">
                                <i class="fas fa-eraser"></i> Limpar
                            </button>
                        </div>
                    </form>
                </div>

                <!-- Lista de Notícias -->
                <div class="lista-container">
                    <div class="lista-header">
                        <h3>Notícias Publicadas</h3>
                    </div>
                    <div id="listaNoticiasAdmin"></div>
                </div>
            </section>

            <!-- Nova Seção: Gerenciar Galeria -->
            <section class="panel-section" id="galeria-admin">
                <div class="section-header">
                    <h2 class="section-title">🖼️ Gerenciar Galeria</h2>
                    <p class="section-subtitle">Organize fotos e vídeos da galeria do site</p>
                </div>

                <!-- Upload de Mídia -->
                <div class="form-container">
                    <div class="form-header">
                        <h3><i class="fas fa-upload"></i> Adicionar Nova Mídia</h3>
                    </div>
                    <form id="formMidia" onsubmit="adicionarMidia(event)">
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="tipoMidia">Tipo de Mídia</label>
                                <select id="tipoMidia" required onchange="alterarTipoMidia()">
                                    <option value="">Selecione o tipo</option>
                                    <option value="foto">Foto</option>
                                    <option value="video">Vídeo</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="tituloMidia">Título/Descrição</label>
                                <input type="text" id="tituloMidia" required maxlength="100">
                            </div>
                        </div>
                        
                        <!-- Upload de Foto -->
                        <div id="uploadFoto" class="upload-section" style="display: none;">
                            <div class="form-group">
                                <label for="urlFoto">URL da Foto</label>
                                <input type="url" id="urlFoto" placeholder="https://exemplo.com/foto.jpg">
                                <small>Cole o link direto da imagem</small>
                            </div>
                        </div>

                        <!-- Upload de Vídeo -->
                        <div id="uploadVideo" class="upload-section" style="display: none;">
                            <div class="form-group">
                                <label for="urlVideo">URL do Vídeo YouTube</label>
                                <input type="url" id="urlVideo" placeholder="https://www.youtube.com/watch?v=...">
                                <small>Cole o link do YouTube</small>
                            </div>
                        </div>

                        <div class="form-actions">
                            <button type="submit" class="btn-acao primary">
                                <i class="fas fa-plus"></i> Adicionar à Galeria
                            </button>
                            <button type="button" class="btn-acao secondary" onclick="limparFormularioMidia()">
                                <i class="fas fa-eraser"></i> Limpar
                            </button>
                        </div>
                    </form>
                </div>

                <!-- Galeria de Mídias -->
                <div class="lista-container">
                    <div class="lista-header">
                        <h3>Galeria Atual</h3>
                        <div class="lista-filtros">
                            <select id="filtroTipoMidia" onchange="filtrarGaleria()">
                                <option value="">Todos os tipos</option>
                                <option value="foto">Fotos</option>
                                <option value="video">Vídeos</option>
                            </select>
                        </div>
                    </div>
                    <div id="listaGaleria" class="galeria-grid"></div>
                </div>
            </section>

            <!-- 🔵 SEÇÃO: EDITAR CABEÇALHO -->
            <section class="panel-section" id="editar-cabecalho">
                <div class="content-editor">
                    <div class="content-editor-header">
                        <i class="fas fa-header" style="font-size: 1.5rem;"></i>
                        <h2>🔵 Cabeçalho do Site</h2>
                    </div>
                    <div class="content-editor-body">
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="titulo">Título Principal do Site</label>
                                <input type="text" id="titulo" placeholder="Liberdade & Desenvolvimento" maxlength="50">
                            </div>
                            <div class="form-group">
                                <label for="subtitulo">Nome Completo do Vereador</label>
                                <input type="text" id="subtitulo" placeholder="Emicleiton Rubem da Conceição" maxlength="80">
                            </div>
                            <div class="form-group">
                                <label for="cidade">Cidade e Estado</label>
                                <input type="text" id="cidade" placeholder="Monte Santo - BA" maxlength="50">
                            </div>
                            <div class="form-group">
                                <label for="slogan">Slogan Principal</label>
                                <textarea id="slogan" placeholder="Trabalhando com transparência e dedicação pelo futuro da nossa cidade" maxlength="200"></textarea>
                            </div>
                            <div class="form-group">
                                <label for="whatsapp">Número do WhatsApp</label>
                                <input type="tel" id="whatsapp" placeholder="75999999999" maxlength="15">
                            </div>
                        </div>
                        
                        <!-- Upload da Foto do Vereador -->
                        <div class="form-group">
                            <label>Foto do Vereador (Circular no Topo)</label>
                            <div class="image-upload-zone" onclick="document.getElementById('fotoCabecalho').click()">
                                <input type="file" id="fotoCabecalho" accept="image/*" style="display: none;">
                                <div class="upload-icon">
                                    <i class="fas fa-camera"></i>
                                </div>
                                <div class="upload-text">Clique para enviar nova foto</div>
                                <div class="upload-hint">JPG, PNG até 2MB • Será exibida em formato circular</div>
                            </div>
                            <div id="previewFotoCabecalho" class="preview-container" style="display: none;">
                                <img class="preview-image" style="border-radius: 50%; max-width: 150px;">
                            </div>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="btn-acao primary" id="btnSalvarCabecalho">
                                <i class="fas fa-save"></i> Salvar Cabeçalho
                            </button>
                            <button type="button" class="btn-acao secondary" onclick="carregarCabecalho()">
                                <i class="fas fa-refresh"></i> Recarregar
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 🟡 SEÇÃO: EDITAR BOTÕES DE AÇÃO -->
            <section class="panel-section" id="editar-botoes">
                <div class="content-editor">
                    <div class="content-editor-header">
                        <i class="fas fa-mouse-pointer" style="font-size: 1.5rem;"></i>
                        <h2>🟡 Botões de Ação</h2>
                    </div>
                    <div class="content-editor-body">
                        <p class="section-intro">Configure os botões amarelos que aparecem no topo do site. Adicione, edite ou remova conforme necessário.</p>
                        
                        <div id="botoesEditorContainer">
                            <!-- Botões serão carregados dinamicamente -->
                        </div>
                        
                        <div class="form-actions">
                            <button type="button" class="btn-acao primary" onclick="adicionarNovoBotao()">
                                <i class="fas fa-plus"></i> Adicionar Novo Botão
                            </button>
                            <button type="button" class="btn-acao secondary" onclick="salvarBotoes()">
                                <i class="fas fa-save"></i> Salvar Todos os Botões
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 🟢 SEÇÃO: EDITAR MANDATO ATUAL -->
            <section class="panel-section" id="editar-mandato">
                <div class="content-editor">
                    <div class="content-editor-header">
                        <i class="fas fa-landmark" style="font-size: 1.5rem;"></i>
                        <h2>🟢 Mandato Atual</h2>
                    </div>
                    <div class="content-editor-body">
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="mandato_periodo">Período do Mandato</label>
                                <input type="text" id="mandato_periodo" placeholder="2021 - 2024" maxlength="20">
                            </div>
                            <div class="form-group">
                                <label for="mandato_cargo">Cargo</label>
                                <input type="text" id="mandato_cargo" placeholder="Vereador" maxlength="50">
                            </div>
                            <div class="form-group">
                                <label for="mandato_resumo">Resumo do Mandato</label>
                                <textarea id="mandato_resumo" placeholder="Resumo das ações e conquistas do mandato atual" maxlength="500"></textarea>
                            </div>
                            <div class="form-group">
                                <label for="mandato_status">Status do Mandato</label>
                                <select id="mandato_status">
                                    <option value="ativo">Em Exercício</option>
                                    <option value="licenciado">Licenciado</option>
                                    <option value="afastado">Afastado</option>
                                    <option value="suplente">Suplente</option>
                                </select>
                            </div>
                        </div>

                        <!-- Cards de Estatísticas -->
                        <h3 style="margin-top: 2rem; margin-bottom: 1rem; color: var(--primary-blue);">
                            <i class="fas fa-chart-line"></i> Cards de Estatísticas
                        </h3>
                        <div class="form-grid" style="grid-template-columns: 1fr 1fr;">
                            <div class="form-group">
                                <label for="cardAnosMandato">Anos de Exercício</label>
                                <input type="text" id="cardAnosMandato" placeholder="3" maxlength="10">
                            </div>
                            <div class="form-group">
                                <label for="cardProjetosAtivos">Projetos Ativos</label>
                                <input type="text" id="cardProjetosAtivos" placeholder="42" maxlength="10">
                            </div>
                            <div class="form-group">
                                <label for="cardCidadaosAtendidos">Cidadãos Atendidos</label>
                                <input type="text" id="cardCidadaosAtendidos" placeholder="1,247" maxlength="15">
                            </div>
                            <div class="form-group">
                                <label for="cardSatisfacao">Taxa de Satisfação</label>
                                <input type="text" id="cardSatisfacao" placeholder="95%" maxlength="10">
                            </div>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="btn-acao primary" id="btnSalvarMandato">
                                <i class="fas fa-save"></i> Salvar Mandato
                            </button>
                            <button type="button" class="btn-acao secondary" onclick="carregarMandato()">
                                <i class="fas fa-refresh"></i> Recarregar
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 🟣 SEÇÃO: EDITAR BIOGRAFIA -->
            <section class="panel-section" id="editar-biografia">
                <div class="content-editor">
                    <div class="content-editor-header">
                        <i class="fas fa-user-circle" style="font-size: 1.5rem;"></i>
                        <h2>🟣 Biografia do Vereador</h2>
                    </div>
                    <div class="content-editor-body">
                        <div class="form-group">
                            <label for="bio_titulo">Título da Biografia</label>
                            <input type="text" id="bio_titulo" placeholder="Sobre o Vereador" maxlength="50">
                        </div>
                        <div class="form-group">
                            <label for="bio_conteudo">Texto da Biografia</label>
                            <div class="editor-toolbar">
                                <button type="button" class="toolbar-btn" onclick="formatarTexto('bold')">
                                    <i class="fas fa-bold"></i> Negrito
                                </button>
                                <button type="button" class="toolbar-btn" onclick="formatarTexto('italic')">
                                    <i class="fas fa-italic"></i> Itálico
                                </button>
                                <button type="button" class="toolbar-btn" onclick="formatarTexto('underline')">
                                    <i class="fas fa-underline"></i> Sublinhado
                                </button>
                                <button type="button" class="toolbar-btn" onclick="formatarTexto('insertUnorderedList')">
                                    <i class="fas fa-list-ul"></i> Lista
                                </button>
                                <button type="button" class="toolbar-btn" onclick="formatarTexto('justifyLeft')">
                                    <i class="fas fa-align-left"></i> Esquerda
                                </button>
                                <button type="button" class="toolbar-btn" onclick="formatarTexto('justifyCenter')">
                                    <i class="fas fa-align-center"></i> Centro
                                </button>
                            </div>
                            <textarea id="bio_conteudo" class="rich-text-editor" rows="8"
                                 placeholder="Escreva aqui a biografia completa do vereador. Use a barra de ferramentas acima para formatação.">
                            </textarea>
                        </div>

                        <!-- Upload de Imagem de Apoio -->
                        <div class="form-group">
                            <label for="bio_foto">URL da Foto (Opcional)</label>
                            <input type="url" id="bio_foto" placeholder="https://exemplo.com/foto.jpg" maxlength="200">
                        </div>

                        <div class="form-actions">
                            <button type="button" class="btn-acao primary" id="btnSalvarBiografia">
                                <i class="fas fa-save"></i> Salvar Biografia
                            </button>
                            <button type="button" class="btn-acao secondary" onclick="carregarBiografia()">
                                <i class="fas fa-refresh"></i> Recarregar
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Nova Seção: Agenda Pública -->
            <section class="panel-section" id="agenda-admin">
                <div class="content-editor">
                    <div class="content-editor-header">
                        <i class="fas fa-calendar" style="font-size: 1.5rem;"></i>
                        <h2>🔵 Agenda Pública</h2>
                    </div>
                    <div class="content-editor-body">
                        <p class="section-intro">Gerencie os eventos da agenda pública do vereador.</p>
                        
                        <!-- Formulário para Novo Evento -->
                        <div class="editor-card">
                            <div class="card-header">
                                <h3><i class="fas fa-plus"></i> Adicionar Novo Evento</h3>
                            </div>
                            <div class="form-grid">
                                <div class="form-group">
                                    <label for="eventoTitulo">Título do Evento</label>
                                    <input type="text" id="eventoTitulo" placeholder="Ex: Audiência Pública" maxlength="80">
                                </div>
                                <div class="form-group">
                                    <label for="eventoData">Data</label>
                                    <input type="date" id="eventoData">
                                </div>
                                <div class="form-group">
                                    <label for="eventoHorario">Horário</label>
                                    <input type="time" id="eventoHorario">
                                </div>
                                <div class="form-group">
                                    <label for="eventoLocal">Local</label>
                                    <input type="text" id="eventoLocal" placeholder="Ex: Câmara Municipal" maxlength="100">
                                </div>
                                <div class="form-group" style="grid-column: 1 / -1;">
                                    <label for="eventoDescricao">Descrição</label>
                                    <textarea id="eventoDescricao" placeholder="Descrição detalhada do evento" maxlength="500"></textarea>
                                </div>
                            </div>
                            <div class="form-actions">
                                <button type="button" class="btn-acao primary" onclick="adicionarEvento()">
                                    <i class="fas fa-plus"></i> Adicionar Evento
                                </button>
                                <button type="button" class="btn-acao secondary" onclick="limparFormularioEvento()">
                                    <i class="fas fa-eraser"></i> Limpar
                                </button>
                            </div>
                        </div>

                        <!-- Lista de Eventos -->
                        <div class="lista-container">
                            <div class="lista-header">
                                <h3>Eventos da Agenda</h3>
                                <div class="lista-filtros">
                                    <select id="filtroMesEvento" onchange="filtrarEventos()">
                                        <option value="">Todos os meses</option>
                                        <option value="01">Janeiro</option>
                                        <option value="02">Fevereiro</option>
                                        <option value="03">Março</option>
                                        <option value="04">Abril</option>
                                        <option value="05">Maio</option>
                                        <option value="06">Junho</option>
                                        <option value="07">Julho</option>
                                        <option value="08">Agosto</option>
                                        <option value="09">Setembro</option>
                                        <option value="10">Outubro</option>
                                        <option value="11">Novembro</option>
                                        <option value="12">Dezembro</option>
                                    </select>
                                </div>
                            </div>
                            <div id="listaEventos" class="agenda-lista"></div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Seções já existentes: Contato e Rodapé -->
            <section class="panel-section" id="editar-contato">
                <div class="content-editor">
                    <div class="content-editor-header">
                        <i class="fas fa-address-book" style="font-size: 1.5rem;"></i>
                        <h2>🟡 Contato e Localização</h2>
                    </div>
                    <div class="content-editor-body">
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="contatoEmail">E-mail de Contato</label>
                                <input type="email" id="contatoEmail" placeholder="contato@gabinete.com" maxlength="80">
                            </div>
                            <div class="form-group">
                                <label for="contatoTelefone">Telefone Principal</label>
                                <input type="tel" id="contatoTelefone" placeholder="(75) 99999-9999" maxlength="20">
                            </div>
                            <div class="form-group">
                                <label for="contatoWhatsapp">WhatsApp</label>
                                <input type="tel" id="contatoWhatsapp" placeholder="75999999999" maxlength="15">
                            </div>
                            <div class="form-group">
                                <label for="contatoFacebook">Facebook</label>
                                <input type="url" id="contatoFacebook" placeholder="https://facebook.com/perfil" maxlength="200">
                            </div>
                            <div class="form-group">
                                <label for="contatoInstagram">Instagram</label>
                                <input type="url" id="contatoInstagram" placeholder="https://instagram.com/perfil" maxlength="200">
                            </div>
                            <div class="form-group">
                                <label for="contatoEndereco">Endereço/Localização</label>
                                <textarea id="contatoEndereco" placeholder="Rua Principal, 123 - Centro - Monte Santo - BA" maxlength="200"></textarea>
                            </div>
                            <div class="form-group" style="grid-column: 1 / -1;">
                                <label for="textoInstitucionalContato">Texto Institucional de Contato</label>
                                <textarea id="textoInstitucionalContato" placeholder="Estamos sempre disponíveis para ouvir você..." maxlength="500"></textarea>
                            </div>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="btn-acao primary" onclick="salvarContato()">
                                <i class="fas fa-save"></i> Salvar Contato
                            </button>
                            <button type="button" class="btn-acao secondary" onclick="carregarContato()">
                                <i class="fas fa-refresh"></i> Recarregar
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <section class="panel-section" id="editar-rodape">
                <div class="content-editor">
                    <div class="content-editor-header">
                        <i class="fas fa-anchor" style="font-size: 1.5rem;"></i>
                        <h2>🟠 Rodapé do Site</h2>
                    </div>
                    <div class="content-editor-body">
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="rodapeTextoInstitucional">Texto Institucional</label>
                                <textarea id="rodapeTextoInstitucional" placeholder="Gabinete comprometido com a transparência e desenvolvimento..." maxlength="300"></textarea>
                            </div>
                            <div class="form-group">
                                <label for="rodapeTelefone">Telefone no Rodapé</label>
                                <input type="tel" id="rodapeTelefone" placeholder="(75) 99999-9999" maxlength="20">
                            </div>
                            <div class="form-group">
                                <label for="rodapeWhatsapp">WhatsApp no Rodapé</label>
                                <input type="tel" id="rodapeWhatsapp" placeholder="75999999999" maxlength="15">
                            </div>
                            <div class="form-group">
                                <label for="rodapeCopyright">Copyright</label>
                                <input type="text" id="rodapeCopyright" placeholder="© 2025 Gabinete Digital - Todos os direitos reservados" maxlength="100">
                            </div>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="btn-acao primary" onclick="salvarRodape()">
                                <i class="fas fa-save"></i> Salvar Rodapé
                            </button>
                            <button type="button" class="btn-acao secondary" onclick="carregarRodape()">
                                <i class="fas fa-refresh"></i> Recarregar
                            </button>
                        </div>
                    </div>
                </div>
            </section>



            <!-- 📊 SEÇÃO: RAIO-X VOTOS -->
            <section class="panel-section" id="raio-x-votos">
                <div class="content-editor">
                    <div class="content-editor-header">
                        <i class="fas fa-chart-line" style="font-size: 1.5rem;"></i>
                        <h2>📊 Raio-X Votos</h2>
                    </div>
                    <div class="content-editor-body">
                        
                        <!-- Dashboard de Estatísticas -->
                        <div class="raio-x-stats-grid">
                            <div class="stat-card blue">
                                <div class="stat-icon">
                                    <i class="fas fa-vote-yea"></i>
                                </div>
                                <div class="stat-content">
                                    <div class="stat-number" id="totalVotosRaioX">0</div>
                                    <div class="stat-label">Total de Votos</div>
                                </div>
                            </div>
                            <div class="stat-card yellow">
                                <div class="stat-icon">
                                    <i class="fas fa-map-pin"></i>
                                </div>
                                <div class="stat-content">
                                    <div class="stat-number" id="totalLocaisRaioX">0</div>
                                    <div class="stat-label">Locais de Votação</div>
                                </div>
                            </div>
                            <div class="stat-card green">
                                <div class="stat-icon">
                                    <i class="fas fa-users"></i>
                                </div>
                                <div class="stat-content">
                                    <div class="stat-number" id="totalCandidatosRaioX">0</div>
                                    <div class="stat-label">Candidatos</div>
                                </div>
                            </div>
                            <div class="stat-card purple">
                                <div class="stat-icon">
                                    <i class="fas fa-building"></i>
                                </div>
                                <div class="stat-content">
                                    <div class="stat-number" id="totalMunicipiosRaioX">0</div>
                                    <div class="stat-label">Municípios</div>
                                </div>
                            </div>
                        </div>

                        <!-- Formulário de Cadastro -->
                        <div class="editor-card">
                            <div class="card-header">
                                <h3><i class="fas fa-plus-circle"></i> Cadastrar Dados de Votação</h3>
                            </div>
                            <div class="form-grid raio-x-form-grid">
                                <div class="form-group">
                                    <label for="municipioRaioX">Município</label>
                                    <input type="text" id="municipioRaioX" placeholder="Ex: Monte Santo" maxlength="100" required>
                                </div>
                                <div class="form-group">
                                    <label for="zonaEleitoralRaioX">Zona Eleitoral</label>
                                    <input type="text" id="zonaEleitoralRaioX" placeholder="Ex: 042ª Zona" maxlength="50" required>
                                </div>
                                <div class="form-group">
                                    <label for="bairroRaioX">Bairro</label>
                                    <input type="text" id="bairroRaioX" placeholder="Ex: Centro" maxlength="100" required>
                                </div>
                                <div class="form-group">
                                    <label for="localVotacaoRaioX">Local de Votação</label>
                                    <input type="text" id="localVotacaoRaioX" placeholder="Ex: Escola Municipal" maxlength="150" required>
                                </div>
                                <div class="form-group">
                                    <label for="secaoRaioX">Seção</label>
                                    <input type="text" id="secaoRaioX" placeholder="Ex: 0001" maxlength="10" required>
                                </div>
                                <div class="form-group">
                                    <label for="candidatoRaioX">Nome do Candidato</label>
                                    <input type="text" id="candidatoRaioX" placeholder="Ex: Emicleiton Rubem" maxlength="100" required>
                                </div>
                                <div class="form-group">
                                    <label for="votosRaioX">Número de Votos</label>
                                    <input type="number" id="votosRaioX" placeholder="Ex: 150" min="0" max="99999" required>
                                </div>
                            </div>
                            <div class="form-actions">
                                <button type="button" class="btn-acao primary" onclick="adicionarVotosRaioX()">
                                    <i class="fas fa-plus"></i> Adicionar Votos
                                </button>
                                <button type="button" class="btn-acao secondary" onclick="limparFormularioRaioX()">
                                    <i class="fas fa-eraser"></i> Limpar
                                </button>
                            </div>
                        </div>

                        <!-- Filtros -->
                        <div class="filtros-container">
                            <h3><i class="fas fa-filter"></i> Filtros de Análise</h3>
                            <div class="filtros-grid">
                                <div class="form-group">
                                    <label for="filtroMunicipioRaioX">Município</label>
                                    <select id="filtroMunicipioRaioX" onchange="aplicarFiltrosRaioX()">
                                        <option value="">Todos</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="filtroZonaRaioX">Zona</label>
                                    <select id="filtroZonaRaioX" onchange="aplicarFiltrosRaioX()">
                                        <option value="">Todas</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="filtroBairroRaioX">Bairro</label>
                                    <select id="filtroBairroRaioX" onchange="aplicarFiltrosRaioX()">
                                        <option value="">Todos</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="filtroLocalRaioX">Local</label>
                                    <select id="filtroLocalRaioX" onchange="aplicarFiltrosRaioX()">
                                        <option value="">Todos</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="filtroCandidatoRaioX">Candidato</label>
                                    <select id="filtroCandidatoRaioX" onchange="aplicarFiltrosRaioX()">
                                        <option value="">Todos</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <button type="button" class="btn-acao secondary" onclick="limparFiltrosRaioX()">
                                        <i class="fas fa-times"></i> Limpar
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Gráficos -->
                        <div class="raio-x-charts">
                            <div class="chart-card">
                                <h3><i class="fas fa-chart-bar"></i> Votos por Local</h3>
                                <canvas id="chartVotosLocais" class="chart-raio-x"></canvas>
                            </div>
                            <div class="chart-card">
                                <h3><i class="fas fa-chart-pie"></i> Votos por Candidato</h3>
                                <canvas id="chartVotosCandidatos" class="chart-raio-x"></canvas>
                            </div>
                        </div>

                        <!-- Tabela de Dados -->
                        <div class="tabela-container">
                            <div class="tabela-header">
                                <h3>Dados de Votação</h3>
                                <div class="tabela-acoes">
                                    <input type="text" id="buscaRaioX" placeholder="Buscar..." onkeyup="buscarRaioX()">
                                    <select id="ordenarRaioX" onchange="ordenarRaioX()">
                                        <option value="votos">Por Votos</option>
                                        <option value="municipio">Por Município</option>
                                        <option value="candidato">Por Candidato</option>
                                    </select>
                                </div>
                            </div>
                            <div class="tabela-wrapper">
                                <table class="raio-x-tabela">
                                    <thead>
                                        <tr>
                                            <th>Município</th>
                                            <th>Zona</th>
                                            <th>Bairro</th>
                                            <th>Local</th>
                                            <th>Seção</th>
                                            <th>Candidato</th>
                                            <th>Votos</th>
                                            <th>Ações</th>
                                        </tr>
                                    </thead>
                                    <tbody id="tabelaRaioXBody">
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Ações -->
                        <div class="raio-x-actions">
                            <button type="button" class="btn-acao primary" onclick="exportarRaioXJSON()">
                                <i class="fas fa-download"></i> Exportar JSON
                            </button>
                            <button type="button" class="btn-acao primary" onclick="exportarRaioXCSV()">
                                <i class="fas fa-file-csv"></i> Exportar CSV
                            </button>
                            <label for="importarRaioXJSON" class="btn-acao secondary">
                                <i class="fas fa-upload"></i> Importar JSON
                                <input type="file" id="importarRaioXJSON" accept=".json" style="display: none;" onchange="importarRaioXJSON(event)">
                            </label>
                            <label for="importarRaioXCSV" class="btn-acao secondary">
                                <i class="fas fa-file-upload"></i> Importar CSV
                                <input type="file" id="importarRaioXCSV" accept=".csv" style="display: none;" onchange="importarRaioXCSV(event)">
                            </label>
                            <button type="button" class="btn-acao warning" onclick="resetarRaioX()">
                                <i class="fas fa-trash-restore"></i> Limpar Dados
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 🗺️ SEÇÃO: MAPA ELEITORAL -->
            <section class="panel-section" id="mapa-eleitoral">
                <div class="content-editor">
                    <div class="content-editor-header">
                        <i class="fas fa-map-marked-alt" style="font-size: 1.5rem;"></i>
                        <h2>🗺️ Mapa Eleitoral</h2>
                        <p class="section-description">Sistema interativo de georreferenciamento eleitoral com visualização avançada</p>
                    </div>
                    <div class="content-editor-body">
                        
                        <!-- Dashboard de Estatísticas -->
                        <div class="mapa-stats-grid">
                            <div class="stat-card blue">
                                <div class="stat-icon">
                                    <i class="fas fa-users"></i>
                                </div>
                                <div class="stat-content">
                                    <div class="stat-number" id="totalEleitoresMapa">0</div>
                                    <div class="stat-label">Total de Eleitores</div>
                                </div>
                            </div>
                            <div class="stat-card yellow">
                                <div class="stat-icon">
                                    <i class="fas fa-map-marker-alt"></i>
                                </div>
                                <div class="stat-content">
                                    <div class="stat-number" id="totalBairrosMapa">0</div>
                                    <div class="stat-label">Bairros Mapeados</div>
                                </div>
                            </div>
                            <div class="stat-card green">
                                <div class="stat-icon">
                                    <i class="fas fa-trophy"></i>
                                </div>
                                <div class="stat-content">
                                    <div class="stat-number" id="maiorConcentracao">-</div>
                                    <div class="stat-label">Maior Concentração</div>
                                </div>
                            </div>
                            <div class="stat-card purple">
                                <div class="stat-icon">
                                    <i class="fas fa-chart-pie"></i>
                                </div>
                                <div class="stat-content">
                                    <div class="stat-number" id="percentualMapeado">0%</div>
                                    <div class="stat-label">Território Mapeado</div>
                                </div>
                            </div>
                        </div>

                        <!-- Filtros Laterais -->
                        <div class="filtros-mapa-container">
                            <div class="filtros-mapa-header">
                                <h3><i class="fas fa-filter"></i> Filtros Avançados</h3>
                                <button type="button" class="btn-acao secondary btn-sm" onclick="limparFiltrosMapa()">
                                    <i class="fas fa-times"></i> Limpar
                                </button>
                            </div>
                            <div class="filtros-mapa-grid">
                                <div class="filtro-grupo">
                                    <label for="filtroBairroMapa">Bairro/Localidade</label>
                                    <select id="filtroBairroMapa" onchange="aplicarFiltrosMapa()">
                                        <option value="">Todos os bairros</option>
                                    </select>
                                </div>
                                <div class="filtro-grupo">
                                    <label for="filtroCandidatoMapa">Candidato</label>
                                    <select id="filtroCandidatoMapa" onchange="aplicarFiltrosMapa()">
                                        <option value="">Todos os candidatos</option>
                                        <option value="emicleiton">Emicleiton Rubem</option>
                                        <option value="outros">Outros candidatos</option>
                                    </select>
                                </div>
                                <div class="filtro-grupo">
                                    <label for="filtroSecaoMapa">Seção Eleitoral</label>
                                    <select id="filtroSecaoMapa" onchange="aplicarFiltrosMapa()">
                                        <option value="">Todas as seções</option>
                                    </select>
                                </div>
                                <div class="filtro-grupo">
                                    <label for="filtroZonaMapa">Zona Eleitoral</label>
                                    <select id="filtroZonaMapa" onchange="aplicarFiltrosMapa()">
                                        <option value="">Todas as zonas</option>
                                        <option value="042">042ª Zona - Monte Santo</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- Container Principal com Mapa e Controles -->
                        <div class="mapa-principal-container">
                            <div class="mapa-controles">
                                <div class="controles-header">
                                    <h3><i class="fas fa-cogs"></i> Controles do Mapa</h3>
                                </div>
                                <div class="controles-grid">
                                    <button type="button" class="btn-controle" onclick="centralizarMapa()">
                                        <i class="fas fa-crosshairs"></i> Centralizar
                                    </button>
                                    <button type="button" class="btn-controle" onclick="aumentarZoom()">
                                        <i class="fas fa-search-plus"></i> Zoom +
                                    </button>
                                    <button type="button" class="btn-controle" onclick="diminuirZoom()">
                                        <i class="fas fa-search-minus"></i> Zoom -
                                    </button>
                                    <button type="button" class="btn-controle" onclick="toggleMarcadores()">
                                        <i class="fas fa-eye"></i> Marcadores
                                    </button>
                                </div>
                            </div>
                            
                            <!-- Mapa Interativo -->
                            <div class="mapa-interativo-container">
                                <div id="mapaEleitoral" class="mapa-eleitoral"></div>
                                <div class="mapa-loading" id="mapaLoading">
                                    <div class="spinner"></div>
                                    <p>Carregando mapa interativo...</p>
                                </div>
                            </div>
                        </div>

                        <!-- Gráfico de Distribuição -->
                        <div class="grafico-distribuicao-container">
                            <div class="grafico-header">
                                <h3><i class="fas fa-chart-pie"></i> Distribuição por Bairro</h3>
                                <div class="grafico-controles">
                                    <select id="tipoGraficoMapa" onchange="alterarTipoGrafico()">
                                        <option value="doughnut">Rosca</option>
                                        <option value="pie">Pizza</option>
                                        <option value="bar">Barras</option>
                                    </select>
                                </div>
                            </div>
                            <div class="grafico-wrapper">
                                <canvas id="chartDistribuicaoMapa" class="chart-mapa"></canvas>
                            </div>
                        </div>

                        <!-- Formulário de Cadastro de Bairro -->
                        <div class="cadastro-bairro-container">
                            <div class="cadastro-header">
                                <h3><i class="fas fa-plus-circle"></i> Cadastrar Novo Bairro</h3>
                            </div>
                            <div class="cadastro-form-grid">
                                <div class="form-grupo">
                                    <label for="nomeBairroMapa">Nome do Bairro/Localidade</label>
                                    <input type="text" id="nomeBairroMapa" placeholder="Ex: Centro, Vila Nova..." maxlength="50" required>
                                </div>
                                <div class="form-grupo">
                                    <label for="eleitoresBairroMapa">Número de Eleitores</label>
                                    <input type="number" id="eleitoresBairroMapa" placeholder="Ex: 150" min="0" max="99999" required>
                                </div>
                                <div class="form-grupo">
                                    <label for="corBairroMapa">Cor de Destaque</label>
                                    <div class="color-picker-container">
                                        <input type="color" id="corBairroMapa" value="#1e40af">
                                        <button type="button" class="btn-auto-color" onclick="gerarCorAutomaticaMapa()">
                                            <i class="fas fa-random"></i> Auto
                                        </button>
                                    </div>
                                </div>
                                <div class="form-grupo">
                                    <label for="coordenadasBairroMapa">Coordenadas (opcional)</label>
                                    <input type="text" id="coordenadasBairroMapa" placeholder="-10.4372, -39.3320" pattern="^-?\d+\.?\d*,-?\d+\.?\d*$">
                                </div>
                                <div class="form-grupo span-2">
                                    <label for="observacoesBairroMapa">Observações</label>
                                    <textarea id="observacoesBairroMapa" placeholder="Informações adicionais sobre o bairro..." rows="2"></textarea>
                                </div>
                            </div>
                            <div class="cadastro-acoes">
                                <button type="button" class="btn-acao primary" onclick="adicionarBairroMapa()">
                                    <i class="fas fa-plus"></i> Adicionar Bairro
                                </button>
                                <button type="button" class="btn-acao secondary" onclick="limparFormularioBairroMapa()">
                                    <i class="fas fa-eraser"></i> Limpar Formulário
                                </button>
                            </div>
                        </div>

                        <!-- Lista de Bairros Cadastrados -->
                        <div class="lista-bairros-container">
                            <div class="lista-bairros-header">
                                <h3><i class="fas fa-list"></i> Bairros Cadastrados</h3>
                                <div class="lista-controles">
                                    <input type="text" id="buscaBairroMapa" placeholder="Buscar bairro..." onkeyup="buscarBairroMapa()">
                                    <select id="ordenarBairrosMapa" onchange="ordenarBairrosMapa()">
                                        <option value="nome">Ordenar por Nome</option>
                                        <option value="eleitores">Ordenar por Eleitores</option>
                                        <option value="data">Ordenar por Data</option>
                                    </select>
                                </div>
                            </div>
                            <div id="listaBairrosMapa" class="lista-bairros-grid"></div>
                        </div>

                        <!-- Ações de Gerenciamento -->
                        <div class="acoes-mapa-container">
                            <button type="button" class="btn-acao primary" onclick="exportarRelatorioMapaPDF()">
                                <i class="fas fa-file-pdf"></i> Exportar Relatório em PDF
                            </button>
                            <button type="button" class="btn-acao secondary" onclick="exportarDadosMapa()">
                                <i class="fas fa-download"></i> Exportar Dados JSON
                            </button>
                            <label for="importarDadosMapa" class="btn-acao secondary">
                                <i class="fas fa-upload"></i> Importar Dados JSON
                                <input type="file" id="importarDadosMapa" accept=".json" style="display: none;" onchange="importarDadosMapa(event)">
                            </label>
                            <button type="button" class="btn-acao warning" onclick="resetarDadosMapa()">
                                <i class="fas fa-trash-restore"></i> Limpar Todos os Dados
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 📊 SEÇÃO: ANÁLISE DE VOTOS -->
            <section class="panel-section" id="analise-votos">
                <div class="content-editor">
                    <div class="content-editor-header">
                        <i class="fas fa-chart-line" style="font-size: 1.5rem;"></i>
                        <h2>📊 Análise de Votos - Raio-X Electoral</h2>
                    </div>
                    <div class="content-editor-body">
                        
                        <!-- Dashboard de Estatísticas -->
                        <div class="votos-stats-grid">
                            <div class="stat-card blue">
                                <div class="stat-icon">
                                    <i class="fas fa-vote-yea"></i>
                                </div>
                                <div class="stat-content">
                                    <div class="stat-number" id="totalVotos">0</div>
                                    <div class="stat-label">Total de Votos</div>
                                </div>
                            </div>
                            <div class="stat-card yellow">
                                <div class="stat-icon">
                                    <i class="fas fa-map-marker-alt"></i>
                                </div>
                                <div class="stat-content">
                                    <div class="stat-number" id="totalLocais">0</div>
                                    <div class="stat-label">Locais de Votação</div>
                                </div>
                            </div>
                            <div class="stat-card green">
                                <div class="stat-icon">
                                    <i class="fas fa-users"></i>
                                </div>
                                <div class="stat-content">
                                    <div class="stat-number" id="totalCandidatos">0</div>
                                    <div class="stat-label">Candidatos</div>
                                </div>
                            </div>
                            <div class="stat-card purple">
                                <div class="stat-icon">
                                    <i class="fas fa-calendar-check"></i>
                                </div>
                                <div class="stat-content">
                                    <div class="stat-number" id="totalEleicoes">0</div>
                                    <div class="stat-label">Eleições</div>
                                </div>
                            </div>
                        </div>

                        <!-- Formulário de Cadastro de Dados Eleitorais -->
                        <div class="editor-card">
                            <div class="card-header">
                                <h3><i class="fas fa-plus-circle"></i> Cadastrar Dados Eleitorais</h3>
                            </div>
                            <div class="form-grid votos-form-grid">
                                <div class="form-group">
                                    <label for="municipio">Município</label>
                                    <input type="text" id="municipio" placeholder="Ex: Monte Santo" maxlength="100" required>
                                </div>
                                <div class="form-group">
                                    <label for="zonaEleitoral">Zona Eleitoral</label>
                                    <input type="text" id="zonaEleitoral" placeholder="Ex: 042ª Zona" maxlength="50" required>
                                </div>
                                <div class="form-group">
                                    <label for="bairroVotacao">Bairro</label>
                                    <input type="text" id="bairroVotacao" placeholder="Ex: Centro" maxlength="100" required>
                                </div>
                                <div class="form-group">
                                    <label for="localVotacao">Local de Votação</label>
                                    <input type="text" id="localVotacao" placeholder="Ex: Escola Municipal" maxlength="150" required>
                                </div>
                                <div class="form-group">
                                    <label for="secaoEleitoral">Seção Eleitoral</label>
                                    <input type="text" id="secaoEleitoral" placeholder="Ex: 0001" maxlength="10" required>
                                </div>
                                <div class="form-group">
                                    <label for="candidatoNome">Candidato (Opcional)</label>
                                    <input type="text" id="candidatoNome" placeholder="Ex: Emicleiton Rubem" maxlength="100">
                                </div>
                                <div class="form-group">
                                    <label for="quantidadeVotos">Quantidade de Votos</label>
                                    <input type="number" id="quantidadeVotos" placeholder="Ex: 150" min="0" max="99999" required>
                                </div>
                                <div class="form-group">
                                    <label for="dataEleicao">Data da Eleição (Opcional)</label>
                                    <input type="date" id="dataEleicao">
                                </div>
                            </div>
                            <div class="form-actions">
                                <button type="button" class="btn-acao primary" onclick="adicionarDadosVotos()">
                                    <i class="fas fa-plus"></i> Adicionar Dados
                                </button>
                                <button type="button" class="btn-acao secondary" onclick="limparFormularioVotos()">
                                    <i class="fas fa-eraser"></i> Limpar
                                </button>
                            </div>
                        </div>

                        <!-- Filtros de Análise -->
                        <div class="filtros-container">
                            <h3><i class="fas fa-filter"></i> Filtros de Análise</h3>
                            <div class="filtros-grid">
                                <div class="form-group">
                                    <label for="filtroMunicipio">Município</label>
                                    <select id="filtroMunicipio" onchange="aplicarFiltros()">
                                        <option value="">Todos os municípios</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="filtroZona">Zona Eleitoral</label>
                                    <select id="filtroZona" onchange="aplicarFiltros()">
                                        <option value="">Todas as zonas</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="filtroBairroVotos">Bairro</label>
                                    <select id="filtroBairroVotos" onchange="aplicarFiltros()">
                                        <option value="">Todos os bairros</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="filtroLocal">Local</label>
                                    <select id="filtroLocal" onchange="aplicarFiltros()">
                                        <option value="">Todos os locais</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="filtroCandidato">Candidato</label>
                                    <select id="filtroCandidato" onchange="aplicarFiltros()">
                                        <option value="">Todos os candidatos</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <button type="button" class="btn-acao secondary" onclick="limparFiltros()">
                                        <i class="fas fa-times"></i> Limpar Filtros
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Visualizações de Dados -->
                        <div class="votos-visualization">
                            <div class="votos-charts-container">
                                <div class="chart-card">
                                    <h3><i class="fas fa-chart-bar"></i> Votos por Local</h3>
                                    <canvas id="chartVotosBarras" class="chart-votos"></canvas>
                                </div>
                                <div class="chart-card">
                                    <h3><i class="fas fa-chart-pie"></i> Distribuição por Candidato</h3>
                                    <canvas id="chartVotosPizza" class="chart-votos"></canvas>
                                </div>
                            </div>
                        </div>

                        <!-- Tabela de Dados -->
                        <div class="tabela-container">
                            <div class="tabela-header">
                                <h3>Dados Eleitorais Cadastrados</h3>
                                <div class="tabela-acoes">
                                    <input type="text" id="buscaVotos" placeholder="Buscar..." onkeyup="buscarVotos()">
                                    <select id="ordenarVotos" onchange="ordenarVotos()">
                                        <option value="votos">Ordenar por Votos</option>
                                        <option value="municipio">Ordenar por Município</option>
                                        <option value="candidato">Ordenar por Candidato</option>
                                        <option value="data">Ordenar por Data</option>
                                    </select>
                                </div>
                            </div>
                            <div class="tabela-wrapper">
                                <table class="votos-tabela">
                                    <thead>
                                        <tr>
                                            <th>Município</th>
                                            <th>Zona</th>
                                            <th>Bairro</th>
                                            <th>Local</th>
                                            <th>Seção</th>
                                            <th>Candidato</th>
                                            <th>Votos</th>
                                            <th>Data</th>
                                            <th>Ações</th>
                                        </tr>
                                    </thead>
                                    <tbody id="tabelaVotosBody">
                                        <!-- Dados serão inseridos aqui via JavaScript -->
                                    </tbody>
                                </table>
                            </div>
                            <div class="tabela-totalizadores">
                                <div class="totalizador">
                                    <span class="totalizador-label">Total Filtrado:</span>
                                    <span class="totalizador-valor" id="totalVotosFiltrados">0</span>
                                </div>
                                <div class="totalizador">
                                    <span class="totalizador-label">Registros:</span>
                                    <span class="totalizador-valor" id="totalRegistrosFiltrados">0</span>
                                </div>
                            </div>
                        </div>

                        <!-- Ações de Importação/Exportação -->
                        <div class="votos-actions">
                            <button type="button" class="btn-acao primary" onclick="exportarVotosJSON()">
                                <i class="fas fa-download"></i> Exportar JSON
                            </button>
                            <button type="button" class="btn-acao primary" onclick="exportarVotosCSV()">
                                <i class="fas fa-file-csv"></i> Exportar CSV
                            </button>
                            <label for="importarVotosJSON" class="btn-acao secondary">
                                <i class="fas fa-upload"></i> Importar JSON
                                <input type="file" id="importarVotosJSON" accept=".json" style="display: none;" onchange="importarVotosJSON(event)">
                            </label>
                            <label for="importarVotosCSV" class="btn-acao secondary">
                                <i class="fas fa-file-upload"></i> Importar CSV
                                <input type="file" id="importarVotosCSV" accept=".csv" style="display: none;" onchange="importarVotosCSV(event)">
                            </label>
                            <button type="button" class="btn-acao warning" onclick="resetarDadosVotos()">
                                <i class="fas fa-trash-restore"></i> Limpar Todos os Dados
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Nova Seção: Configurações -->
            <section class="panel-section" id="configuracoes">
                <div class="section-header">
                    <h2 class="section-title">
                        <i class="fas fa-cog"></i>
                        Configurações do Sistema
                    </h2>
                    <p class="section-subtitle">Edite as informações do painel administrativo</p>
                </div>

                <div class="config-container">
                    <!-- Configurações do Vereador -->
                    <div class="config-card">
                        <h3><i class="fas fa-user"></i> Informações do Vereador</h3>
                        <div class="form-group">
                            <label>Nome Completo:</label>
                            <input type="text" id="vereadorNome" class="form-control">
                        </div>
                        <div class="form-group">
                            <label>Cargo:</label>
                            <input type="text" id="vereadorCargo" class="form-control">
                        </div>
                    </div>

                    <!-- Configurações do Mandato -->
                    <div class="config-card">
                        <h3><i class="fas fa-calendar"></i> Informações do Mandato</h3>
                        <div class="form-group">
                            <label>Período:</label>
                            <input type="text" id="mandatoPeriodo" class="form-control">
                        </div>
                        <div class="form-group">
                            <label>Status:</label>
                            <select id="mandatoStatus" class="form-control">
                                <option value="Em Exercício">Em Exercício</option>
                                <option value="Licenciado">Licenciado</option>
                                <option value="Afastado">Afastado</option>
                            </select>
                        </div>
                    </div>

                    <!-- Configurações das Estatísticas -->
                    <div class="config-card">
                        <h3><i class="fas fa-chart-bar"></i> Estatísticas do Mandato</h3>
                        <div class="form-grid">
                            <div class="form-group">
                                <label>Anos de Mandato:</label>
                                <input type="text" id="statAnosMandato" class="form-control">
                            </div>
                            <div class="form-group">
                                <label>Projetos Ativos:</label>
                                <input type="text" id="statProjetosAtivos" class="form-control">
                            </div>
                            <div class="form-group">
                                <label>Cidadãos Atendidos:</label>
                                <input type="text" id="statCidadaosAtendidos" class="form-control">
                            </div>
                            <div class="form-group">
                                <label>Taxa de Satisfação:</label>
                                <input type="text" id="statSatisfacao" class="form-control">
                            </div>
                        </div>
                    </div>

                    <!-- Configurações do Painel -->
                    <div class="config-card">
                        <h3><i class="fas fa-desktop"></i> Configurações do Painel</h3>
                        <div class="form-group">
                            <label>Título do Painel:</label>
                            <input type="text" id="painelTitulo" class="form-control">
                        </div>
                        <div class="form-group">
                            <label>Subtítulo:</label>
                            <textarea id="painelSubtitulo" class="form-control" rows="2"></textarea>
                        </div>
                    </div>

                    <!-- Cards Informativos -->
                    <div class="config-card">
                        <h3><i class="fas fa-info-circle"></i> Cards Informativos</h3>
                        <div class="form-grid">
                            <div class="form-group">
                                <label>Eleitores Cadastrados:</label>
                                <input type="text" id="cardEleitores" class="form-control">
                            </div>
                            <div class="form-group">
                                <label>Projetos em Andamento:</label>
                                <input type="text" id="cardProjetos" class="form-control">
                            </div>
                            <div class="form-group">
                                <label>Eventos Previstos:</label>
                                <input type="text" id="cardEventos" class="form-control">
                            </div>
                            <div class="form-group">
                                <label>Mensagens Recebidas:</label>
                                <input type="text" id="cardMensagens" class="form-control">
                            </div>
                        </div>
                    </div>

                    <!-- Botões de Ação -->
                    <div class="config-actions">
                        <button onclick="salvarConfiguracoes()" class="btn-primary">
                            <i class="fas fa-save"></i> Salvar Configurações
                        </button>
                        <button onclick="carregarConfiguracoes()" class="btn-secondary">
                            <i class="fas fa-refresh"></i> Recarregar
                        </button>
                        <button onclick="resetarConfiguracoes()" class="btn-danger">
                            <i class="fas fa-undo"></i> Restaurar Padrão
                        </button>
                    </div>
                </div>
            </section>

        </main>
    </div>

    <script>
        // Inicialização
        document.addEventListener('DOMContentLoaded', function() {
            updateDateTime();
            loadDashboardData();
            setupNavigation();
            setupMobileMenu();
            
            // Inicializar gráficos após um pequeno delay para garantir que as bibliotecas estejam carregadas
            setTimeout(() => {
                if (typeof Chart !== 'undefined') {
                    inicializarGraficos();
                }
                carregarRespostasAutomaticas();
                carregarListaNoticias();
            }, 500);
        });

        // Atualizar data atual
        function updateDateTime() {
            const now = new Date();
            const dataFormatada = now.toLocaleDateString('pt-BR', {
                day: '2-digit',
                month: '2-digit',
                year: 'numeric'
            });
            
            const dataAtualElement = document.getElementById('dataAtual');
            if (dataAtualElement) {
                dataAtualElement.textContent = dataFormatada;
            }
        }

        // Carregar dados do dashboard
        function loadDashboardData() {
            // Simulação de dados dinâmicos
            try {
                // Carregar eleitores de ambos os locais para compatibilidade
                let eleitores = JSON.parse(localStorage.getItem('eleitores') || '[]');
                const registeredUsers = JSON.parse(localStorage.getItem('registeredUsers') || '[]');
                
                // Se não há eleitores mas há usuários registrados, usar os usuários registrados
                if (eleitores.length === 0 && registeredUsers.length > 0) {
                    eleitores = registeredUsers.map(user => ({
                        nomeCompleto: user.name || user.nomeCompleto,
                        email: user.email,
                        telefone: user.phone || user.telefone,
                        bairro: user.neighborhood || user.bairro,
                        idade: user.age || user.idade,
                        genero: user.gender || user.genero,
                        dataCadastro: user.registrationDate || user.dataCadastro || new Date().toISOString(),
                        id: user.id || Date.now() + Math.random()
                    }));
                    // Salvar para manter compatibilidade
                    localStorage.setItem('eleitores', JSON.stringify(eleitores));
                }
                
                const totalEleitores = eleitores.length;
                
                // Atualizar total de eleitores
                document.getElementById('totalEleitores').textContent = totalEleitores.toLocaleString('pt-BR');
                
                // Recarregar tabela se estiver na seção de gestão
                if (document.getElementById('gestao-eleitores').style.display !== 'none') {
                    carregarEleitoresCompleto();
                }
                
                // Calcular aniversariantes do dia
                const hoje = new Date();
                const aniversariantes = eleitores.filter(eleitor => {
                    if (eleitor.dataNascimento) {
                        const nascimento = new Date(eleitor.dataNascimento);
                        return nascimento.getDate() === hoje.getDate() && 
                               nascimento.getMonth() === hoje.getMonth();
                    }
                    return false;
                });
                
                document.getElementById('aniversariantesHoje').textContent = aniversariantes.length;
                
                // Simular atendimentos do dia (dados fictícios)
                const atendimentosHoje = Math.floor(Math.random() * 30) + 15;
                document.getElementById('atendimentosHoje').textContent = atendimentosHoje;
                
            } catch (error) {
                console.error('Erro ao carregar dados do dashboard:', error);
            }
        }

        // Configurar navegação
        function setupNavigation() {
            const navLinks = document.querySelectorAll('.nav-link[data-section]');
            
            if (navLinks && navLinks.length > 0) {
                navLinks.forEach(link => {
                    if (link && typeof link.addEventListener === 'function') {
                        link.addEventListener('click', function(e) {
                            e.preventDefault();
                            
                            const sectionId = this.getAttribute('data-section');
                            showSection(sectionId);
                            
                            // Atualizar link ativo
                            navLinks.forEach(l => l.classList.remove('active'));
                            this.classList.add('active');
                            
                            // Fechar sidebar no mobile
                            closeSidebar();
                        });
                    }
                });
            }
        }

        // Mostrar seção
        function showSection(sectionId) {
            // Ocultar todas as seções
            const sections = document.querySelectorAll('.panel-section');
            sections.forEach(section => section.classList.remove('active'));
            
            // Mostrar seção solicitada
            const targetSection = document.getElementById(sectionId);
            if (targetSection) {
                targetSection.classList.add('active');
            }
            
            // Atualizar navegação
            const navLinks = document.querySelectorAll('.nav-link[data-section]');
            navLinks.forEach(link => {
                if (link.getAttribute('data-section') === sectionId) {
                    link.classList.add('active');
                } else {
                    link.classList.remove('active');
                }
            });
        }

        // Menu mobile
        function setupMobileMenu() {
            const mobileMenuBtn = document.getElementById('mobileMenuBtn');
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            
            mobileMenuBtn.addEventListener('click', function() {
                sidebar.classList.toggle('open');
                overlay.classList.toggle('active');
            });
        }

        function closeSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            
            sidebar.classList.remove('open');
            overlay.classList.remove('active');
        }

        // Função de logout
        function logout() {
            if (confirm('Tem certeza que deseja sair do sistema?')) {
                // Limpar dados de sessão se necessário
                localStorage.removeItem('sessionActive');
                
                // Redirecionar para login
                window.location.href = 'login.html';
            }
        }

        // Atualizar dados periodicamente
        setInterval(loadDashboardData, 60000); // Atualizar a cada minuto

        // ===== FUNÇÕES DAS AÇÕES RÁPIDAS =====

        // 1. Novo Eleitor
        function novoEleitor() {
            showSection('cadastro');
        }

        // 2. Nova Mensagem
        function novaMensagem() {
            showSection('comunicacao');
        }

        // 3. Gerar Relatório
        function gerarRelatorio() {
            showSection('relatorios');
        }

        // 4. Ver Mapa
        function verMapa() {
            alert('🗺️ Funcionalidade de mapa em desenvolvimento');
        }

        // ===== FUNCIONALIDADES DO CADASTRO =====

        // Configurar formulário de cadastro
        document.addEventListener('DOMContentLoaded', function() {
            const formCadastro = document.getElementById('cadastroEleitorForm');
            if (formCadastro) {
                formCadastro.addEventListener('submit', function(e) {
                    e.preventDefault();
                    salvarEleitor();
                });
            }

            const formMensagem = document.getElementById('mensagemForm');
            if (formMensagem) {
                formMensagem.addEventListener('submit', function(e) {
                    e.preventDefault();
                    enviarMensagem();
                });
            }
        });

        function salvarEleitor() {
            // Gerar gênero aleatório se não informado (para demonstração)
            const generos = ['Masculino', 'Feminino', 'Outro'];
            const generoAleatorio = generos[Math.floor(Math.random() * generos.length)];
            
            const eleitor = {
                id: Date.now(),
                nomeCompleto: document.getElementById('nomeCompleto').value,
                dataNascimento: document.getElementById('dataNascimento').value,
                telefone: document.getElementById('telefone').value,
                email: document.getElementById('email').value,
                endereco: document.getElementById('endereco').value,
                bairro: document.getElementById('bairro').value,
                genero: generoAleatorio, // Para demonstração - em um sistema real seria um campo do formulário
                dataCadastro: new Date().toISOString(),
                presente: false // Estado inicial de presença
            };

            try {
                let eleitores = JSON.parse(localStorage.getItem('eleitores') || '[]');
                eleitores.push(eleitor);
                localStorage.setItem('eleitores', JSON.stringify(eleitores));

                alert('Eleitor cadastrado com sucesso!');
                limparFormulario();
                loadDashboardData(); // Atualizar dashboard
            } catch (error) {
                alert('Erro ao salvar eleitor. Tente novamente.');
                console.error('Erro:', error);
            }
        }

        function limparFormulario() {
            document.getElementById('cadastroEleitorForm').reset();
        }

        // ===== FUNCIONALIDADES DE COMUNICAÇÃO =====

        function enviarMensagem() {
            const mensagem = {
                id: Date.now(),
                assunto: document.getElementById('assuntoMensagem').value,
                conteudo: document.getElementById('conteudoMensagem').value,
                dataEnvio: new Date().toISOString()
            };

            try {
                let mensagens = JSON.parse(localStorage.getItem('mensagens') || '[]');
                mensagens.unshift(mensagem); // Adicionar no início da lista
                localStorage.setItem('mensagens', JSON.stringify(mensagens));

                alert('Mensagem enviada com sucesso!');
                limparMensagem();
                carregarMensagensEnviadas();
            } catch (error) {
                alert('Erro ao enviar mensagem. Tente novamente.');
                console.error('Erro:', error);
            }
        }

        function limparMensagem() {
            document.getElementById('mensagemForm').reset();
        }

        function carregarMensagensEnviadas() {
            try {
                const mensagens = JSON.parse(localStorage.getItem('mensagens') || '[]');
                const listaMensagens = document.getElementById('listaMensagens');
                
                if (mensagens.length === 0) {
                    listaMensagens.innerHTML = '<p style="color: var(--text-secondary); text-align: center; padding: 2rem;">Nenhuma mensagem enviada ainda.</p>';
                    return;
                }

                listaMensagens.innerHTML = mensagens.slice(0, 5).map(mensagem => {
                    const data = new Date(mensagem.dataEnvio).toLocaleString('pt-BR');
                    return `
                        <div class="mensagem-item">
                            <div class="mensagem-assunto">${mensagem.assunto}</div>
                            <div class="mensagem-conteudo">${mensagem.conteudo.substring(0, 100)}${mensagem.conteudo.length > 100 ? '...' : ''}</div>
                            <div class="mensagem-data">Enviada em: ${data}</div>
                        </div>
                    `;
                }).join('');
            } catch (error) {
                console.error('Erro ao carregar mensagens:', error);
            }
        }

        // ===== FUNCIONALIDADES DE RELATÓRIOS =====

        function exportarRelatorioEleitorePDF() {
            try {
                const { jsPDF } = window.jspdf;
                const eleitores = JSON.parse(localStorage.getItem('eleitores') || '[]');
                
                if (eleitores.length === 0) {
                    alert('Não há eleitores cadastrados para exportar.');
                    return;
                }

                const doc = new jsPDF();
                
                // Cabeçalho do documento
                doc.setFontSize(16);
                doc.setFont(undefined, 'bold');
                doc.text('RELATÓRIO DE ELEITORES CADASTRADOS', 105, 20, { align: 'center' });
                
                doc.setFontSize(12);
                doc.setFont(undefined, 'normal');
                doc.text('Gabinete Digital - Vereador Emicleiton Rubem da Conceição', 105, 30, { align: 'center' });
                doc.text(`Data de Geração: ${new Date().toLocaleDateString('pt-BR')}`, 105, 40, { align: 'center' });
                
                // Estatísticas gerais
                doc.setFontSize(14);
                doc.setFont(undefined, 'bold');
                doc.text('ESTATÍSTICAS GERAIS', 20, 55);
                
                doc.setFontSize(11);
                doc.setFont(undefined, 'normal');
                doc.text(`Total de Eleitores: ${eleitores.length}`, 20, 65);
                
                // Contagem por bairro
                const bairros = {};
                eleitores.forEach(eleitor => {
                    const bairro = eleitor.bairro || 'Não informado';
                    bairros[bairro] = (bairros[bairro] || 0) + 1;
                });
                
                let yPos = 75;
                doc.text('Distribuição por Bairro:', 20, yPos);
                yPos += 10;
                
                Object.entries(bairros).forEach(([bairro, count]) => {
                    doc.text(`• ${bairro}: ${count} eleitor(es)`, 25, yPos);
                    yPos += 8;
                });
                
                // Lista detalhada dos eleitores
                yPos += 10;
                doc.setFontSize(14);
                doc.setFont(undefined, 'bold');
                doc.text('LISTA DETALHADA DOS ELEITORES', 20, yPos);
                yPos += 15;
                
                doc.setFontSize(10);
                doc.setFont(undefined, 'normal');
                
                eleitores.forEach((eleitor, index) => {
                    // Verificar se precisa de nova página
                    if (yPos > 270) {
                        doc.addPage();
                        yPos = 20;
                    }
                    
                    doc.setFont(undefined, 'bold');
                    doc.text(`${index + 1}. ${eleitor.nomeCompleto || 'Nome não informado'}`, 20, yPos);
                    yPos += 8;
                    
                    doc.setFont(undefined, 'normal');
                    if (eleitor.dataNascimento) {
                        const idade = calcularIdade(eleitor.dataNascimento);
                        doc.text(`   Data de Nascimento: ${new Date(eleitor.dataNascimento).toLocaleDateString('pt-BR')} (${idade} anos)`, 20, yPos);
                        yPos += 6;
                    }
                    
                    if (eleitor.telefone) {
                        doc.text(`   Telefone: ${eleitor.telefone}`, 20, yPos);
                        yPos += 6;
                    }
                    
                    if (eleitor.email) {
                        doc.text(`   Email: ${eleitor.email}`, 20, yPos);
                        yPos += 6;
                    }
                    
                    if (eleitor.endereco) {
                        doc.text(`   Endereço: ${eleitor.endereco}`, 20, yPos);
                        yPos += 6;
                    }
                    
                    if (eleitor.bairro) {
                        doc.text(`   Bairro: ${eleitor.bairro}`, 20, yPos);
                        yPos += 6;
                    }
                    
                    if (eleitor.dataCadastro) {
                        doc.text(`   Cadastrado em: ${new Date(eleitor.dataCadastro).toLocaleDateString('pt-BR')}`, 20, yPos);
                        yPos += 6;
                    }
                    
                    yPos += 5; // Espaço entre eleitores
                });
                
                // Rodapé
                const totalPages = doc.internal.getNumberOfPages();
                for (let i = 1; i <= totalPages; i++) {
                    doc.setPage(i);
                    doc.setFontSize(8);
                    doc.text(`Página ${i} de ${totalPages}`, 105, 285, { align: 'center' });
                    doc.text('Gabinete Digital - Monte Santo/BA', 105, 290, { align: 'center' });
                }
                
                doc.save(`relatorio_eleitores_${new Date().toISOString().split('T')[0]}.pdf`);
                alert('Relatório PDF gerado com sucesso!');
                
            } catch (error) {
                alert('Erro ao gerar relatório PDF. Tente novamente.');
                console.error('Erro:', error);
            }
        }

        function mostrarEstatisticas() {
            try {
                const eleitores = JSON.parse(localStorage.getItem('eleitores') || '[]');
                const container = document.getElementById('estatisticasContainer');
                const graficoElement = document.getElementById('graficoEstatisticas');

                if (eleitores.length === 0) {
                    graficoElement.innerHTML = '<p style="text-align: center; color: var(--text-secondary); padding: 2rem;">Não há dados para exibir.</p>';
                    container.style.display = 'block';
                    return;
                }

                // Contar eleitores por bairro
                const bairros = {};
                eleitores.forEach(eleitor => {
                    const bairro = eleitor.bairro || 'Não informado';
                    bairros[bairro] = (bairros[bairro] || 0) + 1;
                });

                // Encontrar o maior valor para calcular porcentagens
                const maxValue = Math.max(...Object.values(bairros));

                // Gerar HTML do gráfico
                const graficoHTML = Object.entries(bairros)
                    .sort((a, b) => b[1] - a[1])
                    .map(([bairro, count]) => {
                        const percentage = (count / maxValue) * 100;
                        return `
                            <div class="bairro-stat">
                                <div>
                                    <div class="bairro-nome">${bairro}</div>
                                    <div class="bairro-bar">
                                        <div class="bairro-fill" style="width: ${percentage}%"></div>
                                    </div>
                                </div>
                                <div class="bairro-count">${count}</div>
                            </div>
                        `;
                    }).join('');

                graficoElement.innerHTML = graficoHTML;
                container.style.display = 'block';
            } catch (error) {
                console.error('Erro ao gerar estatísticas:', error);
            }
        }

        // ===== FUNCIONALIDADES DE GEORREFERENCIAMENTO =====

        function inicializarGeorreferenciamento() {
            try {
                const eleitores = JSON.parse(localStorage.getItem('eleitores') || '[]');
                const mapaElement = document.getElementById('mapaEstatistico');

                if (eleitores.length === 0) {
                    mapaElement.innerHTML = '<p style="text-align: center; color: var(--text-secondary); padding: 2rem;">Não há dados para exibir no mapa.</p>';
                    return;
                }

                // Contar eleitores por bairro
                const bairros = {};
                eleitores.forEach(eleitor => {
                    const bairro = eleitor.bairro || 'Não informado';
                    bairros[bairro] = (bairros[bairro] || 0) + 1;
                });

                const totalEleitores = eleitores.length;
                const maxValue = Math.max(...Object.values(bairros));

                // Gerar mapa estatístico visual
                const mapaHTML = `
                    <div style="margin-bottom: 2rem;">
                        <h5 style="color: var(--text-dark); margin-bottom: 1rem;">Distribuição Geográfica dos Eleitores</h5>
                        <p style="color: var(--text-secondary); margin-bottom: 2rem;">Total de ${totalEleitores} eleitores cadastrados em Monte Santo/BA</p>
                    </div>
                    
                    <div class="mapa-grid">
                        ${Object.entries(bairros)
                            .sort((a, b) => b[1] - a[1])
                            .map(([bairro, count]) => {
                                const percentage = (count / totalEleitores * 100).toFixed(1);
                                const intensity = (count / maxValue) * 100;
                                return `
                                    <div class="area-mapa">
                                        <div class="area-header">
                                            <div class="area-nome">${bairro}</div>
                                            <div class="area-stats">
                                                <span class="area-count">${count} eleitores</span>
                                                <span class="area-percent">(${percentage}%)</span>
                                            </div>
                                        </div>
                                        <div class="area-visual">
                                            <div class="area-bar">
                                                <div class="area-fill" style="width: ${intensity}%"></div>
                                            </div>
                                        </div>
                                    </div>
                                `;
                            }).join('')}
                    </div>
                `;

                mapaElement.innerHTML = mapaHTML;
            } catch (error) {
                console.error('Erro ao carregar mapa:', error);
            }
        }

        // ===== CARREGAMENTO INICIAL DAS SEÇÕES =====

        // Observador para carregar conteúdo quando as seções ficam ativas
        const observer = new MutationObserver(function(mutations) {
            mutations.forEach(function(mutation) {
                if (mutation.type === 'attributes' && mutation.attributeName === 'class') {
                    const target = mutation.target;
                    if (target.classList.contains('active')) {
                        if (target.id === 'comunicacao') {
                            carregarMensagensEnviadas();

                        } else if (target.id === 'raio-x-votos') {
                            inicializarRaioXVotos();
                        } else if (target.id === 'mapa-eleitoral') {
                            inicializarMapaEleitoral();
                        } else if (target.id === 'analise-votos') {
                            inicializarAnaliseVotos();
                        } else if (target.id === 'gerenciar-conteudo') {
                            carregarGerenciarConteudo();
                        }
                    }
                }
            });
        });

        // Observar mudanças nas seções
        document.addEventListener('DOMContentLoaded', function() {
            const sections = document.querySelectorAll('.panel-section');
            sections.forEach(section => {
                observer.observe(section, { attributes: true });
            });
            
            // Configurar filtros da gestão de eleitores
            configurarFiltrosGestao();
        });

        // ===== FUNCIONALIDADES DE GESTÃO DE ELEITORES =====

        let eleitoresFiltrados = [];
        let presencas = JSON.parse(localStorage.getItem('presencas') || '{}');

        function configurarFiltrosGestao() {
            const filtros = ['filtroBairro', 'filtroIdade', 'filtroGenero'];
            
            filtros.forEach(filtroId => {
                const filtro = document.getElementById(filtroId);
                if (filtro) {
                    filtro.addEventListener('change', aplicarFiltros);
                }
            });
        }

        function calcularIdade(dataNascimento) {
            const hoje = new Date();
            const nascimento = new Date(dataNascimento);
            let idade = hoje.getFullYear() - nascimento.getFullYear();
            const m = hoje.getMonth() - nascimento.getMonth();
            if (m < 0 || (m === 0 && hoje.getDate() < nascimento.getDate())) {
                idade--;
            }
            return idade;
        }

        function getFaixaEtaria(idade) {
            if (idade >= 16 && idade <= 24) return '16-24';
            if (idade >= 25 && idade <= 34) return '25-34';
            if (idade >= 35 && idade <= 49) return '35-49';
            if (idade >= 50) return '50+';
            return 'Não informado';
        }

        function aplicarFiltros() {
            try {
                const eleitores = JSON.parse(localStorage.getItem('eleitores') || '[]');
                const filtroBairro = document.getElementById('filtroBairro').value;
                const filtroIdade = document.getElementById('filtroIdade').value;
                const filtroGenero = document.getElementById('filtroGenero').value;

                eleitoresFiltrados = eleitores.filter(eleitor => {
                    // Filtro por bairro
                    if (filtroBairro && eleitor.bairro !== filtroBairro) {
                        return false;
                    }

                    // Filtro por faixa etária
                    if (filtroIdade && eleitor.dataNascimento) {
                        const idade = calcularIdade(eleitor.dataNascimento);
                        const faixaEtaria = getFaixaEtaria(idade);
                        if (faixaEtaria !== filtroIdade) {
                            return false;
                        }
                    }

                    // Filtro por gênero
                    if (filtroGenero && eleitor.genero !== filtroGenero) {
                        return false;
                    }

                    return true;
                });

                carregarTabelaEleitores();
                atualizarEstatisticasGestao();

            } catch (error) {
                console.error('Erro ao aplicar filtros:', error);
            }
        }

        function limparFiltros() {
            document.getElementById('filtroBairro').value = '';
            document.getElementById('filtroIdade').value = '';
            document.getElementById('filtroGenero').value = '';
            aplicarFiltros();
        }

        function carregarTabelaEleitores() {
            const corpoTabela = document.getElementById('corpoTabela');
            const infoTabela = document.getElementById('infoTabela');

            if (eleitoresFiltrados.length === 0) {
                corpoTabela.innerHTML = `
                    <tr>
                        <td colspan="6" class="estado-vazio">
                            <i class="fas fa-users"></i>
                            <p>Nenhum eleitor encontrado com os filtros aplicados.</p>
                        </td>
                    </tr>
                `;
                infoTabela.textContent = 'Nenhum eleitor encontrado';
                return;
            }

            const linhasHTML = eleitoresFiltrados.map(eleitor => {
                const idade = eleitor.dataNascimento ? calcularIdade(eleitor.dataNascimento) : 'N/A';
                const presente = presencas[eleitor.id] || false;
                const statusPresenca = presente 
                    ? '<i class="fas fa-check"></i> Presente'
                    : '<i class="fas fa-plus"></i> Marcar';
                const classePresenca = presente ? 'presente' : '';

                return `
                    <tr>
                        <td><strong>${eleitor.nomeCompleto}</strong></td>
                        <td>${idade} anos</td>
                        <td>${eleitor.genero || 'N/A'}</td>
                        <td>${eleitor.bairro}</td>
                        <td>${eleitor.telefone}</td>
                        <td>
                            <button onclick="togglePresenca(${eleitor.id})" class="btn-presenca ${classePresenca}">
                                ${statusPresenca}
                            </button>
                        </td>
                    </tr>
                `;
            }).join('');

            corpoTabela.innerHTML = linhasHTML;
            infoTabela.textContent = `${eleitoresFiltrados.length} eleitor(es) encontrado(s)`;
        }

        function atualizarEstatisticasGestao() {
            const totalExibidos = eleitoresFiltrados.length;
            const totalPresentes = eleitoresFiltrados.filter(eleitor => presencas[eleitor.id]).length;
            const percentualPresenca = totalExibidos > 0 ? ((totalPresentes / totalExibidos) * 100).toFixed(1) : 0;

            document.getElementById('totalExibidos').textContent = totalExibidos;
            document.getElementById('totalPresentes').textContent = totalPresentes;
            document.getElementById('percentualPresenca').textContent = percentualPresenca + '%';
        }

        function togglePresenca(eleitorId) {
            presencas[eleitorId] = !presencas[eleitorId];
            localStorage.setItem('presencas', JSON.stringify(presencas));
            carregarTabelaEleitores();
            atualizarEstatisticasGestao();
        }

        function marcarTodosPresentes() {
            if (confirm('Deseja marcar todos os eleitores exibidos como presentes?')) {
                eleitoresFiltrados.forEach(eleitor => {
                    presencas[eleitor.id] = true;
                });
                localStorage.setItem('presencas', JSON.stringify(presencas));
                carregarTabelaEleitores();
                atualizarEstatisticasGestao();
                alert('Todos os eleitores foram marcados como presentes!');
            }
        }

        function limparPresencas() {
            if (confirm('Deseja limpar todas as presenças registradas?')) {
                presencas = {};
                localStorage.setItem('presencas', JSON.stringify(presencas));
                carregarTabelaEleitores();
                atualizarEstatisticasGestao();
                alert('Todas as presenças foram removidas!');
            }
        }

        function exportarEleitoresFiltrados() {
            try {
                const { jsPDF } = window.jspdf;
                
                if (eleitoresFiltrados.length === 0) {
                    alert('Não há eleitores para exportar com os filtros aplicados.');
                    return;
                }

                const doc = new jsPDF();
                
                // Obter filtros aplicados
                const filtroBairro = document.getElementById('filtroBairro').value;
                const filtroIdade = document.getElementById('filtroIdade').value;
                const filtroGenero = document.getElementById('filtroGenero').value;
                
                // Cabeçalho do documento
                doc.setFontSize(16);
                doc.setFont(undefined, 'bold');
                doc.text('RELATÓRIO DE ELEITORES FILTRADOS', 105, 20, { align: 'center' });
                
                doc.setFontSize(12);
                doc.setFont(undefined, 'normal');
                doc.text('Gabinete Digital - Vereador Emicleiton Rubem da Conceição', 105, 30, { align: 'center' });
                doc.text(`Data de Geração: ${new Date().toLocaleDateString('pt-BR')}`, 105, 40, { align: 'center' });
                
                // Filtros aplicados
                let yPos = 55;
                doc.setFontSize(14);
                doc.setFont(undefined, 'bold');
                doc.text('FILTROS APLICADOS', 20, yPos);
                yPos += 10;
                
                doc.setFontSize(11);
                doc.setFont(undefined, 'normal');
                if (filtroBairro) {
                    doc.text(`• Bairro: ${filtroBairro}`, 20, yPos);
                    yPos += 8;
                }
                if (filtroIdade) {
                    doc.text(`• Faixa Etária: ${filtroIdade}`, 20, yPos);
                    yPos += 8;
                }
                if (filtroGenero) {
                    doc.text(`• Gênero: ${filtroGenero}`, 20, yPos);
                    yPos += 8;
                }
                if (!filtroBairro && !filtroIdade && !filtroGenero) {
                    doc.text('• Nenhum filtro aplicado (todos os eleitores)', 20, yPos);
                    yPos += 8;
                }
                
                // Estatísticas
                yPos += 5;
                doc.setFontSize(14);
                doc.setFont(undefined, 'bold');
                doc.text('ESTATÍSTICAS', 20, yPos);
                yPos += 10;
                
                doc.setFontSize(11);
                doc.setFont(undefined, 'normal');
                doc.text(`Total de Eleitores: ${eleitoresFiltrados.length}`, 20, yPos);
                yPos += 8;
                
                const presentes = eleitoresFiltrados.filter(e => presencas[e.id]).length;
                doc.text(`Presentes no Evento: ${presentes}`, 20, yPos);
                yPos += 8;
                
                const ausentes = eleitoresFiltrados.length - presentes;
                doc.text(`Ausentes no Evento: ${ausentes}`, 20, yPos);
                yPos += 15;
                
                // Lista detalhada dos eleitores
                doc.setFontSize(14);
                doc.setFont(undefined, 'bold');
                doc.text('LISTA DETALHADA DOS ELEITORES', 20, yPos);
                yPos += 15;
                
                doc.setFontSize(10);
                doc.setFont(undefined, 'normal');
                
                eleitoresFiltrados.forEach((eleitor, index) => {
                    // Verificar se precisa de nova página
                    if (yPos > 270) {
                        doc.addPage();
                        yPos = 20;
                    }
                    
                    const idade = eleitor.dataNascimento ? calcularIdade(eleitor.dataNascimento) : 'N/A';
                    const presente = presencas[eleitor.id] ? 'SIM' : 'NÃO';
                    
                    doc.setFont(undefined, 'bold');
                    doc.text(`${index + 1}. ${eleitor.nomeCompleto || 'Nome não informado'}`, 20, yPos);
                    yPos += 8;
                    
                    doc.setFont(undefined, 'normal');
                    doc.text(`   Idade: ${idade} anos | Gênero: ${eleitor.genero || 'N/A'} | Presente: ${presente}`, 20, yPos);
                    yPos += 6;
                    
                    if (eleitor.telefone) {
                        doc.text(`   Telefone: ${eleitor.telefone}`, 20, yPos);
                        yPos += 6;
                    }
                    
                    if (eleitor.email) {
                        doc.text(`   Email: ${eleitor.email}`, 20, yPos);
                        yPos += 6;
                    }
                    
                    if (eleitor.endereco) {
                        doc.text(`   Endereço: ${eleitor.endereco}`, 20, yPos);
                        yPos += 6;
                    }
                    
                    if (eleitor.bairro) {
                        doc.text(`   Bairro: ${eleitor.bairro}`, 20, yPos);
                        yPos += 6;
                    }
                    
                    yPos += 5; // Espaço entre eleitores
                });
                
                // Rodapé
                const totalPages = doc.internal.getNumberOfPages();
                for (let i = 1; i <= totalPages; i++) {
                    doc.setPage(i);
                    doc.setFontSize(8);
                    doc.text(`Página ${i} de ${totalPages}`, 105, 285, { align: 'center' });
                    doc.text('Gabinete Digital - Monte Santo/BA', 105, 290, { align: 'center' });
                }
                
                // Nome do arquivo com filtros aplicados
                let nomeArquivo = 'eleitores_filtrados';
                if (filtroBairro) nomeArquivo += `_${filtroBairro}`;
                if (filtroIdade) nomeArquivo += `_${filtroIdade}`;
                if (filtroGenero) nomeArquivo += `_${filtroGenero}`;
                nomeArquivo += `_${new Date().toISOString().split('T')[0]}.pdf`;
                
                doc.save(nomeArquivo);
                alert(`Relatório PDF exportado com ${eleitoresFiltrados.length} eleitor(es)!`);
                
            } catch (error) {
                alert('Erro ao exportar relatório PDF. Tente novamente.');
                console.error('Erro:', error);
            }
        }

        // Carregar gestão quando a seção ficar ativa
        function carregarGestaoEleitores() {
            aplicarFiltros(); // Isso carregará todos os eleitores inicialmente
        }

        // Atualizar o observador para incluir a gestão
        const observerOriginal = new MutationObserver(function(mutations) {
            mutations.forEach(function(mutation) {
                if (mutation.type === 'attributes' && mutation.attributeName === 'class') {
                    const target = mutation.target;
                    if (target.classList.contains('active')) {
                        if (target.id === 'comunicacao') {
                            carregarMensagensEnviadas();

                        } else if (target.id === 'gestao') {
                            carregarGestaoEleitores();
                        } else if (target.id === 'nova-mensagem') {
                            carregarNovaMensagem();
                        }
                    }
                }
            });
        });

        // ===== FUNCIONALIDADES DE NOVA MENSAGEM COM EMAILJS REAL =====

        let emailsEnviados = JSON.parse(localStorage.getItem('emailsEnviados') || '[]');

        function carregarNovaMensagem() {
            carregarHistoricoEmails();
            verificarConfiguracaoEmailJS();
        }

        function verificarConfiguracaoEmailJS() {
            // Verificar se EmailJS está configurado
            if (typeof emailjs === 'undefined') {
                mostrarAlerteConfiguracao('EmailJS não está carregado. Verifique a conexão com a internet.');
                return false;
            }
            return true;
        }

        function mostrarAlerteConfiguracao(mensagem) {
            const formContainer = document.querySelector('.form-email-container');
            const alerteExistente = formContainer.querySelector('.config-alert');
            
            if (alerteExistente) {
                alerteExistente.remove();
            }
            
            const alerte = document.createElement('div');
            alerte.className = 'config-alert';
            alerte.innerHTML = `
                <i class="fas fa-exclamation-triangle"></i>
                <div class="config-alert-text">${mensagem}</div>
            `;
            
            formContainer.insertBefore(alerte, formContainer.firstChild);
        }

        function enviarEmailReal(event) {
            event.preventDefault();
            
            if (!verificarConfiguracaoEmailJS()) {
                mostrarStatusEnvioReal(false, 'Erro: EmailJS não está configurado corretamente.');
                return;
            }
            
            const btnEnviar = document.getElementById('btnEnviarReal');
            const loaderEnvio = document.getElementById('loaderEnvio');
            
            // Mostrar loader e desabilitar botão
            btnEnviar.disabled = true;
            loaderEnvio.style.display = 'flex';
            
            // Obter dados do formulário
            const nomeRemetente = document.getElementById('nomeRemetente').value;
            const emailRemetente = document.getElementById('emailRemetente').value;
            const assunto = document.getElementById('assuntoEmail').value;
            const destinatario = document.getElementById('destinatarioEmail').value;
            const mensagem = document.getElementById('mensagemEmail').value;
            const titulo = document.getElementById('tituloFixo').value;
            
            // Parâmetros para o template EmailJS
            const templateParams = {
                from_name: nomeRemetente,
                from_email: emailRemetente,
                to_email: destinatario,
                subject: assunto,
                message: mensagem,
                title: titulo,
                reply_to: emailRemetente
            };
            
            // Enviar e-mail usando credenciais reais
            emailjs.send('service_oaoj2xm', 'mftqhfl', templateParams)
                .then(function(response) {
                    console.log('EmailJS SUCCESS:', response.status, response.text);
                    mostrarStatusEnvioReal(true, 'E-mail enviado com sucesso!');
                    salvarEmailEnviadoReal(destinatario, assunto, mensagem, nomeRemetente, emailRemetente);
                    limparFormularioEmailReal();
                    carregarHistoricoEmails();
                })
                .catch(function(error) {
                    console.error('EmailJS ERROR:', error);
                    mostrarStatusEnvioReal(false, 'Erro ao enviar e-mail. Tente novamente.');
                })
                .finally(function() {
                    // Ocultar loader e reabilitar botão
                    btnEnviar.disabled = false;
                    loaderEnvio.style.display = 'none';
                });
        }

        function mostrarStatusEnvioReal(sucesso, mensagem) {
            const statusEnvio = document.getElementById('statusEnvio');
            const statusIcon = statusEnvio.querySelector('.status-icon');
            const statusText = statusEnvio.querySelector('.status-text');
            
            // Configurar ícone e classe
            if (sucesso) {
                statusEnvio.className = 'status-envio';
                statusIcon.innerHTML = '<i class="fas fa-check"></i>';
            } else {
                statusEnvio.className = 'status-envio erro';
                statusIcon.innerHTML = '<i class="fas fa-times"></i>';
            }
            
            statusText.textContent = mensagem;
            statusEnvio.style.display = 'block';
            
            // Ocultar após 5 segundos
            setTimeout(() => {
                statusEnvio.style.display = 'none';
            }, 5000);
        }

        function salvarEmailEnviadoReal(destinatario, assunto, mensagem, nomeRemetente, emailRemetente) {
            const email = {
                id: Date.now(),
                destinatario: destinatario,
                assunto: assunto,
                mensagem: mensagem,
                nomeRemetente: nomeRemetente,
                emailRemetente: emailRemetente,
                dataEnvio: new Date().toISOString(),
                status: 'enviado'
            };
            
            emailsEnviados.unshift(email); // Adicionar no início do array
            
            // Manter apenas os últimos 50 e-mails
            if (emailsEnviados.length > 50) {
                emailsEnviados = emailsEnviados.slice(0, 50);
            }
            
            localStorage.setItem('emailsEnviados', JSON.stringify(emailsEnviados));
        }

        function carregarHistoricoEmails() {
            const listaEmails = document.getElementById('listaEmails');
            
            if (emailsEnviados.length === 0) {
                listaEmails.innerHTML = `
                    <div class="emails-vazio">
                        <i class="fas fa-envelope-open"></i>
                        <p>Nenhum e-mail enviado ainda.</p>
                        <small>Os e-mails enviados aparecerão aqui com data e hora.</small>
                    </div>
                `;
                return;
            }
            
            // Mostrar apenas os últimos 15 e-mails
            const emailsRecentes = emailsEnviados.slice(0, 15);
            
            const emailsHTML = emailsRecentes.map(email => {
                const dataFormatada = new Date(email.dataEnvio).toLocaleString('pt-BR', {
                    day: '2-digit',
                    month: '2-digit',
                    year: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });
                
                const previewMensagem = email.mensagem.length > 120 
                    ? email.mensagem.substring(0, 120) + '...'
                    : email.mensagem;
                
                return `
                    <div class="email-item">
                        <div class="email-header">
                            <div class="email-assunto">${email.assunto}</div>
                            <div class="email-data">${dataFormatada}</div>
                        </div>
                        <div class="email-destinatario">
                            <i class="fas fa-user"></i>
                            <strong>De:</strong> ${email.nomeRemetente || 'N/A'} (${email.emailRemetente || 'N/A'})
                        </div>
                        <div class="email-destinatario">
                            <i class="fas fa-arrow-right"></i>
                            <strong>Para:</strong> ${email.destinatario}
                        </div>
                        <div class="email-preview">${previewMensagem}</div>
                    </div>
                `;
            }).join('');
            
            listaEmails.innerHTML = emailsHTML;
        }

        function limparFormularioEmailReal() {
            document.getElementById('formEmail').reset();
            document.getElementById('statusEnvio').style.display = 'none';
            
            // Remover alerta de configuração se existir
            const alerteExistente = document.querySelector('.config-alert');
            if (alerteExistente) {
                alerteExistente.remove();
            }
        }

        // ===== FUNCIONALIDADES DE RELATÓRIOS E GRÁFICOS =====

        let graficos = {};
        let dadosAtendimentos = [
            { tipo: 'Saúde', mes: 'Janeiro', status: 'Concluído', data: '2025-01-15' },
            { tipo: 'Educação', mes: 'Janeiro', status: 'Em Andamento', data: '2025-01-20' },
            { tipo: 'Infraestrutura', mes: 'Fevereiro', status: 'Concluído', data: '2025-02-05' },
            { tipo: 'Saúde', mes: 'Fevereiro', status: 'Pendente', data: '2025-02-10' },
            { tipo: 'Segurança', mes: 'Março', status: 'Concluído', data: '2025-03-01' },
            { tipo: 'Educação', mes: 'Março', status: 'Em Andamento', data: '2025-03-15' },
            { tipo: 'Infraestrutura', mes: 'Abril', status: 'Concluído', data: '2025-04-02' },
            { tipo: 'Saúde', mes: 'Abril', status: 'Concluído', data: '2025-04-18' },
            { tipo: 'Meio Ambiente', mes: 'Maio', status: 'Em Andamento', data: '2025-05-10' },
            { tipo: 'Segurança', mes: 'Maio', status: 'Pendente', data: '2025-05-25' },
            { tipo: 'Educação', mes: 'Junho', status: 'Concluído', data: '2025-06-05' },
            { tipo: 'Infraestrutura', mes: 'Junho', status: 'Em Andamento', data: '2025-06-20' }
        ];

        function inicializarGraficos() {
            criarGraficoTipos();
            criarGraficoMeses();
            criarGraficoStatus();
            criarGraficoEvolucao();
        }

        function criarGraficoTipos() {
            const ctx = document.getElementById('graficoTipos').getContext('2d');
            const tipos = {};
            
            dadosAtendimentos.forEach(item => {
                tipos[item.tipo] = (tipos[item.tipo] || 0) + 1;
            });

            graficos.tipos = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(tipos),
                    datasets: [{
                        data: Object.values(tipos),
                        backgroundColor: [
                            '#1e40af', '#059669', '#dc2626', '#d97706', '#7c3aed', '#0891b2'
                        ],
                        borderWidth: 2,
                        borderColor: '#ffffff'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 20,
                                usePointStyle: true
                            }
                        }
                    }
                }
            });
        }

        function criarGraficoMeses() {
            const ctx = document.getElementById('graficoMeses').getContext('2d');
            const meses = {};
            
            dadosAtendimentos.forEach(item => {
                meses[item.mes] = (meses[item.mes] || 0) + 1;
            });

            const mesesOrdenados = ['Janeiro', 'Fevereiro', 'Março', 'Abril', 'Maio', 'Junho'];
            const dados = mesesOrdenados.map(mes => meses[mes] || 0);

            graficos.meses = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: mesesOrdenados,
                    datasets: [{
                        label: 'Atendimentos',
                        data: dados,
                        backgroundColor: 'rgba(30, 64, 175, 0.8)',
                        borderColor: '#1e40af',
                        borderWidth: 1,
                        borderRadius: 6
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                stepSize: 1
                            }
                        }
                    }
                }
            });
        }

        function criarGraficoStatus() {
            const ctx = document.getElementById('graficoStatus').getContext('2d');
            const status = {};
            
            dadosAtendimentos.forEach(item => {
                status[item.status] = (status[item.status] || 0) + 1;
            });

            graficos.status = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: Object.keys(status),
                    datasets: [{
                        data: Object.values(status),
                        backgroundColor: ['#059669', '#d97706', '#dc2626'],
                        borderWidth: 2,
                        borderColor: '#ffffff'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 20,
                                usePointStyle: true
                            }
                        }
                    }
                }
            });
        }

        function criarGraficoEvolucao() {
            const ctx = document.getElementById('graficoEvolucao').getContext('2d');
            const meses = ['Janeiro', 'Fevereiro', 'Março', 'Abril', 'Maio', 'Junho'];
            const evolucao = {};
            
            // Calcular evolução acumulativa
            let acumulado = 0;
            meses.forEach(mes => {
                const count = dadosAtendimentos.filter(item => item.mes === mes).length;
                acumulado += count;
                evolucao[mes] = acumulado;
            });

            graficos.evolucao = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: meses,
                    datasets: [{
                        label: 'Total Acumulado',
                        data: Object.values(evolucao),
                        borderColor: '#1e40af',
                        backgroundColor: 'rgba(30, 64, 175, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4,
                        pointBackgroundColor: '#1e40af',
                        pointBorderColor: '#ffffff',
                        pointBorderWidth: 2,
                        pointRadius: 6
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                stepSize: 1
                            }
                        }
                    }
                }
            });
        }

        function atualizarGraficos() {
            Object.values(graficos).forEach(grafico => {
                if (grafico) {
                    grafico.destroy();
                }
            });
            inicializarGraficos();
            
            // Mostrar feedback
            const btn = event.target;
            const textoOriginal = btn.innerHTML;
            btn.innerHTML = '<i class="fas fa-check"></i> Atualizado!';
            btn.style.background = '#059669';
            
            setTimeout(() => {
                btn.innerHTML = textoOriginal;
                btn.style.background = '';
            }, 2000);
        }

        // Exportação PDF
        function exportarRelatorioPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // Título
            doc.setFontSize(20);
            doc.text('Relatório de Atendimentos', 20, 30);
            
            // Data
            doc.setFontSize(12);
            doc.text(`Gerado em: ${new Date().toLocaleDateString('pt-BR')}`, 20, 45);
            
            // Resumo
            doc.setFontSize(14);
            doc.text('Resumo Geral:', 20, 65);
            
            doc.setFontSize(11);
            doc.text(`Total de Atendimentos: ${dadosAtendimentos.length}`, 20, 80);
            
            // Contagem por tipo
            const tipos = {};
            dadosAtendimentos.forEach(item => {
                tipos[item.tipo] = (tipos[item.tipo] || 0) + 1;
            });
            
            let y = 95;
            doc.text('Atendimentos por Tipo:', 20, y);
            y += 10;
            
            Object.entries(tipos).forEach(([tipo, quantidade]) => {
                doc.text(`• ${tipo}: ${quantidade}`, 25, y);
                y += 10;
            });
            
            // Lista detalhada
            y += 10;
            doc.setFontSize(14);
            doc.text('Detalhamento:', 20, y);
            y += 15;
            
            doc.setFontSize(10);
            dadosAtendimentos.forEach((item, index) => {
                if (y > 270) {
                    doc.addPage();
                    y = 20;
                }
                doc.text(`${index + 1}. ${item.tipo} - ${item.status} (${item.mes})`, 20, y);
                y += 8;
            });
            
            doc.save(`relatorio_atendimentos_${new Date().toISOString().split('T')[0]}.pdf`);
        }

        // Exportação CSV
        function exportarRelatorioPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // Cabeçalho do documento
            doc.setFontSize(18);
            doc.setFont(undefined, 'bold');
            doc.text('Relatório de Atendimentos', 20, 20);
            
            doc.setFontSize(12);
            doc.setFont(undefined, 'normal');
            doc.text('Gabinete Digital - Vereador Emicleiton Rubem da Conceição', 20, 30);
            doc.text(`Data: ${new Date().toLocaleDateString('pt-BR')}`, 20, 40);
            
            // Tabela de dados
            let y = 60;
            doc.setFontSize(10);
            doc.setFont(undefined, 'bold');
            
            // Cabeçalhos da tabela
            doc.text('Tipo', 20, y);
            doc.text('Mês', 60, y);
            doc.text('Status', 100, y);
            doc.text('Data', 140, y);
            
            y += 10;
            doc.setFont(undefined, 'normal');
            
            // Dados da tabela
            dadosAtendimentos.forEach((item, index) => {
                if (y > 280) { // Nova página se necessário
                    doc.addPage();
                    y = 20;
                }
                
                doc.text(item.tipo || '-', 20, y);
                doc.text(item.mes || '-', 60, y);
                doc.text(item.status || '-', 100, y);
                doc.text(item.data || '-', 140, y);
                y += 8;
            });
            
            // Rodapé
            doc.setFontSize(8);
            doc.text('Relatório gerado automaticamente pelo sistema do Gabinete Digital', 20, 290);
            
            // Download do PDF
            const filename = `relatorio_atendimentos_${new Date().toISOString().split('T')[0]}.pdf`;
            doc.save(filename);
        }

        // Exportação de Eleitores em PDF
        function exportarEleitoresPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // Cabeçalho do documento
            doc.setFontSize(18);
            doc.setFont(undefined, 'bold');
            doc.text('Relatório de Eleitores Cadastrados', 20, 20);
            
            doc.setFontSize(12);
            doc.setFont(undefined, 'normal');
            doc.text('Gabinete Digital - Vereador Emicleiton Rubem da Conceição', 20, 30);
            doc.text(`Data: ${new Date().toLocaleDateString('pt-BR')}`, 20, 40);
            doc.text(`Total de eleitores: ${eleitoresCadastrados.length}`, 20, 50);
            
            // Tabela de dados
            let y = 70;
            doc.setFontSize(9);
            doc.setFont(undefined, 'bold');
            
            // Cabeçalhos da tabela
            doc.text('Nome', 20, y);
            doc.text('Bairro', 80, y);
            doc.text('Telefone', 130, y);
            doc.text('Status', 170, y);
            
            y += 10;
            doc.setFont(undefined, 'normal');
            
            // Dados da tabela
            eleitoresCadastrados.forEach((eleitor, index) => {
                if (y > 280) { // Nova página se necessário
                    doc.addPage();
                    y = 20;
                    
                    // Repetir cabeçalhos na nova página
                    doc.setFont(undefined, 'bold');
                    doc.text('Nome', 20, y);
                    doc.text('Bairro', 80, y);
                    doc.text('Telefone', 130, y);
                    doc.text('Status', 170, y);
                    y += 10;
                    doc.setFont(undefined, 'normal');
                }
                
                doc.text(eleitor.nome?.substring(0, 25) || '-', 20, y);
                doc.text(eleitor.bairro?.substring(0, 20) || '-', 80, y);
                doc.text(eleitor.telefone || '-', 130, y);
                doc.text(eleitor.status || 'Ativo', 170, y);
                y += 8;
            });
            
            // Rodapé
            doc.setFontSize(8);
            doc.text('Relatório gerado automaticamente pelo sistema do Gabinete Digital', 20, 290);
            
            // Download do PDF
            const filename = `eleitores_cadastrados_${new Date().toISOString().split('T')[0]}.pdf`;
            doc.save(filename);
        }

        // ===== FUNCIONALIDADES DE RESPOSTAS AUTOMÁTICAS =====

        let respostasAutomaticas = JSON.parse(localStorage.getItem('respostasAutomaticas') || '[]');

        function carregarRespostasAutomaticas() {
            const lista = document.getElementById('listaRespostasAutomaticas');
            
            if (respostasAutomaticas.length === 0) {
                lista.innerHTML = `
                    <div class="emails-vazio">
                        <i class="fas fa-robot"></i>
                        <p>Nenhuma resposta automática configurada.</p>
                        <small>Configure palavras-chave para respostas automáticas.</small>
                    </div>
                `;
                return;
            }
            
            const respostasHTML = respostasAutomaticas.map((resposta, index) => `
                <div class="resposta-card">
                    <div class="resposta-palavras">
                        ${resposta.palavras.map(palavra => 
                            `<span class="palavra-tag">${palavra}</span>`
                        ).join('')}
                    </div>
                    <div class="resposta-texto">${resposta.texto}</div>
                    <div class="resposta-actions">
                        <button class="btn-resposta btn-edit" onclick="editarResposta(${index})">
                            <i class="fas fa-edit"></i> Editar
                        </button>
                        <button class="btn-resposta btn-delete" onclick="excluirResposta(${index})">
                            <i class="fas fa-trash"></i> Excluir
                        </button>
                    </div>
                </div>
            `).join('');
            
            lista.innerHTML = respostasHTML;
        }

        function adicionarRespostaAutomatica() {
            const palavrasInput = document.getElementById('palavrasChave');
            const textoInput = document.getElementById('respostaTexto');
            
            const palavrasTexto = palavrasInput.value.trim();
            const texto = textoInput.value.trim();
            
            if (!palavrasTexto || !texto) {
                alert('Por favor, preencha todos os campos.');
                return;
            }
            
            const palavras = palavrasTexto.split(',').map(p => p.trim()).filter(p => p);
            
            const novaResposta = {
                id: Date.now(),
                palavras: palavras,
                texto: texto,
                criada: new Date().toISOString()
            };
            
            respostasAutomaticas.push(novaResposta);
            localStorage.setItem('respostasAutomaticas', JSON.stringify(respostasAutomaticas));
            
            // Limpar formulário
            palavrasInput.value = '';
            textoInput.value = '';
            
            carregarRespostasAutomaticas();
            
            // Feedback visual
            alert('Resposta automática adicionada com sucesso!');
        }

        function editarResposta(index) {
            const resposta = respostasAutomaticas[index];
            
            document.getElementById('palavrasChave').value = resposta.palavras.join(', ');
            document.getElementById('respostaTexto').value = resposta.texto;
            
            // Remover a resposta atual para substituir
            excluirResposta(index);
        }

        function excluirResposta(index) {
            if (confirm('Tem certeza que deseja excluir esta resposta automática?')) {
                respostasAutomaticas.splice(index, 1);
                localStorage.setItem('respostasAutomaticas', JSON.stringify(respostasAutomaticas));
                carregarRespostasAutomaticas();
            }
        }

        function verificarRespostaAutomatica(mensagem) {
            const mensagemLower = mensagem.toLowerCase();
            
            for (let resposta of respostasAutomaticas) {
                for (let palavra of resposta.palavras) {
                    if (mensagemLower.includes(palavra.toLowerCase())) {
                        return resposta.texto;
                    }
                }
            }
            
            return null;
        }

        // ===== FUNCIONALIDADES DE GESTÃO DE NOTÍCIAS =====

        let noticiasPublicadas = JSON.parse(localStorage.getItem('noticiasPublicadas') || '[]');

        function publicarNoticia(event) {
            event.preventDefault();
            
            const titulo = document.getElementById('tituloNoticia').value.trim();
            const categoria = document.getElementById('categoriaNoticia').value;
            const resumo = document.getElementById('resumoNoticia').value.trim();
            const imagem = document.getElementById('imagemNoticia').value.trim();
            const conteudo = document.getElementById('conteudoNoticia').value.trim();
            const tagsInput = document.getElementById('tagsNoticia').value.trim();
            
            if (!titulo || !categoria || !resumo || !conteudo) {
                alert('Por favor, preencha todos os campos obrigatórios.');
                return;
            }
            
            const tags = tagsInput ? tagsInput.split(',').map(tag => tag.trim()).filter(tag => tag) : [];
            
            const novaNoticia = {
                id: Date.now(),
                titulo: titulo,
                categoria: categoria,
                resumo: resumo,
                imagem: imagem || 'https://via.placeholder.com/400x250/1e40af/ffffff?text=Notícia',
                conteudo: conteudo,
                tags: tags,
                data: new Date().toISOString(),
                dataFormatada: new Date().toLocaleDateString('pt-BR', {
                    day: '2-digit',
                    month: 'long',
                    year: 'numeric'
                })
            };
            
            noticiasPublicadas.unshift(novaNoticia);
            localStorage.setItem('noticiasPublicadas', JSON.stringify(noticiasPublicadas));
            
            // Atualizar seção de notícias no site público
            atualizarNoticiasPublicas();
            
            // Limpar formulário
            limparFormularioNoticia();
            
            // Recarregar lista
            carregarListaNoticias();
            
            alert('Notícia publicada com sucesso!');
        }

        function limparFormularioNoticia() {
            document.getElementById('formNoticia').reset();
            document.querySelector('.char-counter').textContent = '0/200 caracteres';
        }

        function carregarListaNoticias() {
            const lista = document.getElementById('listaNoticias');
            const filtroCategoria = document.getElementById('filtroCategoriaNoticias').value;
            
            let noticiasFiltradas = noticiasPublicadas;
            if (filtroCategoria) {
                noticiasFiltradas = noticiasPublicadas.filter(noticia => noticia.categoria === filtroCategoria);
            }
            
            if (noticiasFiltradas.length === 0) {
                lista.innerHTML = `
                    <div class="emails-vazio">
                        <i class="fas fa-newspaper"></i>
                        <p>Nenhuma notícia encontrada.</p>
                        <small>Publique sua primeira notícia usando o formulário acima.</small>
                    </div>
                `;
                return;
            }
            
            const noticiasHTML = noticiasFiltradas.map((noticia, index) => {
                const categoriaTexto = getCategoriaTexto(noticia.categoria);
                const tagsHTML = noticia.tags.map(tag => `<span class="tag-item">${tag}</span>`).join('');
                
                return `
                    <div class="noticia-card">
                        <div class="noticia-header">
                            <div class="noticia-info">
                                <h5>${noticia.titulo}</h5>
                                <div class="noticia-meta">
                                    <span class="categoria-badge ${noticia.categoria}">${categoriaTexto}</span>
                                    <span><i class="fas fa-calendar"></i> ${noticia.dataFormatada}</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="noticia-resumo">${noticia.resumo}</div>
                        
                        ${noticia.tags.length > 0 ? `
                            <div class="noticia-tags">${tagsHTML}</div>
                        ` : ''}
                        
                        <div class="noticia-actions">
                            <button class="btn-noticia btn-view-noticia" onclick="visualizarNoticia(${noticia.id})">
                                <i class="fas fa-eye"></i> Visualizar
                            </button>
                            <button class="btn-noticia btn-edit-noticia" onclick="editarNoticia(${noticia.id})">
                                <i class="fas fa-edit"></i> Editar
                            </button>
                            <button class="btn-noticia btn-delete-noticia" onclick="excluirNoticia(${noticia.id})">
                                <i class="fas fa-trash"></i> Excluir
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
            
            lista.innerHTML = noticiasHTML;
        }

        function getCategoriaTexto(categoria) {
            const categorias = {
                'health': 'Saúde',
                'education': 'Educação',
                'infrastructure': 'Infraestrutura',
                'sports': 'Esporte',
                'economy': 'Economia',
                'environment': 'Meio Ambiente',
                'security': 'Segurança'
            };
            return categorias[categoria] || categoria;
        }

        function filtrarNoticias() {
            carregarListaNoticias();
        }

        function visualizarNoticia(id) {
            const noticia = noticiasPublicadas.find(n => n.id === id);
            if (!noticia) return;
            
            const popup = window.open('', '_blank', 'width=800,height=600,scrollbars=yes');
            popup.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>${noticia.titulo}</title>
                    <style>
                        body { font-family: Inter, sans-serif; max-width: 700px; margin: 2rem auto; padding: 1rem; }
                        .header { border-bottom: 2px solid #1e40af; padding-bottom: 1rem; margin-bottom: 2rem; }
                        .titulo { color: #1e40af; font-size: 1.8rem; margin-bottom: 0.5rem; }
                        .meta { color: #666; font-size: 0.9rem; }
                        .categoria { background: #e0e7ff; color: #1e40af; padding: 0.25rem 0.75rem; border-radius: 1rem; }
                        .imagem { width: 100%; max-width: 500px; height: auto; margin: 1rem 0; border-radius: 8px; }
                        .conteudo { line-height: 1.6; font-size: 1rem; }
                        .tags { margin-top: 2rem; }
                        .tag { background: #f1f5f9; padding: 0.25rem 0.75rem; border-radius: 1rem; font-size: 0.8rem; margin-right: 0.5rem; }
                    </style>
                </head>
                <body>
                    <div class="header">
                        <h1 class="titulo">${noticia.titulo}</h1>
                        <div class="meta">
                            <span class="categoria">${getCategoriaTexto(noticia.categoria)}</span>
                            <span style="margin-left: 1rem;">${noticia.dataFormatada}</span>
                        </div>
                    </div>
                    ${noticia.imagem ? `<img src="${noticia.imagem}" alt="${noticia.titulo}" class="imagem">` : ''}
                    <div class="conteudo">
                        ${noticia.conteudo.replace(/\n/g, '<br>')}
                    </div>
                    ${noticia.tags.length > 0 ? `
                        <div class="tags">
                            <strong>Tags:</strong> 
                            ${noticia.tags.map(tag => `<span class="tag">${tag}</span>`).join('')}
                        </div>
                    ` : ''}
                </body>
                </html>
            `);
        }

        function editarNoticia(id) {
            const noticia = noticiasPublicadas.find(n => n.id === id);
            if (!noticia) return;
            
            document.getElementById('tituloNoticia').value = noticia.titulo;
            document.getElementById('categoriaNoticia').value = noticia.categoria;
            document.getElementById('resumoNoticia').value = noticia.resumo;
            document.getElementById('imagemNoticia').value = noticia.imagem;
            document.getElementById('conteudoNoticia').value = noticia.conteudo;
            document.getElementById('tagsNoticia').value = noticia.tags.join(', ');
            
            // Atualizar contador de caracteres
            document.querySelector('.char-counter').textContent = `${noticia.resumo.length}/200 caracteres`;
            
            // Remover notícia atual para substituição
            excluirNoticia(id);
            
            // Scroll para o formulário
            document.querySelector('.nova-noticia-form').scrollIntoView({ behavior: 'smooth' });
        }

        function excluirNoticia(id) {
            if (confirm('Tem certeza que deseja excluir esta notícia?')) {
                noticiasPublicadas = noticiasPublicadas.filter(n => n.id !== id);
                localStorage.setItem('noticiasPublicadas', JSON.stringify(noticiasPublicadas));
                
                // Atualizar site público
                atualizarNoticiasPublicas();
                
                carregarListaNoticias();
            }
        }

        function atualizarNoticiasPublicas() {
            // Esta função seria responsável por atualizar as notícias no site público
            // Em uma implementação real, seria integrada com o sistema de persistência
            console.log('Notícias atualizadas no site público');
        }

        // Contador de caracteres em tempo real
        document.addEventListener('DOMContentLoaded', function() {
            const resumoTextarea = document.getElementById('resumoNoticia');
            if (resumoTextarea) {
                resumoTextarea.addEventListener('input', function() {
                    const contador = document.querySelector('.char-counter');
                    const caracteres = this.value.length;
                    contador.textContent = `${caracteres}/200 caracteres`;
                    
                    if (caracteres > 180) {
                        contador.style.color = '#dc2626';
                    } else {
                        contador.style.color = '#6b7280';
                    }
                });
            }
        });

        // ===== FUNCIONALIDADES GERENCIAR CONTEÚDO =====

        let noticiasConteudo = JSON.parse(localStorage.getItem('noticiasConteudo') || '[]');

        function toggleFormularioNoticia() {
            const formulario = document.getElementById('formularioNoticia');
            const btn = document.getElementById('btnNovaNoticia');
            
            if (formulario.style.display === 'none') {
                formulario.style.display = 'block';
                btn.innerHTML = '<i class="fas fa-times"></i> Cancelar';
                btn.classList.add('btn-secondary');
                btn.classList.remove('btn-primary');
            } else {
                cancelarEdicao();
            }
        }

        function cancelarEdicao() {
            const formulario = document.getElementById('formularioNoticia');
            const btn = document.getElementById('btnNovaNoticia');
            const form = document.getElementById('formNoticiaConteudo');
            
            formulario.style.display = 'none';
            btn.innerHTML = '<i class="fas fa-plus"></i> Nova Notícia';
            btn.classList.remove('btn-secondary');
            btn.classList.add('btn-primary');
            
            form.reset();
            document.getElementById('textoNoticia').innerHTML = '';
            document.getElementById('noticiaEditandoId').value = '';
            atualizarContadorCaracteres();
        }

        function salvarNoticia(event) {
            event.preventDefault();
            
            const titulo = document.getElementById('tituloNoticiaConteudo').value;
            const imagem = document.getElementById('imagemNoticia').value;
            const video = document.getElementById('videoNoticia').value;
            const texto = document.getElementById('textoNoticia').innerHTML;
            const editandoId = document.getElementById('noticiaEditandoId').value;
            
            if (!titulo.trim() || !texto.trim()) {
                alert('Por favor, preencha o título e o texto da notícia.');
                return;
            }
            
            const novaNoticia = {
                id: editandoId || Date.now().toString(),
                titulo: titulo.trim(),
                imagem: imagem.trim() || 'https://via.placeholder.com/400x250/1e40af/ffffff?text=Notícia',
                video: extrairIdYoutube(video),
                texto: texto,
                data: new Date().toLocaleDateString('pt-BR'),
                dataCompleta: new Date().toISOString()
            };
            
            if (editandoId) {
                // Editar notícia existente
                const index = noticiasConteudo.findIndex(n => n.id === editandoId);
                if (index !== -1) {
                    noticiasConteudo[index] = novaNoticia;
                }
            } else {
                // Adicionar nova notícia
                noticiasConteudo.unshift(novaNoticia);
            }
            
            localStorage.setItem('noticiasConteudo', JSON.stringify(noticiasConteudo));
            atualizarListaNoticias();
            atualizarNoticiasIndexPrincipal();
            cancelarEdicao();
            
            alert(editandoId ? 'Notícia atualizada com sucesso!' : 'Notícia criada com sucesso!');
        }

        function extrairIdYoutube(url) {
            if (!url) return '';
            
            const regex = /(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/)([^&\n?#]+)/;
            const match = url.match(regex);
            return match ? match[1] : '';
        }

        function atualizarListaNoticias() {
            const tbody = document.getElementById('corpoTabelaNoticias');
            const estadoVazio = document.getElementById('estadoVazioNoticias');
            const tabela = document.getElementById('tabelaNoticias');
            
            if (noticiasConteudo.length === 0) {
                tabela.style.display = 'none';
                estadoVazio.style.display = 'block';
                return;
            }
            
            tabela.style.display = 'table';
            estadoVazio.style.display = 'none';
            
            tbody.innerHTML = noticiasConteudo.map(noticia => `
                <tr>
                    <td>
                        <img src="${noticia.imagem}" alt="Imagem da notícia" 
                             onerror="this.src='https://via.placeholder.com/60x40/1e40af/ffffff?text=IMG'">
                    </td>
                    <td>
                        <div class="noticia-titulo">${noticia.titulo}</div>
                        ${noticia.video ? '<small><i class="fab fa-youtube text-red-500"></i> Com vídeo</small>' : ''}
                    </td>
                    <td>
                        <div class="noticia-data">${noticia.data}</div>
                    </td>
                    <td>
                        <div class="acoes-noticia">
                            <button class="btn-acao btn-editar" onclick="editarNoticiaConteudo('${noticia.id}')">
                                <i class="fas fa-edit"></i>
                                Editar
                            </button>
                            <button class="btn-acao btn-excluir" onclick="excluirNoticiaConteudo('${noticia.id}')">
                                <i class="fas fa-trash"></i>
                                Excluir
                            </button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        function editarNoticiaConteudo(id) {
            const noticia = noticiasConteudo.find(n => n.id === id);
            if (!noticia) return;
            
            document.getElementById('tituloNoticiaConteudo').value = noticia.titulo;
            document.getElementById('imagemNoticia').value = noticia.imagem !== 'https://via.placeholder.com/400x250/1e40af/ffffff?text=Notícia' ? noticia.imagem : '';
            document.getElementById('videoNoticia').value = noticia.video ? `https://www.youtube.com/watch?v=${noticia.video}` : '';
            document.getElementById('textoNoticia').innerHTML = noticia.texto;
            document.getElementById('noticiaEditandoId').value = id;
            
            // Mostrar formulário
            const formulario = document.getElementById('formularioNoticia');
            const btn = document.getElementById('btnNovaNoticia');
            
            formulario.style.display = 'block';
            btn.innerHTML = '<i class="fas fa-times"></i> Cancelar';
            btn.classList.add('btn-secondary');
            btn.classList.remove('btn-primary');
            
            atualizarContadorCaracteres();
            
            // Scroll para o formulário
            formulario.scrollIntoView({ behavior: 'smooth' });
        }

        function excluirNoticiaConteudo(id) {
            if (confirm('Tem certeza que deseja excluir esta notícia?')) {
                noticiasConteudo = noticiasConteudo.filter(n => n.id !== id);
                localStorage.setItem('noticiasConteudo', JSON.stringify(noticiasConteudo));
                atualizarListaNoticias();
                atualizarNoticiasIndexPrincipal();
                alert('Notícia excluída com sucesso!');
            }
        }

        function filtrarNoticiasConteudo() {
            const filtro = document.getElementById('filtroStatusNoticia').value;
            let noticiasFiltradas = [...noticiasConteudo];
            
            if (filtro === 'recente') {
                noticiasFiltradas.sort((a, b) => new Date(b.dataCompleta) - new Date(a.dataCompleta));
            } else if (filtro === 'antiga') {
                noticiasFiltradas.sort((a, b) => new Date(a.dataCompleta) - new Date(b.dataCompleta));
            }
            
            const tbody = document.getElementById('corpoTabelaNoticias');
            tbody.innerHTML = noticiasFiltradas.map(noticia => `
                <tr>
                    <td>
                        <img src="${noticia.imagem}" alt="Imagem da notícia" 
                             onerror="this.src='https://via.placeholder.com/60x40/1e40af/ffffff?text=IMG'">
                    </td>
                    <td>
                        <div class="noticia-titulo">${noticia.titulo}</div>
                        ${noticia.video ? '<small><i class="fab fa-youtube text-red-500"></i> Com vídeo</small>' : ''}
                    </td>
                    <td>
                        <div class="noticia-data">${noticia.data}</div>
                    </td>
                    <td>
                        <div class="acoes-noticia">
                            <button class="btn-acao btn-editar" onclick="editarNoticiaConteudo('${noticia.id}')">
                                <i class="fas fa-edit"></i>
                                Editar
                            </button>
                            <button class="btn-acao btn-excluir" onclick="excluirNoticiaConteudo('${noticia.id}')">
                                <i class="fas fa-trash"></i>
                                Excluir
                            </button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        // Editor de texto funcionalidades
        function formatText(command) {
            document.execCommand(command, false, null);
            atualizarContadorCaracteres();
        }

        function insertList() {
            document.execCommand('insertUnorderedList', false, null);
            atualizarContadorCaracteres();
        }

        function atualizarContadorCaracteres() {
            const editor = document.getElementById('textoNoticia');
            const contador = document.querySelector('.char-counter-conteudo');
            
            if (editor && contador) {
                const texto = editor.textContent || editor.innerText || '';
                contador.textContent = `${texto.length} caracteres`;
                
                if (texto.length > 1000) {
                    contador.style.color = '#dc2626';
                } else {
                    contador.style.color = '#6b7280';
                }
            }
        }

        // Evento para atualizar contador de caracteres
        document.addEventListener('DOMContentLoaded', function() {
            const editor = document.getElementById('textoNoticia');
            if (editor) {
                editor.addEventListener('input', atualizarContadorCaracteres);
                editor.addEventListener('keyup', atualizarContadorCaracteres);
            }
        });

        function atualizarNoticiasIndexPrincipal() {
            // Esta função pode ser expandida para sincronizar com o index.html
            console.log('Notícias atualizadas no painel administrativo');
        }

        // Carregar notícias quando a seção é ativada
        function carregarGerenciarConteudo() {
            atualizarListaNoticias();
        }

        // Adicionar ao observador de seções
        const observerConteudo = new MutationObserver(function(mutations) {
            mutations.forEach(function(mutation) {
                if (mutation.type === 'attributes' && mutation.attributeName === 'class') {
                    const target = mutation.target;
                    if (target.classList.contains('active') && target.id === 'gerenciar-conteudo') {
                        carregarGerenciarConteudo();
                    }
                }
            });
        });

        // Observar mudanças nas seções
        document.addEventListener('DOMContentLoaded', function() {
            const sections = document.querySelectorAll('.panel-section');
            sections.forEach(section => {
                observerConteudo.observe(section, { attributes: true });
            });
        });
    </script>
    


    <!-- EmailJS Library -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
    <script type="text/javascript">
        // Inicializar EmailJS com credenciais reais
        (function(){
            emailjs.init("ypFrla8Fz7VXnIRPY"); // Public Key real
        })();
    </script>
    
    <!-- Chart.js para gráficos -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- jsPDF para exportação PDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    
    <!-- FileSaver.js para download de arquivos -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

    <script>
        // ===== SISTEMA "ESTE MANDATO É SEU" =====
        
        function openMandatoModal() {
            document.getElementById('mandatoModal').classList.add('active');
        }

        function closeMandatoModal() {
            document.getElementById('mandatoModal').classList.remove('active');
        }

        function switchMandatoTab(tabName) {
            // Remove active das tabs
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            // Ativa tab atual
            event.target.classList.add('active');
            document.getElementById(tabName + 'Tab').classList.add('active');
        }

        // Envio de sugestões via EmailJS
        document.getElementById('sugestoesForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const btn = document.getElementById('enviarSugestaoBtn');
            btn.disabled = true;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Enviando...';
            
            const formData = {
                nome: document.getElementById('nomeCompleto').value,
                email: document.getElementById('emailContato').value,
                telefone: document.getElementById('telefoneContato').value,
                tipo: document.getElementById('tipoSugestao').value,
                assunto: document.getElementById('assuntoSugestao').value,
                mensagem: document.getElementById('mensagemSugestao').value,
                bairro: document.getElementById('bairroSugestao').value,
                data: new Date().toLocaleDateString('pt-BR'),
                hora: new Date().toLocaleTimeString('pt-BR')
            };

            // Salvar localmente
            let sugestoes = JSON.parse(localStorage.getItem('sugestoes') || '[]');
            sugestoes.push({
                id: Date.now(),
                ...formData,
                status: 'nova'
            });
            localStorage.setItem('sugestoes', JSON.stringify(sugestoes));

            // Enviar por email
            emailjs.send('service_8vh6tqp', 'template_qm0spnj', {
                to_email: 'gabinete.emicleiton@gmail.com',
                from_name: formData.nome,
                from_email: formData.email,
                phone: formData.telefone,
                type: formData.tipo,
                subject: formData.assunto,
                message: formData.mensagem,
                district: formData.bairro,
                date: formData.data,
                time: formData.hora
            }).then(function(response) {
                btn.innerHTML = '<i class="fas fa-check"></i> Enviado com Sucesso!';
                btn.style.background = 'linear-gradient(135deg, #10b981, #059669)';
                
                // Reset form
                document.getElementById('sugestoesForm').reset();
                
                setTimeout(() => {
                    btn.disabled = false;
                    btn.innerHTML = '<i class="fas fa-paper-plane"></i> Enviar Sugestão';
                    btn.style.background = '';
                    closeMandatoModal();
                }, 2000);
                
            }, function(error) {
                console.error('Erro ao enviar:', error);
                btn.innerHTML = '<i class="fas fa-exclamation-triangle"></i> Erro ao enviar';
                btn.style.background = 'linear-gradient(135deg, #ef4444, #dc2626)';
                
                setTimeout(() => {
                    btn.disabled = false;
                    btn.innerHTML = '<i class="fas fa-paper-plane"></i> Enviar Sugestão';
                    btn.style.background = '';
                }, 3000);
            });
        });

        // ===== ASSISTENTE INTELIGENTE =====
        
        function sendMandatoMessage() {
            const input = document.getElementById('chatMandatoInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            addMandatoUserMessage(message);
            input.value = '';
            
            // Simular resposta do bot
            setTimeout(() => {
                const response = generateMandatoBotResponse(message);
                addMandatoBotMessage(response);
            }, 1000);
        }

        function handleMandatoChatEnter(event) {
            if (event.key === 'Enter') {
                sendMandatoMessage();
            }
        }

        function sendQuickSuggestion(message) {
            addMandatoUserMessage(message);
            
            setTimeout(() => {
                const response = generateMandatoBotResponse(message);
                addMandatoBotMessage(response);
            }, 1000);
        }

        function addMandatoUserMessage(message) {
            const messagesContainer = document.getElementById('chatMandatoMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'user-message';
            messageDiv.innerHTML = `
                <div class="message-avatar">
                    <i class="fas fa-user"></i>
                </div>
                <div class="message-content">
                    <p>${message}</p>
                </div>
            `;
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function addMandatoBotMessage(message) {
            const messagesContainer = document.getElementById('chatMandatoMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'bot-message';
            messageDiv.innerHTML = `
                <div class="message-avatar">
                    <i class="fas fa-robot"></i>
                </div>
                <div class="message-content">
                    <p>${message}</p>
                </div>
            `;
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function generateMandatoBotResponse(userMessage) {
            const msg = userMessage.toLowerCase();
            
            if (msg.includes('denunciar') || msg.includes('denuncia') || msg.includes('problema')) {
                return 'Para denunciar problemas na cidade, você pode usar o formulário de sugestões aqui mesmo! Selecione "Denúncia" como tipo e descreva detalhadamente o problema. Também pode ligar para a Ouvidoria: (75) 3276-2234.';
            }
            
            if (msg.includes('projeto') || msg.includes('andamento')) {
                return 'Atualmente temos vários projetos em andamento: Reforma da Praça Central, Programa de Melhorias nas Escolas, e Pavimentação de Ruas. Você pode acompanhar o progresso na seção "Projetos" do nosso site.';
            }
            
            if (msg.includes('acompanhar') || msg.includes('solicitação')) {
                return 'Para acompanhar sua solicitação, anote o número do protocolo que será enviado por email após o envio. Você também pode entrar em contato pelo WhatsApp (75) 99999-9999 informando seu protocolo.';
            }
            
            if (msg.includes('horário') || msg.includes('atendimento')) {
                return 'O gabinete funciona de segunda a sexta, das 8h às 17h. Para agendamentos, ligue: (75) 3276-2234. Atendimentos urgentes podem ser feitos pelo WhatsApp.';
            }
            
            if (msg.includes('saúde')) {
                return 'Para questões de saúde, estamos trabalhando na melhoria do Posto de Saúde Central e ampliação dos serviços. Emergências devem ser direcionadas ao hospital municipal: (75) 3276-1234.';
            }
            
            if (msg.includes('educação') || msg.includes('escola')) {
                return 'Na educação, estamos implementando melhorias na infraestrutura das escolas e programa de capacitação de professores. Para questões específicas sobre matrícula, contate a Secretaria de Educação: (75) 3276-5678.';
            }
            
            if (msg.includes('transporte') || msg.includes('estrada') || msg.includes('rua')) {
                return 'Estamos trabalhando na pavimentação de várias ruas e melhoria das estradas rurais. Para reportar problemas específicos com buracos ou má sinalização, use o formulário de denúncia.';
            }
            
            if (msg.includes('agua') || msg.includes('água') || msg.includes('saneamento')) {
                return 'Questões de abastecimento de água devem ser reportadas à EMBASA: 0800 0555 195. Para problemas de esgoto ou saneamento na zona rural, use nosso formulário de sugestões.';
            }
            
            if (msg.includes('luz') || msg.includes('energia')) {
                return 'Para problemas com energia elétrica, contate a COELBA: 116. Se for questão de iluminação pública, pode reportar através do nosso formulário que encaminharemos ao setor responsável.';
            }
            
            return 'Obrigado pela sua mensagem! Para questões mais específicas, recomendo usar o formulário de sugestões onde você pode detalhar melhor sua solicitação. Nossa equipe analisará e dará retorno em até 48 horas.';
        }

        // Fechar modal clicando fora
        document.getElementById('mandatoModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeMandatoModal();
            }
        });

        // Fechar modal com ESC
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeMandatoModal();
            }
        });

        // ===== SISTEMA DE GERENCIAMENTO DE CONTEÚDO =====

        // Dados globais para o sistema de conteúdo
        let conteudoSite = {
            titulo: 'Gabinete Digital',
            subtitulo: 'Emicleiton Rubem da Conceição',
            cidade: 'Monte Santo - BA',
            slogan: 'Trabalhando com transparência e dedicação pelo futuro da nossa cidade',
            whatsapp: '75999999999',
            textoInstitucional: 'Gabinete comprometido com a transparência e desenvolvimento de Monte Santo',
            telefoneContato: '(75) 3276-2234',
            emailContato: 'contato@gabinete.com'
        };

        let projetosGerenciados = JSON.parse(localStorage.getItem('projetosGerenciados') || '[]');
        let noticiasGerenciadas = JSON.parse(localStorage.getItem('noticiasGerenciadas') || '[]');
        let galeriaGerenciada = JSON.parse(localStorage.getItem('galeriaGerenciada') || '[]');

        // ===== FUNÇÕES PARA GERENCIAMENTO DE CONTEÚDO DO SITE =====

        function carregarConteudoSite() {
            const conteudoSalvo = localStorage.getItem('conteudoSite');
            if (conteudoSalvo) {
                conteudoSite = { ...conteudoSite, ...JSON.parse(conteudoSalvo) };
            }

            // Preencher formulários
            document.getElementById('tituloSite').value = conteudoSite.titulo || '';
            document.getElementById('subtituloSite').value = conteudoSite.subtitulo || '';
            document.getElementById('cidadeSite').value = conteudoSite.cidade || '';
            document.getElementById('sloganPrincipal').value = conteudoSite.slogan || '';
            document.getElementById('whatsappNumero').value = conteudoSite.whatsapp || '';
            document.getElementById('textoInstitucional').value = conteudoSite.textoInstitucional || '';
            document.getElementById('telefoneContato').value = conteudoSite.telefoneContato || '';
            document.getElementById('emailContato').value = conteudoSite.emailContato || '';
        }

        function salvarConteudoSite() {
            // Coletar dados do formulário
            conteudoSite = {
                titulo: document.getElementById('tituloSite').value,
                subtitulo: document.getElementById('subtituloSite').value,
                cidade: document.getElementById('cidadeSite').value,
                slogan: document.getElementById('sloganPrincipal').value,
                whatsapp: document.getElementById('whatsappNumero').value,
                textoInstitucional: document.getElementById('textoInstitucional').value,
                telefoneContato: document.getElementById('telefoneContato').value,
                emailContato: document.getElementById('emailContato').value
            };

            // Salvar no localStorage
            localStorage.setItem('conteudoSite', JSON.stringify(conteudoSite));

            // Aplicar mudanças no site público (simulação)
            aplicarMudancasSitePublico();

            alert('Conteúdo do site atualizado com sucesso!');
        }

        function aplicarMudancasSitePublico() {
            // Esta função simula a aplicação das mudanças no site público
            // Em um ambiente real, isto seria feito via API para atualizar o site dinamicamente
            console.log('Aplicando mudanças no site público:', conteudoSite);
        }

        // ===== FUNÇÕES PARA GERENCIAMENTO DE PROJETOS =====

        function adicionarProjeto(event) {
            event.preventDefault();

            const projeto = {
                id: Date.now(),
                titulo: document.getElementById('tituloProjeto').value,
                status: document.getElementById('statusProjeto').value,
                numero: document.getElementById('numeroProjeto').value,
                data: document.getElementById('dataProjeto').value,
                descricao: document.getElementById('descricaoProjeto').value,
                dataInclusao: new Date().toISOString()
            };

            projetosGerenciados.unshift(projeto);
            localStorage.setItem('projetosGerenciados', JSON.stringify(projetosGerenciados));

            limparFormularioProjeto();
            carregarListaProjetos();
            atualizarProjetosSitePublico();

            alert('Projeto adicionado com sucesso!');
        }

        function limparFormularioProjeto() {
            document.getElementById('formProjeto').reset();
            document.querySelector('#descricaoProjeto').dispatchEvent(new Event('input'));
        }

        function carregarListaProjetos() {
            const lista = document.getElementById('listaProjetos');
            const filtroStatus = document.getElementById('filtroStatusProjetos').value;

            let projetosFiltrados = projetosGerenciados;
            if (filtroStatus) {
                projetosFiltrados = projetosGerenciados.filter(p => p.status === filtroStatus);
            }

            if (projetosFiltrados.length === 0) {
                lista.innerHTML = `
                    <div class="lista-vazia">
                        <i class="fas fa-lightbulb"></i>
                        <p>Nenhum projeto encontrado.</p>
                        <small>Adicione projetos usando o formulário acima.</small>
                    </div>
                `;
                return;
            }

            const projetosHTML = projetosFiltrados.map(projeto => `
                <div class="projeto-item">
                    <div class="item-header">
                        <div>
                            <div class="item-titulo">${projeto.titulo}</div>
                            <div class="item-meta">
                                <span><i class="fas fa-calendar"></i> ${new Date(projeto.data).toLocaleDateString('pt-BR')}</span>
                                <span><i class="fas fa-file"></i> ${projeto.numero}</span>
                            </div>
                        </div>
                        <div class="item-status status-${projeto.status}">${getStatusTexto(projeto.status)}</div>
                    </div>
                    <div class="item-descricao">${projeto.descricao}</div>
                    <div class="item-acoes">
                        <button class="btn-item edit" onclick="editarProjeto(${projeto.id})">
                            <i class="fas fa-edit"></i> Editar
                        </button>
                        <button class="btn-item delete" onclick="excluirProjeto(${projeto.id})">
                            <i class="fas fa-trash"></i> Excluir
                        </button>
                    </div>
                </div>
            `).join('');

            lista.innerHTML = projetosHTML;
        }

        function getStatusTexto(status) {
            const statusMap = {
                'aprovado': 'Aprovado',
                'andamento': 'Em Andamento',
                'rejeitado': 'Rejeitado',
                'estudo': 'Em Estudo'
            };
            return statusMap[status] || status;
        }

        function filtrarProjetos() {
            carregarListaProjetos();
        }

        function editarProjeto(id) {
            const projeto = projetosGerenciados.find(p => p.id === id);
            if (projeto) {
                document.getElementById('tituloProjeto').value = projeto.titulo;
                document.getElementById('statusProjeto').value = projeto.status;
                document.getElementById('numeroProjeto').value = projeto.numero;
                document.getElementById('dataProjeto').value = projeto.data;
                document.getElementById('descricaoProjeto').value = projeto.descricao;
                
                // Remover projeto atual e permitir reedição
                excluirProjeto(id, false);
            }
        }

        function excluirProjeto(id, confirmar = true) {
            if (confirmar && !confirm('Tem certeza que deseja excluir este projeto?')) {
                return;
            }

            projetosGerenciados = projetosGerenciados.filter(p => p.id !== id);
            localStorage.setItem('projetosGerenciados', JSON.stringify(projetosGerenciados));
            carregarListaProjetos();
            atualizarProjetosSitePublico();

            if (confirmar) {
                alert('Projeto excluído com sucesso!');
            }
        }

        function atualizarProjetosSitePublico() {
            // Simula atualização da seção de projetos no site público
            console.log('Atualizando projetos no site público:', projetosGerenciados);
        }

        // ===== FUNÇÕES PARA GERENCIAMENTO DE NOTÍCIAS =====

        function publicarNoticiaAdmin(event) {
            event.preventDefault();

            const noticia = {
                id: Date.now(),
                titulo: document.getElementById('tituloNoticiaAdmin').value,
                categoria: document.getElementById('categoriaNoticiaAdmin').value,
                conteudo: document.getElementById('conteudoNoticiaAdmin').value,
                data: new Date().toISOString(),
                dataFormatada: new Date().toLocaleDateString('pt-BR', {
                    day: '2-digit',
                    month: 'long',
                    year: 'numeric'
                })
            };

            noticiasGerenciadas.unshift(noticia);
            localStorage.setItem('noticiasGerenciadas', JSON.stringify(noticiasGerenciadas));

            limparFormularioNoticiaAdmin();
            carregarListaNoticiasAdmin();
            atualizarNoticiasSitePublico();

            alert('Notícia publicada com sucesso!');
        }

        function limparFormularioNoticiaAdmin() {
            document.getElementById('formNoticiaAdmin').reset();
            document.querySelector('#conteudoNoticiaAdmin').dispatchEvent(new Event('input'));
        }

        function carregarListaNoticiasAdmin() {
            const lista = document.getElementById('listaNoticiasAdmin');

            if (noticiasGerenciadas.length === 0) {
                lista.innerHTML = `
                    <div class="lista-vazia">
                        <i class="fas fa-newspaper"></i>
                        <p>Nenhuma notícia publicada.</p>
                        <small>Publique sua primeira notícia usando o formulário acima.</small>
                    </div>
                `;
                return;
            }

            const noticiasHTML = noticiasGerenciadas.map(noticia => `
                <div class="noticia-item">
                    <div class="item-header">
                        <div>
                            <div class="item-titulo">${noticia.titulo}</div>
                            <div class="item-meta">
                                <span><i class="fas fa-calendar"></i> ${noticia.dataFormatada}</span>
                                <span><i class="fas fa-tag"></i> ${getCategoriaTexto(noticia.categoria)}</span>
                            </div>
                        </div>
                    </div>
                    <div class="item-descricao">${noticia.conteudo.substring(0, 200)}${noticia.conteudo.length > 200 ? '...' : ''}</div>
                    <div class="item-acoes">
                        <button class="btn-item edit" onclick="editarNoticia(${noticia.id})">
                            <i class="fas fa-edit"></i> Editar
                        </button>
                        <button class="btn-item delete" onclick="excluirNoticia(${noticia.id})">
                            <i class="fas fa-trash"></i> Excluir
                        </button>
                    </div>
                </div>
            `).join('');

            lista.innerHTML = noticiasHTML;
        }

        function getCategoriaTexto(categoria) {
            const categoriaMap = {
                'politica': 'Política',
                'saude': 'Saúde',
                'educacao': 'Educação',
                'infraestrutura': 'Infraestrutura',
                'social': 'Social',
                'eventos': 'Eventos'
            };
            return categoriaMap[categoria] || categoria;
        }

        function editarNoticia(id) {
            const noticia = noticiasGerenciadas.find(n => n.id === id);
            if (noticia) {
                document.getElementById('tituloNoticiaAdmin').value = noticia.titulo;
                document.getElementById('categoriaNoticiaAdmin').value = noticia.categoria;
                document.getElementById('conteudoNoticiaAdmin').value = noticia.conteudo;
                
                excluirNoticia(id, false);
            }
        }

        function excluirNoticia(id, confirmar = true) {
            if (confirmar && !confirm('Tem certeza que deseja excluir esta notícia?')) {
                return;
            }

            noticiasGerenciadas = noticiasGerenciadas.filter(n => n.id !== id);
            localStorage.setItem('noticiasGerenciadas', JSON.stringify(noticiasGerenciadas));
            carregarListaNoticiasAdmin();
            atualizarNoticiasSitePublico();

            if (confirmar) {
                alert('Notícia excluída com sucesso!');
            }
        }

        function atualizarNoticiasSitePublico() {
            console.log('Atualizando notícias no site público:', noticiasGerenciadas);
        }

        // ===== FUNÇÕES PARA GERENCIAMENTO DE GALERIA =====

        function alterarTipoMidia() {
            const tipo = document.getElementById('tipoMidia').value;
            const uploadFoto = document.getElementById('uploadFoto');
            const uploadVideo = document.getElementById('uploadVideo');

            uploadFoto.style.display = tipo === 'foto' ? 'block' : 'none';
            uploadVideo.style.display = tipo === 'video' ? 'block' : 'none';
        }

        function adicionarMidia(event) {
            event.preventDefault();

            const tipo = document.getElementById('tipoMidia').value;
            const titulo = document.getElementById('tituloMidia').value;
            let url = '';

            if (tipo === 'foto') {
                url = document.getElementById('urlFoto').value;
            } else if (tipo === 'video') {
                url = document.getElementById('urlVideo').value;
            }

            if (!url) {
                alert('Por favor, insira a URL da mídia.');
                return;
            }

            const midia = {
                id: Date.now(),
                tipo,
                titulo,
                url,
                dataInclusao: new Date().toISOString()
            };

            galeriaGerenciada.unshift(midia);
            localStorage.setItem('galeriaGerenciada', JSON.stringify(galeriaGerenciada));

            limparFormularioMidia();
            carregarListaGaleria();
            atualizarGaleriaSitePublico();

            alert('Mídia adicionada à galeria com sucesso!');
        }

        function limparFormularioMidia() {
            document.getElementById('formMidia').reset();
            alterarTipoMidia();
        }

        function carregarListaGaleria() {
            const lista = document.getElementById('listaGaleria');
            const filtroTipo = document.getElementById('filtroTipoMidia').value;

            let midiasFiltradas = galeriaGerenciada;
            if (filtroTipo) {
                midiasFiltradas = galeriaGerenciada.filter(m => m.tipo === filtroTipo);
            }

            if (midiasFiltradas.length === 0) {
                lista.innerHTML = `
                    <div class="lista-vazia">
                        <i class="fas fa-images"></i>
                        <p>Nenhuma mídia na galeria.</p>
                        <small>Adicione fotos e vídeos usando o formulário acima.</small>
                    </div>
                `;
                return;
            }

            const midiasHTML = midiasFiltradas.map(midia => `
                <div class="galeria-item">
                    ${midia.tipo === 'foto' ? 
                        `<img src="${midia.url}" alt="${midia.titulo}" class="galeria-thumb" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjEyMCIgdmlld0JveD0iMCAwIDIwMCAxMjAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMTIwIiBmaWxsPSIjRjNGNEY2Ii8+Cjx0ZXh0IHg9IjEwMCIgeT0iNjAiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzY5NzA3NyIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPkltYWdlbSBOw6NvIEVuY29udHJhZGE8L3RleHQ+Cjwvc3ZnPg=='">`
                        : `<div class="galeria-thumb" style="background: linear-gradient(135deg, #ef4444, #dc2626); display: flex; align-items: center; justify-content: center; color: white; font-size: 2rem;"><i class="fab fa-youtube"></i></div>`
                    }
                    <div class="galeria-info">
                        <div class="galeria-titulo">${midia.titulo}</div>
                        <div class="galeria-tipo">${midia.tipo}</div>
                        <div class="galeria-acoes">
                            <button class="btn-galeria edit" onclick="editarMidia(${midia.id})">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn-galeria delete" onclick="excluirMidia(${midia.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');

            lista.innerHTML = midiasHTML;
        }

        function filtrarGaleria() {
            carregarListaGaleria();
        }

        function editarMidia(id) {
            const midia = galeriaGerenciada.find(m => m.id === id);
            if (midia) {
                document.getElementById('tipoMidia').value = midia.tipo;
                document.getElementById('tituloMidia').value = midia.titulo;
                
                alterarTipoMidia();
                
                if (midia.tipo === 'foto') {
                    document.getElementById('urlFoto').value = midia.url;
                } else {
                    document.getElementById('urlVideo').value = midia.url;
                }
                
                excluirMidia(id, false);
            }
        }

        function excluirMidia(id, confirmar = true) {
            if (confirmar && !confirm('Tem certeza que deseja excluir esta mídia?')) {
                return;
            }

            galeriaGerenciada = galeriaGerenciada.filter(m => m.id !== id);
            localStorage.setItem('galeriaGerenciada', JSON.stringify(galeriaGerenciada));
            carregarListaGaleria();
            atualizarGaleriaSitePublico();

            if (confirmar) {
                alert('Mídia excluída com sucesso!');
            }
        }

        function atualizarGaleriaSitePublico() {
            console.log('Atualizando galeria no site público:', galeriaGerenciada);
        }

        // ===== CONTADORES DE CARACTERES =====

        // Adicionar contadores de caracteres para textareas
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(() => {
                const textareas = document.querySelectorAll('textarea[maxlength]');
                textareas.forEach(textarea => {
                    const counter = textarea.nextElementSibling;
                    if (counter && counter.classList.contains('char-counter')) {
                        textarea.addEventListener('input', function() {
                            const current = this.value.length;
                            const max = this.getAttribute('maxlength');
                            counter.textContent = `${current}/${max} caracteres`;
                            
                            if (current > max * 0.9) {
                                counter.style.color = '#dc2626';
                            } else if (current > max * 0.7) {
                                counter.style.color = '#f59e0b';
                            } else {
                                counter.style.color = '#6b7280';
                            }
                        });
                    }
                });

                // Carregar dados iniciais
                carregarConteudoSite();
                carregarListaProjetos();
                carregarListaNoticiasAdmin();
                carregarListaGaleria();
            }, 1000);
        });
        // ===== SISTEMA DE CONFIGURAÇÕES =====
        
        // Configurações padrão do sistema
        const CONFIG_PADRAO = {
            "vereador": {
                "nome": "Emicleiton Rubem da Conceição",
                "cargo": "Vereador de Monte Santo - BA"
            },
            "mandato": {
                "periodo": "2021 - 2024",
                "status": "Em Exercício",
                "statusClass": "ativo"
            },
            "estatisticas": {
                "anosMandato": "3",
                "projetosAtivos": "42",
                "cidadaosAtendidos": "1,247",
                "satisfacao": "95%"
            },
            "painel": {
                "titulo": "Painel Administrativo",
                "subtitulo": "Sistema completo de gestão do gabinete digital • Bem-vindo, vereador Emicleiton!",
                "boasVindas": "Bem-vindo, vereador Emicleiton!"
            },
            "cardsInformativos": {
                "eleitoresCadastrados": "1,247",
                "projetosAndamento": "42",
                "eventosPrevistos": "8",
                "mensagensRecebidas": "89"
            }
        };

        // Funções de gerenciamento de configurações
        function carregarConfiguracoes() {
            const config = JSON.parse(localStorage.getItem('painelConfig')) || CONFIG_PADRAO;
            
            // Preencher campos do formulário se existirem
            const campos = [
                ['vereadorNome', config.vereador.nome],
                ['vereadorCargo', config.vereador.cargo],
                ['mandatoPeriodo', config.mandato.periodo],
                ['mandatoStatus', config.mandato.status],
                ['statAnosMandato', config.estatisticas.anosMandato],
                ['statProjetosAtivos', config.estatisticas.projetosAtivos],
                ['statCidadaosAtendidos', config.estatisticas.cidadaosAtendidos],
                ['statSatisfacao', config.estatisticas.satisfacao],
                ['painelTitulo', config.painel.titulo],
                ['painelSubtitulo', config.painel.subtitulo],
                ['cardEleitores', config.cardsInformativos.eleitoresCadastrados],
                ['cardProjetos', config.cardsInformativos.projetosAndamento],
                ['cardEventos', config.cardsInformativos.eventosPrevistos],
                ['cardMensagens', config.cardsInformativos.mensagensRecebidas]
            ];
            
            campos.forEach(([id, valor]) => {
                const elemento = document.getElementById(id);
                if (elemento) elemento.value = valor;
            });
            
            aplicarConfiguracoes(config);
        }

        function salvarConfiguracoes() {
            const config = {
                vereador: {
                    nome: document.getElementById('vereadorNome')?.value || CONFIG_PADRAO.vereador.nome,
                    cargo: document.getElementById('vereadorCargo')?.value || CONFIG_PADRAO.vereador.cargo
                },
                mandato: {
                    periodo: document.getElementById('mandatoPeriodo')?.value || CONFIG_PADRAO.mandato.periodo,
                    status: document.getElementById('mandatoStatus')?.value || CONFIG_PADRAO.mandato.status,
                    statusClass: "ativo"
                },
                estatisticas: {
                    anosMandato: document.getElementById('statAnosMandato')?.value || CONFIG_PADRAO.estatisticas.anosMandato,
                    projetosAtivos: document.getElementById('statProjetosAtivos')?.value || CONFIG_PADRAO.estatisticas.projetosAtivos,
                    cidadaosAtendidos: document.getElementById('statCidadaosAtendidos')?.value || CONFIG_PADRAO.estatisticas.cidadaosAtendidos,
                    satisfacao: document.getElementById('statSatisfacao')?.value || CONFIG_PADRAO.estatisticas.satisfacao
                },
                painel: {
                    titulo: document.getElementById('painelTitulo')?.value || CONFIG_PADRAO.painel.titulo,
                    subtitulo: document.getElementById('painelSubtitulo')?.value || CONFIG_PADRAO.painel.subtitulo
                },
                cardsInformativos: {
                    eleitoresCadastrados: document.getElementById('cardEleitores')?.value || CONFIG_PADRAO.cardsInformativos.eleitoresCadastrados,
                    projetosAndamento: document.getElementById('cardProjetos')?.value || CONFIG_PADRAO.cardsInformativos.projetosAndamento,
                    eventosPrevistos: document.getElementById('cardEventos')?.value || CONFIG_PADRAO.cardsInformativos.eventosPrevistos,
                    mensagensRecebidas: document.getElementById('cardMensagens')?.value || CONFIG_PADRAO.cardsInformativos.mensagensRecebidas
                }
            };
            
            localStorage.setItem('painelConfig', JSON.stringify(config));
            aplicarConfiguracoes(config);
            
            alert('Configurações salvas com sucesso!');
        }

        function aplicarConfiguracoes(config) {
            // Atualizar header
            const brandText = document.querySelector('.brand-text h1');
            const brandSubtext = document.querySelector('.brand-text p');
            if (brandText) brandText.textContent = config.vereador.nome;
            if (brandSubtext) brandSubtext.textContent = config.vereador.cargo;
            
            // Atualizar seção principal
            const sectionTitle = document.querySelector('.section-title');
            const sectionSubtitle = document.querySelector('.section-subtitle');
            if (sectionTitle) {
                const icon = sectionTitle.querySelector('i');
                if (icon) {
                    // Limpar conteúdo e manter apenas o ícone + título
                    sectionTitle.innerHTML = '';
                    sectionTitle.appendChild(icon);
                    sectionTitle.appendChild(document.createTextNode(' ' + config.painel.titulo));
                }
            }
            if (sectionSubtitle) sectionSubtitle.textContent = config.painel.subtitulo;
            
            // Atualizar card do mandato
            const mandatoInfo = document.querySelector('.mandato-info p');
            if (mandatoInfo) mandatoInfo.textContent = config.mandato.periodo;
            
            const statusBadge = document.querySelector('.status-badge');
            if (statusBadge) statusBadge.textContent = config.mandato.status;
            
            // Atualizar estatísticas do mandato
            const statNumbers = document.querySelectorAll('.stat-number');
            if (statNumbers.length >= 4) {
                statNumbers[0].textContent = config.estatisticas.anosMandato;
                statNumbers[1].textContent = config.estatisticas.projetosAtivos;
                statNumbers[2].textContent = config.estatisticas.cidadaosAtendidos;
                statNumbers[3].textContent = config.estatisticas.satisfacao;
            }
            
            // Atualizar cards informativos
            const cardValues = document.querySelectorAll('.card-value');
            if (cardValues.length >= 4) {
                cardValues[0].textContent = config.cardsInformativos.eleitoresCadastrados;
                cardValues[1].textContent = config.cardsInformativos.projetosAndamento;
                cardValues[2].textContent = config.cardsInformativos.eventosPrevistos;
                cardValues[3].textContent = config.cardsInformativos.mensagensRecebidas;
            }
        }

        function resetarConfiguracoes() {
            if (confirm('Tem certeza que deseja restaurar as configurações padrão?')) {
                localStorage.removeItem('painelConfig');
                carregarConfiguracoes();
                alert('Configurações restauradas para o padrão!');
            }
        }

        // ===== SISTEMA DE UPLOAD DE IMAGEM =====
        
        // Configurar upload de imagem do vereador
        document.addEventListener('DOMContentLoaded', function() {
            const imageInput = document.getElementById('imagemVereador');
            const previewImg = document.getElementById('previewImg');
            
            if (imageInput) {
                imageInput.addEventListener('change', function(e) {
                    const file = e.target.files[0];
                    if (file) {
                        // Validar tipo de arquivo
                        if (!file.type.match('image.*')) {
                            alert('Por favor, selecione apenas arquivos de imagem.');
                            return;
                        }
                        
                        // Validar tamanho (2MB máximo)
                        if (file.size > 2 * 1024 * 1024) {
                            alert('A imagem deve ter no máximo 2MB.');
                            return;
                        }
                        
                        // Mostrar preview
                        const reader = new FileReader();
                        reader.onload = function(e) {
                            previewImg.src = e.target.result;
                            // Salvar no localStorage para persistência
                            localStorage.setItem('imagemVereadorBase64', e.target.result);
                        };
                        reader.readAsDataURL(file);
                    }
                });
            }
        });

        function removerImagemVereador() {
            const previewImg = document.getElementById('previewImg');
            const imageInput = document.getElementById('imagemVereador');
            
            if (confirm('Tem certeza que deseja remover a foto do vereador?')) {
                previewImg.src = 'vereador.png'; // Voltar para imagem padrão
                imageInput.value = '';
                localStorage.removeItem('imagemVereadorBase64');
                alert('Foto removida com sucesso!');
            }
        }

        // ===== SISTEMA EXPANDIDO DE CONFIGURAÇÕES =====
        
        // Configurações expandidas do sistema
        const CONFIG_EXPANDIDO = {
            "vereador": {
                "nome": "Emicleiton Rubem da Conceição",
                "cargo": "Vereador de Monte Santo - BA",
                "imagem": "vereador.png"
            },
            "mandato": {
                "periodo": "2021 - 2024",
                "status": "Em Exercício",
                "statusClass": "ativo"
            },
            "estatisticas": {
                "anosMandato": "3",
                "projetosAtivos": "42",
                "cidadaosAtendidos": "1,247",
                "satisfacao": "95%"
            },
            "site": {
                "titulo": "Gabinete Digital",
                "nomeVereador": "Emicleiton Rubem da Conceição",
                "cidade": "Monte Santo - BA",
                "slogan": "Trabalhando com transparência e dedicação pelo futuro da nossa cidade",
                "whatsapp": "75999999999",
                "textoInstitucional": "Gabinete comprometido com a transparência e desenvolvimento de Monte Santo - BA",
                "telefone": "(75) 99999-9999"
            },
            "cardsInformativos": {
                "eleitoresCadastrados": "1,247",
                "projetosAndamento": "42",
                "eventosPrevistos": "8",
                "mensagensRecebidas": "89"
            }
        };

        // Função expandida para carregar todas as configurações
        function carregarConfiguracaoCompleta() {
            const config = JSON.parse(localStorage.getItem('configSiteCompleto')) || CONFIG_EXPANDIDO;
            
            // Campos de configurações básicas (mantém compatibilidade)
            carregarConfiguracoes();
            
            // Novos campos da seção "Editar Site"
            const camposExpandidos = [
                // Informações do vereador
                ['nomeCompletoVereador', config.vereador.nome],
                ['cargoVereador', config.vereador.cargo],
                
                // Mandato
                ['periodoMandato', config.mandato.periodo],
                ['statusMandato', config.mandato.status],
                
                // Estatísticas
                ['anosExercicio', config.estatisticas.anosMandato],
                ['projetosAprovados', config.estatisticas.projetosAtivos],
                ['cidadaosAtendidos', config.estatisticas.cidadaosAtendidos],
                ['nivelSatisfacao', config.estatisticas.satisfacao],
                
                // Site
                ['tituloSite', config.site.titulo],
                ['subtituloSite', config.site.nomeVereador],
                ['cidadeSite', config.site.cidade],
                ['sloganPrincipal', config.site.slogan],
                ['whatsappNumero', config.site.whatsapp],
                ['textoInstitucional', config.site.textoInstitucional],
                ['telefoneContato', config.site.telefone],
                
                // Cards informativos
                ['totalEleitoresCadastrados', config.cardsInformativos.eleitoresCadastrados],
                ['projetosEmAndamento', config.cardsInformativos.projetosAndamento],
                ['eventosPrevistos', config.cardsInformativos.eventosPrevistos],
                ['totalMensagens', config.cardsInformativos.mensagensRecebidas]
            ];
            
            camposExpandidos.forEach(([id, valor]) => {
                const elemento = document.getElementById(id);
                if (elemento) elemento.value = valor;
            });
            
            // Carregar imagem salva
            const imagemSalva = localStorage.getItem('imagemVereadorBase64');
            if (imagemSalva) {
                const previewImg = document.getElementById('previewImg');
                if (previewImg) previewImg.src = imagemSalva;
            }
            
            aplicarConfiguracoes(config);
        }

        // Função para salvar configuração completa
        function salvarConfiguracaoCompleta() {
            const config = {
                vereador: {
                    nome: document.getElementById('nomeCompletoVereador')?.value || CONFIG_EXPANDIDO.vereador.nome,
                    cargo: document.getElementById('cargoVereador')?.value || CONFIG_EXPANDIDO.vereador.cargo,
                    imagem: localStorage.getItem('imagemVereadorBase64') || CONFIG_EXPANDIDO.vereador.imagem
                },
                mandato: {
                    periodo: document.getElementById('periodoMandato')?.value || CONFIG_EXPANDIDO.mandato.periodo,
                    status: document.getElementById('statusMandato')?.value || CONFIG_EXPANDIDO.mandato.status,
                    statusClass: "ativo"
                },
                estatisticas: {
                    anosMandato: document.getElementById('anosExercicio')?.value || CONFIG_EXPANDIDO.estatisticas.anosMandato,
                    projetosAtivos: document.getElementById('projetosAprovados')?.value || CONFIG_EXPANDIDO.estatisticas.projetosAtivos,
                    cidadaosAtendidos: document.getElementById('cidadaosAtendidos')?.value || CONFIG_EXPANDIDO.estatisticas.cidadaosAtendidos,
                    satisfacao: document.getElementById('nivelSatisfacao')?.value || CONFIG_EXPANDIDO.estatisticas.satisfacao
                },
                site: {
                    titulo: document.getElementById('tituloSite')?.value || CONFIG_EXPANDIDO.site.titulo,
                    nomeVereador: document.getElementById('subtituloSite')?.value || CONFIG_EXPANDIDO.site.nomeVereador,
                    cidade: document.getElementById('cidadeSite')?.value || CONFIG_EXPANDIDO.site.cidade,
                    slogan: document.getElementById('sloganPrincipal')?.value || CONFIG_EXPANDIDO.site.slogan,
                    whatsapp: document.getElementById('whatsappNumero')?.value || CONFIG_EXPANDIDO.site.whatsapp,
                    textoInstitucional: document.getElementById('textoInstitucional')?.value || CONFIG_EXPANDIDO.site.textoInstitucional,
                    telefone: document.getElementById('telefoneContato')?.value || CONFIG_EXPANDIDO.site.telefone
                },
                cardsInformativos: {
                    eleitoresCadastrados: document.getElementById('totalEleitoresCadastrados')?.value || CONFIG_EXPANDIDO.cardsInformativos.eleitoresCadastrados,
                    projetosAndamento: document.getElementById('projetosEmAndamento')?.value || CONFIG_EXPANDIDO.cardsInformativos.projetosAndamento,
                    eventosPrevistos: document.getElementById('eventosPrevistos')?.value || CONFIG_EXPANDIDO.cardsInformativos.eventosPrevistos,
                    mensagensRecebidas: document.getElementById('totalMensagens')?.value || CONFIG_EXPANDIDO.cardsInformativos.mensagensRecebidas
                }
            };
            
            localStorage.setItem('configSiteCompleto', JSON.stringify(config));
            aplicarConfiguracaoCompleta(config);
            
            alert('Todas as configurações foram salvas com sucesso!');
        }

        // Função para aplicar configuração completa na interface
        function aplicarConfiguracaoCompleta(config) {
            // Aplicar configurações básicas primeiro
            aplicarConfiguracoes(config);
            
            // Atualizar elementos específicos do site público
            // (Estas atualizações afetarão o site principal quando implementadas)
            
            // Atualizar header com nova imagem se disponível
            const imagemVereadorHeader = document.querySelector('.vereador-header-photo');
            const imagemSalva = localStorage.getItem('imagemVereadorBase64');
            if (imagemVereadorHeader && imagemSalva) {
                imagemVereadorHeader.src = imagemSalva;
            }
            
            console.log('Configurações aplicadas:', config);
        }

        // Função para resetar todas as configurações
        function resetarTodasConfiguracoes() {
            if (confirm('Tem certeza que deseja restaurar TODAS as configurações para o padrão? Esta ação não pode ser desfeita.')) {
                localStorage.removeItem('configSiteCompleto');
                localStorage.removeItem('painelConfig');
                localStorage.removeItem('imagemVereadorBase64');
                carregarConfiguracaoCompleta();
                alert('Todas as configurações foram restauradas para o padrão!');
            }
        }

        // ===== SISTEMA DE EDITORES DINÂMICOS =====

        // Configurações padrão para editores dinâmicos
        const CONFIGURACOES_DINAMICAS = {
            botoes: [
                { id: 1, texto: "Fale Conosco", link: "#contato" },
                { id: 2, texto: "Projetos", link: "#projetos" }
            ],
            cardsMandato: [
                { 
                    id: 1, 
                    titulo: "Lei de Transparência", 
                    descricao: "Projeto aprovado para maior transparência municipal", 
                    status: "aprovado", 
                    icone: "fas fa-gavel" 
                },
                { 
                    id: 2, 
                    titulo: "Reforma da Praça Central", 
                    descricao: "Revitalização do espaço público principal", 
                    status: "andamento", 
                    icone: "fas fa-tools" 
                }
            ],
            cardsEstatisticas: [
                { id: 1, texto: "Projetos Aprovados", numero: "15", icone: "fas fa-check-circle" },
                { id: 2, texto: "Cidadãos Atendidos", numero: "1,247", icone: "fas fa-users" },
                { id: 3, texto: "Eventos Realizados", numero: "28", icone: "fas fa-calendar" },
                { id: 4, texto: "Taxa de Satisfação", numero: "95%", icone: "fas fa-thumbs-up" }
            ]
        };

        // Ícones disponíveis para seleção
        const ICONES_DISPONIVEIS = [
            'fas fa-gavel', 'fas fa-tools', 'fas fa-home', 'fas fa-heart', 'fas fa-star',
            'fas fa-check-circle', 'fas fa-users', 'fas fa-calendar', 'fas fa-thumbs-up',
            'fas fa-lightbulb', 'fas fa-book', 'fas fa-graduation-cap', 'fas fa-hospital',
            'fas fa-road', 'fas fa-tree', 'fas fa-recycle', 'fas fa-shield-alt',
            'fas fa-handshake', 'fas fa-megaphone', 'fas fa-balance-scale'
        ];

        // Status disponíveis para cards
        const STATUS_DISPONIVEIS = [
            { value: 'aprovado', label: 'Aprovado', class: 'aprovado' },
            { value: 'concluido', label: 'Concluído', class: 'concluido' },
            { value: 'andamento', label: 'Em Andamento', class: 'andamento' },
            { value: 'pendente', label: 'Pendente', class: 'pendente' }
        ];

        // ===== GERENCIAMENTO DE BOTÕES =====
        function carregarBotoes() {
            const botoes = JSON.parse(localStorage.getItem('botoesDoSite')) || CONFIGURACOES_DINAMICAS.botoes;
            const container = document.getElementById('botoesContainer');
            
            if (botoes.length === 0) {
                container.innerHTML = '<div class="no-items">Nenhum botão configurado. Clique em "Adicionar Novo Botão" para começar.</div>';
                return;
            }
            
            container.innerHTML = botoes.map(botao => `
                <div class="dynamic-editor" data-id="${botao.id}">
                    <button class="remove-item" onclick="removerBotao(${botao.id})" title="Remover botão">
                        <i class="fas fa-times"></i>
                    </button>
                    <h4><i class="fas fa-mouse-pointer"></i> Botão ${botao.id}</h4>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Texto do Botão</label>
                            <input type="text" value="${botao.texto}" onchange="atualizarBotao(${botao.id}, 'texto', this.value)" maxlength="30">
                        </div>
                        <div class="form-group">
                            <label>Link de Redirecionamento</label>
                            <input type="text" value="${botao.link}" onchange="atualizarBotao(${botao.id}, 'link', this.value)" placeholder="#secao ou https://exemplo.com">
                        </div>
                    </div>
                    <div class="card-preview">
                        <div class="preview-label">Preview:</div>
                        <button style="background: #fbbf24; color: #1f2937; padding: 0.75rem 1.5rem; border: none; border-radius: 8px; font-weight: 600;">
                            ${botao.texto}
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function adicionarBotao() {
            const botoes = JSON.parse(localStorage.getItem('botoesDoSite')) || CONFIGURACOES_DINAMICAS.botoes;
            const novoId = Math.max(...botoes.map(b => b.id), 0) + 1;
            
            botoes.push({
                id: novoId,
                texto: "Novo Botão",
                link: "#"
            });
            
            localStorage.setItem('botoesDoSite', JSON.stringify(botoes));
            carregarBotoes();
        }

        function removerBotao(id) {
            if (confirm('Tem certeza que deseja remover este botão?')) {
                const botoes = JSON.parse(localStorage.getItem('botoesDoSite')) || CONFIGURACOES_DINAMICAS.botoes;
                const botoesAtualizados = botoes.filter(b => b.id !== id);
                localStorage.setItem('botoesDoSite', JSON.stringify(botoesAtualizados));
                carregarBotoes();
            }
        }

        function atualizarBotao(id, campo, valor) {
            const botoes = JSON.parse(localStorage.getItem('botoesDoSite')) || CONFIGURACOES_DINAMICAS.botoes;
            const botao = botoes.find(b => b.id === id);
            if (botao) {
                botao[campo] = valor;
                localStorage.setItem('botoesDoSite', JSON.stringify(botoes));
                carregarBotoes();
            }
        }

        // ===== GERENCIAMENTO DE CARDS DO MANDATO =====
        function carregarCardsMandato() {
            const cards = JSON.parse(localStorage.getItem('cardsMandatoDoSite')) || CONFIGURACOES_DINAMICAS.cardsMandato;
            const container = document.getElementById('cardsMandatoContainer');
            
            if (cards.length === 0) {
                container.innerHTML = '<div class="no-items">Nenhum card configurado. Clique em "Adicionar Novo Card" para começar.</div>';
                return;
            }
            
            container.innerHTML = cards.map(card => `
                <div class="dynamic-editor" data-id="${card.id}">
                    <button class="remove-item" onclick="removerCardMandato(${card.id})" title="Remover card">
                        <i class="fas fa-times"></i>
                    </button>
                    <h4><i class="${card.icone}"></i> ${card.titulo}</h4>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Título do Card</label>
                            <input type="text" value="${card.titulo}" onchange="atualizarCardMandato(${card.id}, 'titulo', this.value)" maxlength="50">
                        </div>
                        <div class="form-group">
                            <label>Descrição</label>
                            <textarea onchange="atualizarCardMandato(${card.id}, 'descricao', this.value)" maxlength="150">${card.descricao}</textarea>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Status/Situação</label>
                        <div class="status-selector">
                            ${STATUS_DISPONIVEIS.map(status => `
                                <div class="status-option ${status.class} ${card.status === status.value ? 'selected' : ''}" 
                                     onclick="atualizarCardMandato(${card.id}, 'status', '${status.value}')">
                                    ${status.label}
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Ícone</label>
                        <div class="icon-selector">
                            ${ICONES_DISPONIVEIS.map(icone => `
                                <div class="icon-option ${card.icone === icone ? 'selected' : ''}" 
                                     onclick="atualizarCardMandato(${card.id}, 'icone', '${icone}')">
                                    <i class="${icone}"></i>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function adicionarCardMandato() {
            const cards = JSON.parse(localStorage.getItem('cardsMandatoDoSite')) || CONFIGURACOES_DINAMICAS.cardsMandato;
            const novoId = Math.max(...cards.map(c => c.id), 0) + 1;
            
            cards.push({
                id: novoId,
                titulo: "Novo Projeto",
                descricao: "Descrição do novo projeto ou iniciativa",
                status: "andamento",
                icone: "fas fa-star"
            });
            
            localStorage.setItem('cardsMandatoDoSite', JSON.stringify(cards));
            carregarCardsMandato();
        }

        function removerCardMandato(id) {
            if (confirm('Tem certeza que deseja remover este card?')) {
                const cards = JSON.parse(localStorage.getItem('cardsMandatoDoSite')) || CONFIGURACOES_DINAMICAS.cardsMandato;
                const cardsAtualizados = cards.filter(c => c.id !== id);
                localStorage.setItem('cardsMandatoDoSite', JSON.stringify(cardsAtualizados));
                carregarCardsMandato();
            }
        }

        function atualizarCardMandato(id, campo, valor) {
            const cards = JSON.parse(localStorage.getItem('cardsMandatoDoSite')) || CONFIGURACOES_DINAMICAS.cardsMandato;
            const card = cards.find(c => c.id === id);
            if (card) {
                card[campo] = valor;
                localStorage.setItem('cardsMandatoDoSite', JSON.stringify(cards));
                carregarCardsMandato();
            }
        }

        // ===== GERENCIAMENTO DE CARDS DE ESTATÍSTICAS =====
        function carregarCardsEstatisticas() {
            const cards = JSON.parse(localStorage.getItem('cardsEstatisticasDoSite')) || CONFIGURACOES_DINAMICAS.cardsEstatisticas;
            const container = document.getElementById('cardsEstatisticasContainer');
            
            if (cards.length === 0) {
                container.innerHTML = '<div class="no-items">Nenhuma estatística configurada. Clique em "Adicionar Nova Estatística" para começar.</div>';
                return;
            }
            
            container.innerHTML = cards.map(card => `
                <div class="dynamic-editor" data-id="${card.id}">
                    <button class="remove-item" onclick="removerCardEstatistica(${card.id})" title="Remover estatística">
                        <i class="fas fa-times"></i>
                    </button>
                    <h4><i class="${card.icone}"></i> ${card.texto}</h4>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Texto da Estatística</label>
                            <input type="text" value="${card.texto}" onchange="atualizarCardEstatistica(${card.id}, 'texto', this.value)" maxlength="40">
                        </div>
                        <div class="form-group">
                            <label>Número/Valor</label>
                            <input type="text" value="${card.numero}" onchange="atualizarCardEstatistica(${card.id}, 'numero', this.value)" maxlength="15">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Ícone</label>
                        <div class="icon-selector">
                            ${ICONES_DISPONIVEIS.map(icone => `
                                <div class="icon-option ${card.icone === icone ? 'selected' : ''}" 
                                     onclick="atualizarCardEstatistica(${card.id}, 'icone', '${icone}')">
                                    <i class="${icone}"></i>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    <div class="card-preview">
                        <div class="preview-label">Preview:</div>
                        <div style="background: linear-gradient(135deg, #1e40af 0%, #1e3a8a 100%); color: white; padding: 1.5rem; border-radius: 12px; text-align: center;">
                            <div style="font-size: 2rem; font-weight: bold; margin-bottom: 0.5rem;">
                                <i class="${card.icone}"></i> ${card.numero}
                            </div>
                            <div style="font-size: 0.9rem; opacity: 0.9;">${card.texto}</div>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function adicionarCardEstatistica() {
            const cards = JSON.parse(localStorage.getItem('cardsEstatisticasDoSite')) || CONFIGURACOES_DINAMICAS.cardsEstatisticas;
            const novoId = Math.max(...cards.map(c => c.id), 0) + 1;
            
            cards.push({
                id: novoId,
                texto: "Nova Estatística",
                numero: "0",
                icone: "fas fa-chart-line"
            });
            
            localStorage.setItem('cardsEstatisticasDoSite', JSON.stringify(cards));
            carregarCardsEstatisticas();
        }

        function removerCardEstatistica(id) {
            if (confirm('Tem certeza que deseja remover esta estatística?')) {
                const cards = JSON.parse(localStorage.getItem('cardsEstatisticasDoSite')) || CONFIGURACOES_DINAMICAS.cardsEstatisticas;
                const cardsAtualizados = cards.filter(c => c.id !== id);
                localStorage.setItem('cardsEstatisticasDoSite', JSON.stringify(cardsAtualizados));
                carregarCardsEstatisticas();
            }
        }

        function atualizarCardEstatistica(id, campo, valor) {
            const cards = JSON.parse(localStorage.getItem('cardsEstatisticasDoSite')) || CONFIGURACOES_DINAMICAS.cardsEstatisticas;
            const card = cards.find(c => c.id === id);
            if (card) {
                card[campo] = valor;
                localStorage.setItem('cardsEstatisticasDoSite', JSON.stringify(cards));
                carregarCardsEstatisticas();
            }
        }

        // ===== SISTEMA DE APLICAÇÃO NO SITE PÚBLICO =====
        
        function salvarEAplicarConfiguracoes() {
            // Salvar configurações completas
            salvarConfiguracaoCompleta();
            
            // Consolidar todos os dados para aplicação no site
            const configCompleta = {
                // Configurações básicas
                ...JSON.parse(localStorage.getItem('configSiteCompleto')) || CONFIG_EXPANDIDO,
                
                // Configurações dinâmicas
                botoes: JSON.parse(localStorage.getItem('botoesDoSite')) || CONFIGURACOES_DINAMICAS.botoes,
                cardsMandato: JSON.parse(localStorage.getItem('cardsMandatoDoSite')) || CONFIGURACOES_DINAMICAS.cardsMandato,
                cardsEstatisticas: JSON.parse(localStorage.getItem('cardsEstatisticasDoSite')) || CONFIGURACOES_DINAMICAS.cardsEstatisticas,
                
                // Imagem do vereador
                imagemVereador: localStorage.getItem('imagemVereadorBase64') || 'vereador.png'
            };
            
            // Salvar configuração consolidada para uso no site público
            localStorage.setItem('configuracaoSitePublico', JSON.stringify(configCompleta));
            
            // Aplicar configurações no site público se estiver aberto
            aplicarConfiguracoesNoSitePublico(configCompleta);
            
            alert('✅ Todas as configurações foram salvas e aplicadas com sucesso!\n\n' +
                  'O site público foi atualizado com:\n' +
                  `• ${configCompleta.botoes.length} botões de ação\n` +
                  `• ${configCompleta.cardsMandato.length} cards de mandato/projetos\n` +
                  `• ${configCompleta.cardsEstatisticas.length} estatísticas\n` +
                  '• Informações do vereador e rodapé\n' +
                  '• Upload de imagem (se configurado)');
        }

        function aplicarConfiguracoesNoSitePublico(config) {
            // Esta função seria chamada no site público para aplicar as configurações
            // Por agora, apenas demonstra o processo de integração
            
            console.group('🚀 Aplicando Configurações no Site Público');
            console.log('Vereador:', config.vereador);
            console.log('Botões:', config.botoes);
            console.log('Cards Mandato:', config.cardsMandato);
            console.log('Estatísticas:', config.cardsEstatisticas);
            console.log('Site:', config.site);
            console.groupEnd();
            
            // Simular aplicação das configurações
            return {
                success: true,
                message: 'Configurações aplicadas com sucesso',
                updatedElements: [
                    'header', 'hero-buttons', 'mandato-cards', 'statistics-cards', 'footer'
                ]
            };
        }

        function resetarTodasConfiguracoes() {
            if (confirm('⚠️ ATENÇÃO: Esta ação irá:\n\n' +
                       '• Restaurar todas as configurações para o padrão\n' +
                       '• Remover a foto personalizada do vereador\n' +
                       '• Resetar todos os botões, cards e estatísticas\n' +
                       '• Limpar todas as personalizações do site\n\n' +
                       'Esta ação NÃO PODE ser desfeita. Deseja continuar?')) {
                
                // Remover todas as configurações personalizadas
                const keysParaRemover = [
                    'configSiteCompleto', 'painelConfig', 'imagemVereadorBase64',
                    'botoesDoSite', 'cardsMandatoDoSite', 'cardsEstatisticasDoSite',
                    'configuracaoSitePublico'
                ];
                
                keysParaRemover.forEach(key => {
                    localStorage.removeItem(key);
                });
                
                // Recarregar todas as configurações padrão
                carregarConfiguracaoCompleta();
                carregarBotoes();
                carregarCardsMandato();
                carregarCardsEstatisticas();
                
                alert('✅ Todas as configurações foram restauradas para o padrão!\n\n' +
                      'O painel foi resetado com os valores originais. ' +
                      'Clique em "Salvar e Aplicar ao Site" para aplicar as mudanças no site público.');
            }
        }

        // Função para exportar configurações (backup)
        function exportarConfiguracoes() {
            const configCompleta = {
                vereador: JSON.parse(localStorage.getItem('configSiteCompleto')) || CONFIG_EXPANDIDO,
                botoes: JSON.parse(localStorage.getItem('botoesDoSite')) || CONFIGURACOES_DINAMICAS.botoes,
                cardsMandato: JSON.parse(localStorage.getItem('cardsMandatoDoSite')) || CONFIGURACOES_DINAMICAS.cardsMandato,
                cardsEstatisticas: JSON.parse(localStorage.getItem('cardsEstatisticasDoSite')) || CONFIGURACOES_DINAMICAS.cardsEstatisticas,
                imagemVereador: localStorage.getItem('imagemVereadorBase64') || null,
                dataExportacao: new Date().toISOString()
            };
            
            const blob = new Blob([JSON.stringify(configCompleta, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `configuracoes-gabinete-${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
        }

        // ===== CONFIGURAÇÕES PADRÃO (DEVE FICAR NO TOPO) =====
        
        // IMPORTANTE: Esta constante deve ser declarada antes de qualquer função que a use
        var CONTEUDO_SITE_PADRAO = {
            cabecalho: {
                titulo: "Gabinete Digital",
                nomeVereador: "Emicleiton Rubem da Conceição",
                cidadeEstado: "Monte Santo - BA",
                slogan: "Trabalhando com transparência e dedicação pelo futuro da nossa cidade",
                whatsapp: "75999999999",
                fotoVereador: "vereador.png"
            },
            botoesAcao: [
                { id: 1, texto: "Fale Conosco", link: "#contato" },
                { id: 2, texto: "Projetos", link: "#projetos" },
                { id: 3, texto: "Agenda", link: "#agenda" }
            ],
            mandato: {
                titulo: "Mandato Atual",
                periodo: "2021 - 2024",
                status: "Em Exercício",
                cards: {
                    anos: "3",
                    projetos: "42",
                    cidadaos: "1,247",
                    satisfacao: "95%"
                }
            },
            biografia: {
                texto: "Nascido em Monte Santo, Emicleiton Rubem da Conceição é um vereador comprometido com o desenvolvimento de sua cidade. Com experiência em gestão pública, trabalha incansavelmente pelos cidadãos.",
                imagem: ""
            },
            agenda: [],
            contato: {
                email: "contato@gabinete.com",
                telefone: "(75) 99999-9999",
                whatsapp: "75999999999",
                facebook: "",
                instagram: "",
                endereco: "Câmara Municipal de Monte Santo - BA",
                textoInstitucional: "Estamos sempre disponíveis para ouvir você e trabalhar juntos pelo desenvolvimento de Monte Santo."
            },
            rodape: {
                textoInstitucional: "Gabinete comprometido com a transparência e desenvolvimento de Monte Santo - BA",
                telefone: "(75) 99999-9999",
                whatsapp: "75999999999",
                copyright: "© 2025 Gabinete Digital - Todos os direitos reservados"
            }
        };

        // ===== FUNÇÕES PARA CABEÇALHO =====
        function carregarCabecalho() {
            const cabecalho = JSON.parse(localStorage.getItem('cabecalhoSite')) || CONTEUDO_SITE_PADRAO.cabecalho;
            
            document.getElementById('siteTitulo').value = cabecalho.titulo;
            document.getElementById('vereadorNomeCompleto').value = cabecalho.nomeVereador;
            document.getElementById('cidadeEstado').value = cabecalho.cidadeEstado;
            document.getElementById('sloganSite').value = cabecalho.slogan;
            document.getElementById('whatsappNumero').value = cabecalho.whatsapp;
            
            // Carregar foto se existir
            const fotoSalva = localStorage.getItem('fotoCabecalhoBase64');
            if (fotoSalva) {
                const preview = document.getElementById('previewFotoCabecalho');
                const img = preview.querySelector('img');
                img.src = fotoSalva;
                preview.style.display = 'block';
            }
        }

        function salvarCabecalho() {
            const cabecalho = {
                titulo: document.getElementById('siteTitulo').value,
                nomeVereador: document.getElementById('vereadorNomeCompleto').value,
                cidadeEstado: document.getElementById('cidadeEstado').value,
                slogan: document.getElementById('sloganSite').value,
                whatsapp: document.getElementById('whatsappNumero').value,
                fotoVereador: localStorage.getItem('fotoCabecalhoBase64') || CONTEUDO_SITE_PADRAO.cabecalho.fotoVereador
            };
            
            localStorage.setItem('cabecalhoSite', JSON.stringify(cabecalho));
            alert('✅ Cabeçalho salvo com sucesso!');
        }

        // ===== FUNÇÕES PARA BOTÕES DE AÇÃO =====
        function carregarBotoesEdicao() {
            const botoes = JSON.parse(localStorage.getItem('botoesAcaoSite')) || CONTEUDO_SITE_PADRAO.botoesAcao;
            const container = document.getElementById('botoesEditorContainer');
            
            container.innerHTML = botoes.map(botao => `
                <div class="dynamic-editor" data-id="${botao.id}">
                    <button class="remove-item" onclick="removerBotaoAcao(${botao.id})" title="Remover botão">
                        <i class="fas fa-times"></i>
                    </button>
                    <h4><i class="fas fa-mouse-pointer"></i> Botão ${botao.id}</h4>
                    <div class="form-grid" style="grid-template-columns: 1fr 1fr;">
                        <div class="form-group">
                            <label>Texto do Botão</label>
                            <input type="text" value="${botao.texto}" onchange="atualizarBotaoAcao(${botao.id}, 'texto', this.value)" maxlength="30">
                        </div>
                        <div class="form-group">
                            <label>Link de Redirecionamento</label>
                            <input type="text" value="${botao.link}" onchange="atualizarBotaoAcao(${botao.id}, 'link', this.value)" placeholder="#secao ou https://exemplo.com">
                        </div>
                    </div>
                    <div class="card-preview">
                        <div class="preview-label">Preview:</div>
                        <button style="background: #fbbf24; color: #1f2937; padding: 0.75rem 1.5rem; border: none; border-radius: 8px; font-weight: 600; cursor: pointer;">
                            ${botao.texto}
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function adicionarNovoBotao() {
            const botoes = JSON.parse(localStorage.getItem('botoesAcaoSite')) || CONTEUDO_SITE_PADRAO.botoesAcao;
            const novoId = Math.max(...botoes.map(b => b.id), 0) + 1;
            
            botoes.push({
                id: novoId,
                texto: "Novo Botão",
                link: "#"
            });
            
            localStorage.setItem('botoesAcaoSite', JSON.stringify(botoes));
            carregarBotoesEdicao();
        }

        function removerBotaoAcao(id) {
            if (confirm('Tem certeza que deseja remover este botão?')) {
                const botoes = JSON.parse(localStorage.getItem('botoesAcaoSite')) || CONTEUDO_SITE_PADRAO.botoesAcao;
                const botoesAtualizados = botoes.filter(b => b.id !== id);
                localStorage.setItem('botoesAcaoSite', JSON.stringify(botoesAtualizados));
                carregarBotoesEdicao();
            }
        }

        function atualizarBotaoAcao(id, campo, valor) {
            const botoes = JSON.parse(localStorage.getItem('botoesAcaoSite')) || CONTEUDO_SITE_PADRAO.botoesAcao;
            const botao = botoes.find(b => b.id === id);
            if (botao) {
                botao[campo] = valor;
                localStorage.setItem('botoesAcaoSite', JSON.stringify(botoes));
                carregarBotoesEdicao();
            }
        }

        function salvarBotoes() {
            alert('✅ Todos os botões foram salvos com sucesso!');
        }

        // ===== FUNÇÕES PARA MANDATO =====
        function carregarMandato() {
            const mandato = JSON.parse(localStorage.getItem('mandatoSite')) || CONTEUDO_SITE_PADRAO.mandato;
            
            document.getElementById('tituloMandato').value = mandato.titulo;
            document.getElementById('periodoMandatoAtual').value = mandato.periodo;
            document.getElementById('statusMandatoAtual').value = mandato.status;
            document.getElementById('cardAnosMandato').value = mandato.cards.anos;
            document.getElementById('cardProjetosAtivos').value = mandato.cards.projetos;
            document.getElementById('cardCidadaosAtendidos').value = mandato.cards.cidadaos;
            document.getElementById('cardSatisfacao').value = mandato.cards.satisfacao;
        }

        function salvarMandato() {
            const mandato = {
                titulo: document.getElementById('tituloMandato').value,
                periodo: document.getElementById('periodoMandatoAtual').value,
                status: document.getElementById('statusMandatoAtual').value,
                cards: {
                    anos: document.getElementById('cardAnosMandato').value,
                    projetos: document.getElementById('cardProjetosAtivos').value,
                    cidadaos: document.getElementById('cardCidadaosAtendidos').value,
                    satisfacao: document.getElementById('cardSatisfacao').value
                }
            };
            
            localStorage.setItem('mandatoSite', JSON.stringify(mandato));
            alert('✅ Mandato salvo com sucesso!');
        }

        // ===== FUNÇÕES PARA BIOGRAFIA =====
        function formatarTexto(comando) {
            document.execCommand(comando, false, null);
            document.getElementById('biografiaTexto').focus();
        }

        function carregarBiografia() {
            const biografia = JSON.parse(localStorage.getItem('biografiaSite')) || CONTEUDO_SITE_PADRAO.biografia;
            
            document.getElementById('biografiaTexto').innerHTML = biografia.texto;
            
            if (biografia.imagem) {
                const preview = document.getElementById('previewImagemBiografia');
                const img = preview.querySelector('img');
                img.src = biografia.imagem;
                preview.style.display = 'block';
            }
        }

        function salvarBiografia() {
            const biografia = {
                texto: document.getElementById('biografiaTexto').innerHTML,
                imagem: localStorage.getItem('imagemBiografiaBase64') || ""
            };
            
            localStorage.setItem('biografiaSite', JSON.stringify(biografia));
            alert('✅ Biografia salva com sucesso!');
        }

        // ===== FUNÇÕES PARA AGENDA =====
        function adicionarEvento() {
            const titulo = document.getElementById('eventoTitulo').value;
            const data = document.getElementById('eventoData').value;
            const horario = document.getElementById('eventoHorario').value;
            const local = document.getElementById('eventoLocal').value;
            const descricao = document.getElementById('eventoDescricao').value;
            
            if (!titulo || !data || !horario) {
                alert('Por favor, preencha título, data e horário.');
                return;
            }
            
            const eventos = JSON.parse(localStorage.getItem('agendaSite')) || [];
            const novoEvento = {
                id: Date.now(),
                titulo,
                data,
                horario,
                local,
                descricao,
                dataCriacao: new Date().toISOString()
            };
            
            eventos.push(novoEvento);
            localStorage.setItem('agendaSite', JSON.stringify(eventos));
            carregarEventos();
            limparFormularioEvento();
            alert('✅ Evento adicionado à agenda!');
        }

        function carregarEventos() {
            const eventos = JSON.parse(localStorage.getItem('agendaSite')) || [];
            const container = document.getElementById('listaEventos');
            
            if (eventos.length === 0) {
                container.innerHTML = '<div class="no-items">Nenhum evento na agenda. Adicione o primeiro evento acima.</div>';
                return;
            }
            
            // Ordenar eventos por data
            eventos.sort((a, b) => new Date(a.data + ' ' + a.horario) - new Date(b.data + ' ' + b.horario));
            
            container.innerHTML = eventos.map(evento => `
                <div class="agenda-item" data-id="${evento.id}">
                    <div class="item-header">
                        <div class="item-titulo">${evento.titulo}</div>
                        <div class="item-acoes">
                            <button class="btn-item edit" onclick="editarEvento(${evento.id})">
                                <i class="fas fa-edit"></i> Editar
                            </button>
                            <button class="btn-item delete" onclick="removerEvento(${evento.id})">
                                <i class="fas fa-trash"></i> Remover
                            </button>
                        </div>
                    </div>
                    <div class="item-meta">
                        <span><i class="fas fa-calendar"></i> ${formatarDataBR(evento.data)}</span>
                        <span><i class="fas fa-clock"></i> ${evento.horario}</span>
                        <span><i class="fas fa-map-marker-alt"></i> ${evento.local}</span>
                    </div>
                    <div class="item-descricao">${evento.descricao}</div>
                </div>
            `).join('');
        }

        function removerEvento(id) {
            if (confirm('Tem certeza que deseja remover este evento?')) {
                const eventos = JSON.parse(localStorage.getItem('agendaSite')) || [];
                const eventosAtualizados = eventos.filter(e => e.id !== id);
                localStorage.setItem('agendaSite', JSON.stringify(eventosAtualizados));
                carregarEventos();
            }
        }

        function limparFormularioEvento() {
            document.getElementById('eventoTitulo').value = '';
            document.getElementById('eventoData').value = '';
            document.getElementById('eventoHorario').value = '';
            document.getElementById('eventoLocal').value = '';
            document.getElementById('eventoDescricao').value = '';
        }

        // ===== FUNÇÕES PARA CONTATO =====
        function carregarContato() {
            const contato = JSON.parse(localStorage.getItem('contatoSite')) || CONTEUDO_SITE_PADRAO.contato;
            
            document.getElementById('contatoEmail').value = contato.email;
            document.getElementById('contatoTelefone').value = contato.telefone;
            document.getElementById('contatoWhatsapp').value = contato.whatsapp;
            document.getElementById('contatoFacebook').value = contato.facebook;
            document.getElementById('contatoInstagram').value = contato.instagram;
            document.getElementById('contatoEndereco').value = contato.endereco;
            document.getElementById('textoInstitucionalContato').value = contato.textoInstitucional;
        }

        function salvarContato() {
            const contato = {
                email: document.getElementById('contatoEmail').value,
                telefone: document.getElementById('contatoTelefone').value,
                whatsapp: document.getElementById('contatoWhatsapp').value,
                facebook: document.getElementById('contatoFacebook').value,
                instagram: document.getElementById('contatoInstagram').value,
                endereco: document.getElementById('contatoEndereco').value,
                textoInstitucional: document.getElementById('textoInstitucionalContato').value
            };
            
            localStorage.setItem('contatoSite', JSON.stringify(contato));
            alert('✅ Informações de contato salvas com sucesso!');
        }

        // ===== FUNÇÕES PARA RODAPÉ =====
        function carregarRodape() {
            const rodape = JSON.parse(localStorage.getItem('rodapeSite')) || CONTEUDO_SITE_PADRAO.rodape;
            
            document.getElementById('rodapeTextoInstitucional').value = rodape.textoInstitucional;
            document.getElementById('rodapeTelefone').value = rodape.telefone;
            document.getElementById('rodapeWhatsapp').value = rodape.whatsapp;
            document.getElementById('rodapeCopyright').value = rodape.copyright;
        }

        function salvarRodape() {
            const rodape = {
                textoInstitucional: document.getElementById('rodapeTextoInstitucional').value,
                telefone: document.getElementById('rodapeTelefone').value,
                whatsapp: document.getElementById('rodapeWhatsapp').value,
                copyright: document.getElementById('rodapeCopyright').value
            };
            
            localStorage.setItem('rodapeSite', JSON.stringify(rodape));
            alert('✅ Rodapé salvo com sucesso!');
        }

        // ===== FUNÇÕES DE UPLOAD DE IMAGEM =====
        function configurarUploads() {
            // Upload foto cabeçalho
            document.getElementById('fotoCabecalho').addEventListener('change', function(e) {
                processarUploadImagem(e, 'fotoCabecalhoBase64', 'previewFotoCabecalho');
            });
            
            // Upload imagem biografia
            document.getElementById('imagemBiografia').addEventListener('change', function(e) {
                processarUploadImagem(e, 'imagemBiografiaBase64', 'previewImagemBiografia');
            });
        }

        function processarUploadImagem(event, storageKey, previewId) {
            const file = event.target.files[0];
            if (!file) return;
            
            // Validar tipo
            if (!file.type.match('image.*')) {
                alert('Por favor, selecione apenas arquivos de imagem.');
                return;
            }
            
            // Validar tamanho (5MB)
            if (file.size > 5 * 1024 * 1024) {
                alert('A imagem deve ter no máximo 5MB.');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                localStorage.setItem(storageKey, e.target.result);
                
                const preview = document.getElementById(previewId);
                const img = preview.querySelector('img');
                img.src = e.target.result;
                preview.style.display = 'block';
            };
            reader.readAsDataURL(file);
        }

        // ===== FUNÇÕES UTILITÁRIAS =====
        function formatarDataBR(data) {
            const [ano, mes, dia] = data.split('-');
            return `${dia}/${mes}/${ano}`;
        }

        // ===== FUNÇÃO DE APLICAÇÃO COMPLETA NO SITE =====
        function aplicarTodoConteudoNoSite() {
            const conteudoCompleto = {
                cabecalho: JSON.parse(localStorage.getItem('cabecalhoSite')) || CONTEUDO_SITE_PADRAO.cabecalho,
                botoesAcao: JSON.parse(localStorage.getItem('botoesAcaoSite')) || CONTEUDO_SITE_PADRAO.botoesAcao,
                mandato: JSON.parse(localStorage.getItem('mandatoSite')) || CONTEUDO_SITE_PADRAO.mandato,
                biografia: JSON.parse(localStorage.getItem('biografiaSite')) || CONTEUDO_SITE_PADRAO.biografia,
                agenda: JSON.parse(localStorage.getItem('agendaSite')) || [],
                projetos: JSON.parse(localStorage.getItem('projetosSite')) || [],
                noticias: JSON.parse(localStorage.getItem('noticiasSite')) || [],
                galeria: JSON.parse(localStorage.getItem('galeriaSite')) || [],
                contato: JSON.parse(localStorage.getItem('contatoSite')) || CONTEUDO_SITE_PADRAO.contato,
                rodape: JSON.parse(localStorage.getItem('rodapeSite')) || CONTEUDO_SITE_PADRAO.rodape
            };
            
            localStorage.setItem('conteudoSitePublico100', JSON.stringify(conteudoCompleto));
            
            console.group('🚀 Aplicando 100% do Conteúdo no Site Público');
            console.log('Cabeçalho:', conteudoCompleto.cabecalho);
            console.log('Botões de Ação:', conteudoCompleto.botoesAcao);
            console.log('Mandato:', conteudoCompleto.mandato);
            console.log('Biografia:', conteudoCompleto.biografia);
            console.log('Agenda:', conteudoCompleto.agenda);
            console.log('Contato:', conteudoCompleto.contato);
            console.log('Rodapé:', conteudoCompleto.rodape);
            console.groupEnd();
            
            return conteudoCompleto;
        }

        // ===== SISTEMA DE CONTEÚDO DINÂMICO SUPABASE =====
        
        // Importar sistema de conteúdo dinâmico
        async function importarConteudoDinamico() {
            try {
                const module = await import('./dynamic-content.js');
                window.dynamicContent = module;
                console.log('✅ Sistema de conteúdo dinâmico carregado');
                
                // Inicializar carregamento do cabeçalho
                if (module.carregarCabecalhoDinamico) {
                    await module.carregarCabecalhoDinamico();
                }
            } catch (error) {
                console.error('❌ Erro ao carregar sistema dinâmico:', error);
            }
        }

        // Carregar configurações ao inicializar a página
        document.addEventListener('DOMContentLoaded', function() {
            // Inicializar sistema dinâmico primeiro
            importarConteudoDinamico();
            
            setTimeout(() => {
                carregarConfiguracaoCompleta();
                carregarBotoes();
                carregarCardsMandato();
                carregarCardsEstatisticas();
                
                // Carregar novos módulos de edição completa
                carregarCabecalho();
                carregarBotoesEdicao();
                carregarMandato();
                carregarBiografia();
                carregarEventos();
                carregarContato();
                carregarRodape();
                
                // Configurar uploads de imagem
                configurarUploads();
                
                // Carregar módulo de análise de votos
                inicializarAnaliseVotos();
                

                
                // Carregar módulo Raio-X Votos
                inicializarRaioXVotos();
            }, 500);
        });









        // ===== SISTEMA RAIO-X VOTOS =====
        
        var chartVotosLocais = null;
        var chartVotosCandidatos = null;
        var dadosRaioXFiltrados = [];

        function inicializarRaioXVotos() {
            if (!document.getElementById('chartVotosLocais')) {
                return;
            }
            
            setTimeout(() => {
                if (typeof Chart !== 'undefined') {
                    inicializarChartsRaioX();
                    carregarDadosRaioX();
                    atualizarEstatisticasRaioX();
                    carregarOpcoesFiltragemRaioX();
                    console.log('✅ Raio-X Votos inicializado');
                } else {
                    setTimeout(inicializarRaioXVotos, 1000);
                }
            }, 500);
        }

        function inicializarChartsRaioX() {
            // Gráfico de barras - Votos por local
            const ctxLocais = document.getElementById('chartVotosLocais');
            if (ctxLocais) {
                if (chartVotosLocais) chartVotosLocais.destroy();
                
                chartVotosLocais = new Chart(ctxLocais, {
                    type: 'bar',
                    data: {
                        labels: [],
                        datasets: [{
                            label: 'Votos',
                            data: [],
                            backgroundColor: 'rgba(30, 64, 175, 0.8)',
                            borderColor: 'rgba(30, 64, 175, 1)',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false }
                        },
                        scales: {
                            y: { beginAtZero: true }
                        }
                    }
                });
            }

            // Gráfico de pizza - Votos por candidato
            const ctxCandidatos = document.getElementById('chartVotosCandidatos');
            if (ctxCandidatos) {
                if (chartVotosCandidatos) chartVotosCandidatos.destroy();
                
                chartVotosCandidatos = new Chart(ctxCandidatos, {
                    type: 'doughnut',
                    data: {
                        labels: [],
                        datasets: [{
                            data: [],
                            backgroundColor: [
                                '#1e40af', '#dc2626', '#059669', '#7c3aed', '#ea580c',
                                '#0891b2', '#be185d', '#4338ca', '#16a34a', '#c2410c'
                            ],
                            borderWidth: 2,
                            borderColor: '#ffffff'
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom'
                            }
                        }
                    }
                });
            }
        }

        function adicionarVotosRaioX() {
            const municipio = document.getElementById('municipioRaioX').value.trim();
            const zona = document.getElementById('zonaEleitoralRaioX').value.trim();
            const bairro = document.getElementById('bairroRaioX').value.trim();
            const local = document.getElementById('localVotacaoRaioX').value.trim();
            const secao = document.getElementById('secaoRaioX').value.trim();
            const candidato = document.getElementById('candidatoRaioX').value.trim();
            const votos = parseInt(document.getElementById('votosRaioX').value);
            
            if (!municipio || !zona || !bairro || !local || !secao || !candidato || !votos || votos < 0) {
                alert('❌ Preencha todos os campos obrigatórios.');
                return;
            }
            
            const dados = JSON.parse(localStorage.getItem('dadosRaioXVotos')) || [];
            
            const novoRegistro = {
                id: Date.now(),
                municipio,
                zona,
                bairro,
                local,
                secao,
                candidato,
                votos,
                dataCadastro: new Date().toISOString()
            };
            
            dados.push(novoRegistro);
            localStorage.setItem('dadosRaioXVotos', JSON.stringify(dados));
            
            carregarDadosRaioX();
            atualizarEstatisticasRaioX();
            atualizarChartsRaioX();
            carregarOpcoesFiltragemRaioX();
            limparFormularioRaioX();
            
            alert('✅ Dados adicionados!');
        }

        function limparFormularioRaioX() {
            document.getElementById('municipioRaioX').value = '';
            document.getElementById('zonaEleitoralRaioX').value = '';
            document.getElementById('bairroRaioX').value = '';
            document.getElementById('localVotacaoRaioX').value = '';
            document.getElementById('secaoRaioX').value = '';
            document.getElementById('candidatoRaioX').value = '';
            document.getElementById('votosRaioX').value = '';
        }

        function carregarDadosRaioX() {
            const dados = JSON.parse(localStorage.getItem('dadosRaioXVotos')) || [];
            dadosRaioXFiltrados = [...dados];
            
            const tbody = document.getElementById('tabelaRaioXBody');
            if (!tbody) return;
            
            if (dados.length === 0) {
                tbody.innerHTML = '<tr><td colspan="8" style="text-align: center; padding: 2rem;">Nenhum dado cadastrado.</td></tr>';
                return;
            }
            
            tbody.innerHTML = dadosRaioXFiltrados.map(registro => `
                <tr>
                    <td>${registro.municipio}</td>
                    <td>${registro.zona}</td>
                    <td>${registro.bairro}</td>
                    <td>${registro.local}</td>
                    <td>${registro.secao}</td>
                    <td>${registro.candidato}</td>
                    <td><span class="votos-badge">${registro.votos.toLocaleString()}</span></td>
                    <td>
                        <button class="btn-item edit" onclick="editarRaioX(${registro.id})" title="Editar">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn-item delete" onclick="removerRaioX(${registro.id})" title="Remover">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                </tr>
            `).join('');
        }

        function atualizarEstatisticasRaioX() {
            const dados = JSON.parse(localStorage.getItem('dadosRaioXVotos')) || [];
            
            const totalVotos = dados.reduce((sum, r) => sum + r.votos, 0);
            const locaisUnicos = new Set(dados.map(r => r.local)).size;
            const candidatosUnicos = new Set(dados.map(r => r.candidato)).size;
            const municipiosUnicos = new Set(dados.map(r => r.municipio)).size;
            
            if (document.getElementById('totalVotosRaioX'))
                document.getElementById('totalVotosRaioX').textContent = totalVotos.toLocaleString();
            if (document.getElementById('totalLocaisRaioX'))
                document.getElementById('totalLocaisRaioX').textContent = locaisUnicos;
            if (document.getElementById('totalCandidatosRaioX'))
                document.getElementById('totalCandidatosRaioX').textContent = candidatosUnicos;
            if (document.getElementById('totalMunicipiosRaioX'))
                document.getElementById('totalMunicipiosRaioX').textContent = municipiosUnicos;
        }

        function carregarOpcoesFiltragemRaioX() {
            const dados = JSON.parse(localStorage.getItem('dadosRaioXVotos')) || [];
            
            // Municipios
            const municipios = [...new Set(dados.map(r => r.municipio))].sort();
            const selectMunicipio = document.getElementById('filtroMunicipioRaioX');
            if (selectMunicipio) {
                selectMunicipio.innerHTML = '<option value="">Todos</option>' + 
                    municipios.map(m => `<option value="${m}">${m}</option>`).join('');
            }
            
            // Zonas
            const zonas = [...new Set(dados.map(r => r.zona))].sort();
            const selectZona = document.getElementById('filtroZonaRaioX');
            if (selectZona) {
                selectZona.innerHTML = '<option value="">Todas</option>' + 
                    zonas.map(z => `<option value="${z}">${z}</option>`).join('');
            }
            
            // Bairros
            const bairros = [...new Set(dados.map(r => r.bairro))].sort();
            const selectBairro = document.getElementById('filtroBairroRaioX');
            if (selectBairro) {
                selectBairro.innerHTML = '<option value="">Todos</option>' + 
                    bairros.map(b => `<option value="${b}">${b}</option>`).join('');
            }
            
            // Locais
            const locais = [...new Set(dados.map(r => r.local))].sort();
            const selectLocal = document.getElementById('filtroLocalRaioX');
            if (selectLocal) {
                selectLocal.innerHTML = '<option value="">Todos</option>' + 
                    locais.map(l => `<option value="${l}">${l}</option>`).join('');
            }
            
            // Candidatos
            const candidatos = [...new Set(dados.map(r => r.candidato))].sort();
            const selectCandidato = document.getElementById('filtroCandidatoRaioX');
            if (selectCandidato) {
                selectCandidato.innerHTML = '<option value="">Todos</option>' + 
                    candidatos.map(c => `<option value="${c}">${c}</option>`).join('');
            }
        }

        function aplicarFiltrosRaioX() {
            const dados = JSON.parse(localStorage.getItem('dadosRaioXVotos')) || [];
            
            const filtroMunicipio = document.getElementById('filtroMunicipioRaioX')?.value || '';
            const filtroZona = document.getElementById('filtroZonaRaioX')?.value || '';
            const filtroBairro = document.getElementById('filtroBairroRaioX')?.value || '';
            const filtroLocal = document.getElementById('filtroLocalRaioX')?.value || '';
            const filtroCandidato = document.getElementById('filtroCandidatoRaioX')?.value || '';
            
            dadosRaioXFiltrados = dados.filter(registro => {
                return (!filtroMunicipio || registro.municipio === filtroMunicipio) &&
                       (!filtroZona || registro.zona === filtroZona) &&
                       (!filtroBairro || registro.bairro === filtroBairro) &&
                       (!filtroLocal || registro.local === filtroLocal) &&
                       (!filtroCandidato || registro.candidato === filtroCandidato);
            });
            
            carregarDadosRaioX();
            atualizarChartsRaioX();
        }

        function limparFiltrosRaioX() {
            ['filtroMunicipioRaioX', 'filtroZonaRaioX', 'filtroBairroRaioX', 'filtroLocalRaioX', 'filtroCandidatoRaioX'].forEach(id => {
                const element = document.getElementById(id);
                if (element) element.value = '';
            });
            aplicarFiltrosRaioX();
        }

        function atualizarChartsRaioX() {
            if (!chartVotosLocais || !chartVotosCandidatos) return;
            
            // Atualizar gráfico por locais
            const votosPorLocal = {};
            dadosRaioXFiltrados.forEach(registro => {
                votosPorLocal[registro.local] = (votosPorLocal[registro.local] || 0) + registro.votos;
            });
            
            const locaisOrdenados = Object.entries(votosPorLocal)
                .sort(([,a], [,b]) => b - a)
                .slice(0, 10);
            
            chartVotosLocais.data.labels = locaisOrdenados.map(([local]) => local);
            chartVotosLocais.data.datasets[0].data = locaisOrdenados.map(([,votos]) => votos);
            chartVotosLocais.update();
            
            // Atualizar gráfico por candidatos
            const votosPorCandidato = {};
            dadosRaioXFiltrados.forEach(registro => {
                votosPorCandidato[registro.candidato] = (votosPorCandidato[registro.candidato] || 0) + registro.votos;
            });
            
            if (Object.keys(votosPorCandidato).length === 0) {
                chartVotosCandidatos.data.labels = ['Sem dados'];
                chartVotosCandidatos.data.datasets[0].data = [1];
            } else {
                chartVotosCandidatos.data.labels = Object.keys(votosPorCandidato);
                chartVotosCandidatos.data.datasets[0].data = Object.values(votosPorCandidato);
            }
            chartVotosCandidatos.update();
        }

        function buscarRaioX() {
            const termo = document.getElementById('buscaRaioX')?.value.toLowerCase() || '';
            const dados = JSON.parse(localStorage.getItem('dadosRaioXVotos')) || [];
            
            if (!termo) {
                dadosRaioXFiltrados = [...dados];
            } else {
                dadosRaioXFiltrados = dados.filter(registro => 
                    registro.municipio.toLowerCase().includes(termo) ||
                    registro.zona.toLowerCase().includes(termo) ||
                    registro.bairro.toLowerCase().includes(termo) ||
                    registro.local.toLowerCase().includes(termo) ||
                    registro.secao.toLowerCase().includes(termo) ||
                    registro.candidato.toLowerCase().includes(termo)
                );
            }
            
            carregarDadosRaioX();
            atualizarChartsRaioX();
        }

        function ordenarRaioX() {
            const criterio = document.getElementById('ordenarRaioX')?.value || 'votos';
            
            dadosRaioXFiltrados.sort((a, b) => {
                switch(criterio) {
                    case 'votos':
                        return b.votos - a.votos;
                    case 'municipio':
                        return a.municipio.localeCompare(b.municipio);
                    case 'candidato':
                        return a.candidato.localeCompare(b.candidato);
                    default:
                        return 0;
                }
            });
            
            carregarDadosRaioX();
        }

        function editarRaioX(id) {
            const dados = JSON.parse(localStorage.getItem('dadosRaioXVotos')) || [];
            const registro = dados.find(r => r.id === id);
            
            if (!registro) return;
            
            const novoMunicipio = prompt('Município:', registro.municipio);
            if (!novoMunicipio?.trim()) return;
            
            const novaZona = prompt('Zona:', registro.zona);
            if (!novaZona?.trim()) return;
            
            const novoBairro = prompt('Bairro:', registro.bairro);
            if (!novoBairro?.trim()) return;
            
            const novoLocal = prompt('Local:', registro.local);
            if (!novoLocal?.trim()) return;
            
            const novaSecao = prompt('Seção:', registro.secao);
            if (!novaSecao?.trim()) return;
            
            const novoCandidato = prompt('Candidato:', registro.candidato);
            if (!novoCandidato?.trim()) return;
            
            const novosVotos = prompt('Votos:', registro.votos);
            if (!novosVotos || isNaN(novosVotos) || parseInt(novosVotos) < 0) return;
            
            registro.municipio = novoMunicipio.trim();
            registro.zona = novaZona.trim();
            registro.bairro = novoBairro.trim();
            registro.local = novoLocal.trim();
            registro.secao = novaSecao.trim();
            registro.candidato = novoCandidato.trim();
            registro.votos = parseInt(novosVotos);
            
            localStorage.setItem('dadosRaioXVotos', JSON.stringify(dados));
            carregarDadosRaioX();
            atualizarEstatisticasRaioX();
            atualizarChartsRaioX();
            carregarOpcoesFiltragemRaioX();
            
            alert('✅ Registro atualizado!');
        }

        function removerRaioX(id) {
            if (!confirm('Remover este registro?')) return;
            
            const dados = JSON.parse(localStorage.getItem('dadosRaioXVotos')) || [];
            const dadosAtualizados = dados.filter(r => r.id !== id);
            
            localStorage.setItem('dadosRaioXVotos', JSON.stringify(dadosAtualizados));
            carregarDadosRaioX();
            atualizarEstatisticasRaioX();
            atualizarChartsRaioX();
            carregarOpcoesFiltragemRaioX();
            
            alert('✅ Registro removido!');
        }

        function exportarRaioXJSON() {
            const dados = JSON.parse(localStorage.getItem('dadosRaioXVotos')) || [];
            
            if (dados.length === 0) {
                alert('❌ Não há dados para exportar.');
                return;
            }
            
            const exportacao = {
                versao: '1.0',
                dataExportacao: new Date().toISOString(),
                totalRegistros: dados.length,
                totalVotos: dados.reduce((sum, r) => sum + r.votos, 0),
                dados: dados
            };
            
            const blob = new Blob([JSON.stringify(exportacao, null, 2)], {
                type: 'application/json'
            });
            
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `raio-x-votos-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            alert('✅ JSON exportado!');
        }

        function exportarRaioXCSV() {
            const dados = JSON.parse(localStorage.getItem('dadosRaioXVotos')) || [];
            
            if (dados.length === 0) {
                alert('❌ Não há dados para exportar.');
                return;
            }
            
            const headers = ['Município', 'Zona', 'Bairro', 'Local', 'Seção', 'Candidato', 'Votos'];
            const csvContent = [
                headers.join(','),
                ...dados.map(registro => [
                    `"${registro.municipio}"`,
                    `"${registro.zona}"`,
                    `"${registro.bairro}"`,
                    `"${registro.local}"`,
                    `"${registro.secao}"`,
                    `"${registro.candidato}"`,
                    registro.votos
                ].join(','))
            ].join('\n');
            
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `raio-x-votos-${new Date().toISOString().split('T')[0]}.csv`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            alert('✅ CSV exportado!');
        }

        function importarRaioXJSON(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const dados = JSON.parse(e.target.result);
                    
                    if (!dados.dados || !Array.isArray(dados.dados)) {
                        throw new Error('Formato inválido.');
                    }
                    
                    if (confirm(`Importar ${dados.dados.length} registros?`)) {
                        localStorage.setItem('dadosRaioXVotos', JSON.stringify(dados.dados));
                        carregarDadosRaioX();
                        atualizarEstatisticasRaioX();
                        atualizarChartsRaioX();
                        carregarOpcoesFiltragemRaioX();
                        alert('✅ JSON importado!');
                    }
                } catch (error) {
                    alert('❌ Erro: ' + error.message);
                }
            };
            reader.readAsText(file);
            event.target.value = '';
        }

        function importarRaioXCSV(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const csvContent = e.target.result;
                    const lines = csvContent.split('\n');
                    
                    if (lines.length < 2) {
                        throw new Error('Arquivo CSV vazio.');
                    }
                    
                    const dadosImportados = [];
                    for (let i = 1; i < lines.length; i++) {
                        const line = lines[i].trim();
                        if (!line) continue;
                        
                        const values = line.split(',').map(v => v.replace(/^"|"$/g, ''));
                        
                        if (values.length >= 7) {
                            dadosImportados.push({
                                id: Date.now() + i,
                                municipio: values[0] || '',
                                zona: values[1] || '',
                                bairro: values[2] || '',
                                local: values[3] || '',
                                secao: values[4] || '',
                                candidato: values[5] || '',
                                votos: parseInt(values[6]) || 0,
                                dataCadastro: new Date().toISOString()
                            });
                        }
                    }
                    
                    if (dadosImportados.length === 0) {
                        throw new Error('Nenhum dado válido encontrado.');
                    }
                    
                    if (confirm(`Importar ${dadosImportados.length} registros?`)) {
                        localStorage.setItem('dadosRaioXVotos', JSON.stringify(dadosImportados));
                        carregarDadosRaioX();
                        atualizarEstatisticasRaioX();
                        atualizarChartsRaioX();
                        carregarOpcoesFiltragemRaioX();
                        alert('✅ CSV importado!');
                    }
                } catch (error) {
                    alert('❌ Erro: ' + error.message);
                }
            };
            reader.readAsText(file);
            event.target.value = '';
        }

        function resetarRaioX() {
            if (!confirm('⚠️ Limpar todos os dados?')) return;
            
            localStorage.removeItem('dadosRaioXVotos');
            carregarDadosRaioX();
            atualizarEstatisticasRaioX();
            atualizarChartsRaioX();
            carregarOpcoesFiltragemRaioX();
            
            alert('✅ Dados limpos.');
        }

        // ===== SISTEMA COMPLETO DE ANÁLISE DE VOTOS =====
        
        var chartVotosBarras = null;
        var chartVotosPizza = null;
        var dadosVotosFiltrados = [];

        function inicializarAnaliseVotos() {
            // Verificar se estamos na seção correta
            if (!document.getElementById('chartVotosBarras')) {
                return;
            }
            
            // Aguardar carregamento da biblioteca Chart.js
            setTimeout(() => {
                if (typeof Chart !== 'undefined') {
                    inicializarChartsVotos();
                    carregarDadosVotos();
                    atualizarEstatisticasVotos();
                    carregarOpcoesFiltragem();
                    console.log('✅ Análise de Votos inicializada com sucesso');
                } else {
                    console.warn('Biblioteca Chart.js não carregada ainda');
                    setTimeout(inicializarAnaliseVotos, 1000);
                }
            }, 500);
        }

        function inicializarChartsVotos() {
            // Gráfico de Barras - Votos por Local
            const ctxBarras = document.getElementById('chartVotosBarras');
            if (!ctxBarras) return;
            
            if (chartVotosBarras) {
                chartVotosBarras.destroy();
            }
            
            try {
                chartVotosBarras = new Chart(ctxBarras, {
                    type: 'bar',
                    data: {
                        labels: [],
                        datasets: [{
                            label: 'Votos',
                            data: [],
                            backgroundColor: 'rgba(30, 64, 175, 0.8)',
                            borderColor: 'rgba(30, 64, 175, 1)',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        return `${context.parsed.y.toLocaleString()} votos`;
                                    }
                                }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    callback: function(value) {
                                        return value.toLocaleString();
                                    }
                                }
                            },
                            x: {
                                ticks: {
                                    maxRotation: 45,
                                    minRotation: 45
                                }
                            }
                        }
                    }
                });

                // Gráfico de Pizza - Distribuição por Candidato
                const ctxPizza = document.getElementById('chartVotosPizza');
                if (!ctxPizza) return;
                
                if (chartVotosPizza) {
                    chartVotosPizza.destroy();
                }
                
                chartVotosPizza = new Chart(ctxPizza, {
                    type: 'doughnut',
                    data: {
                        labels: [],
                        datasets: [{
                            data: [],
                            backgroundColor: [
                                '#1e40af', '#dc2626', '#059669', '#7c3aed', '#ea580c',
                                '#0891b2', '#be185d', '#4338ca', '#16a34a', '#c2410c'
                            ],
                            borderWidth: 2,
                            borderColor: '#ffffff'
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    padding: 20,
                                    usePointStyle: true
                                }
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        const label = context.label || '';
                                        const value = context.parsed;
                                        const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                        const percentage = ((value / total) * 100).toFixed(1);
                                        return `${label}: ${value.toLocaleString()} votos (${percentage}%)`;
                                    }
                                }
                            }
                        }
                    }
                });
                
                console.log('✅ Gráficos de votos inicializados com sucesso');
            } catch (error) {
                console.error('❌ Erro ao inicializar gráficos de votos:', error);
            }
        }

        function adicionarDadosVotos() {
            const municipio = document.getElementById('municipio').value.trim();
            const zonaEleitoral = document.getElementById('zonaEleitoral').value.trim();
            const bairroVotacao = document.getElementById('bairroVotacao').value.trim();
            const localVotacao = document.getElementById('localVotacao').value.trim();
            const secaoEleitoral = document.getElementById('secaoEleitoral').value.trim();
            const candidatoNome = document.getElementById('candidatoNome').value.trim();
            const quantidadeVotos = parseInt(document.getElementById('quantidadeVotos').value);
            const dataEleicao = document.getElementById('dataEleicao').value;
            
            if (!municipio || !zonaEleitoral || !bairroVotacao || !localVotacao || !secaoEleitoral || !quantidadeVotos || quantidadeVotos < 0) {
                alert('❌ Por favor, preencha todos os campos obrigatórios.');
                return;
            }
            
            const dadosVotos = JSON.parse(localStorage.getItem('dadosVotosAnalise')) || [];
            
            const novoRegistro = {
                id: Date.now(),
                municipio,
                zonaEleitoral,
                bairroVotacao,
                localVotacao,
                secaoEleitoral,
                candidatoNome: candidatoNome || 'Não informado',
                quantidadeVotos,
                dataEleicao: dataEleicao || null,
                dataCadastro: new Date().toISOString()
            };
            
            dadosVotos.push(novoRegistro);
            localStorage.setItem('dadosVotosAnalise', JSON.stringify(dadosVotos));
            
            carregarDadosVotos();
            atualizarEstatisticasVotos();
            atualizarChartsVotos();
            carregarOpcoesFiltragem();
            limparFormularioVotos();
            
            alert('✅ Dados eleitorais adicionados com sucesso!');
        }

        function limparFormularioVotos() {
            document.getElementById('municipio').value = '';
            document.getElementById('zonaEleitoral').value = '';
            document.getElementById('bairroVotacao').value = '';
            document.getElementById('localVotacao').value = '';
            document.getElementById('secaoEleitoral').value = '';
            document.getElementById('candidatoNome').value = '';
            document.getElementById('quantidadeVotos').value = '';
            document.getElementById('dataEleicao').value = '';
        }

        function carregarDadosVotos() {
            const dadosVotos = JSON.parse(localStorage.getItem('dadosVotosAnalise')) || [];
            dadosVotosFiltrados = [...dadosVotos];
            
            const tbody = document.getElementById('tabelaVotosBody');
            if (!tbody) return;
            
            if (dadosVotos.length === 0) {
                tbody.innerHTML = '<tr><td colspan="9" style="text-align: center; padding: 2rem; color: #64748b;">Nenhum dado eleitoral cadastrado. Adicione o primeiro registro acima.</td></tr>';
                return;
            }
            
            tbody.innerHTML = dadosVotosFiltrados.map(registro => `
                <tr>
                    <td>${registro.municipio}</td>
                    <td>${registro.zonaEleitoral}</td>
                    <td>${registro.bairroVotacao}</td>
                    <td>${registro.localVotacao}</td>
                    <td>${registro.secaoEleitoral}</td>
                    <td>${registro.candidatoNome}</td>
                    <td><span class="votos-badge">${registro.quantidadeVotos.toLocaleString()}</span></td>
                    <td>${registro.dataEleicao ? formatarDataBR(registro.dataEleicao) : '-'}</td>
                    <td>
                        <button class="btn-item edit" onclick="editarRegistroVotos(${registro.id})" title="Editar registro">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn-item delete" onclick="removerRegistroVotos(${registro.id})" title="Remover registro">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                </tr>
            `).join('');
            
            atualizarTotalizadores();
        }

        function atualizarEstatisticasVotos() {
            const dadosVotos = JSON.parse(localStorage.getItem('dadosVotosAnalise')) || [];
            
            const totalVotos = dadosVotos.reduce((sum, r) => sum + r.quantidadeVotos, 0);
            const locaisUnicos = new Set(dadosVotos.map(r => `${r.municipio}-${r.localVotacao}`)).size;
            const candidatosUnicos = new Set(dadosVotos.map(r => r.candidatoNome).filter(c => c !== 'Não informado')).size;
            const eleicoesUnicas = new Set(dadosVotos.map(r => r.dataEleicao).filter(d => d)).size;
            
            document.getElementById('totalVotos').textContent = totalVotos.toLocaleString();
            document.getElementById('totalLocais').textContent = locaisUnicos;
            document.getElementById('totalCandidatos').textContent = candidatosUnicos;
            document.getElementById('totalEleicoes').textContent = eleicoesUnicas;
        }

        function carregarOpcoesFiltragem() {
            const dadosVotos = JSON.parse(localStorage.getItem('dadosVotosAnalise')) || [];
            
            // Municipios
            const municipios = [...new Set(dadosVotos.map(r => r.municipio))].sort();
            const selectMunicipio = document.getElementById('filtroMunicipio');
            selectMunicipio.innerHTML = '<option value="">Todos os municípios</option>' + 
                municipios.map(m => `<option value="${m}">${m}</option>`).join('');
            
            // Zonas
            const zonas = [...new Set(dadosVotos.map(r => r.zonaEleitoral))].sort();
            const selectZona = document.getElementById('filtroZona');
            selectZona.innerHTML = '<option value="">Todas as zonas</option>' + 
                zonas.map(z => `<option value="${z}">${z}</option>`).join('');
            
            // Bairros
            const bairros = [...new Set(dadosVotos.map(r => r.bairroVotacao))].sort();
            const selectBairro = document.getElementById('filtroBairroVotos');
            selectBairro.innerHTML = '<option value="">Todos os bairros</option>' + 
                bairros.map(b => `<option value="${b}">${b}</option>`).join('');
            
            // Locais
            const locais = [...new Set(dadosVotos.map(r => r.localVotacao))].sort();
            const selectLocal = document.getElementById('filtroLocal');
            selectLocal.innerHTML = '<option value="">Todos os locais</option>' + 
                locais.map(l => `<option value="${l}">${l}</option>`).join('');
            
            // Candidatos
            const candidatos = [...new Set(dadosVotos.map(r => r.candidatoNome).filter(c => c !== 'Não informado'))].sort();
            const selectCandidato = document.getElementById('filtroCandidato');
            selectCandidato.innerHTML = '<option value="">Todos os candidatos</option>' + 
                candidatos.map(c => `<option value="${c}">${c}</option>`).join('');
        }

        function aplicarFiltros() {
            const dadosVotos = JSON.parse(localStorage.getItem('dadosVotosAnalise')) || [];
            
            const filtroMunicipio = document.getElementById('filtroMunicipio').value;
            const filtroZona = document.getElementById('filtroZona').value;
            const filtroBairro = document.getElementById('filtroBairroVotos').value;
            const filtroLocal = document.getElementById('filtroLocal').value;
            const filtroCandidato = document.getElementById('filtroCandidato').value;
            
            dadosVotosFiltrados = dadosVotos.filter(registro => {
                return (!filtroMunicipio || registro.municipio === filtroMunicipio) &&
                       (!filtroZona || registro.zonaEleitoral === filtroZona) &&
                       (!filtroBairro || registro.bairroVotacao === filtroBairro) &&
                       (!filtroLocal || registro.localVotacao === filtroLocal) &&
                       (!filtroCandidato || registro.candidatoNome === filtroCandidato);
            });
            
            carregarDadosVotos();
            atualizarChartsVotos();
        }

        function limparFiltros() {
            document.getElementById('filtroMunicipio').value = '';
            document.getElementById('filtroZona').value = '';
            document.getElementById('filtroBairroVotos').value = '';
            document.getElementById('filtroLocal').value = '';
            document.getElementById('filtroCandidato').value = '';
            aplicarFiltros();
        }

        function atualizarChartsVotos() {
            if (!chartVotosBarras || !chartVotosPizza) return;
            
            // Atualizar gráfico de barras - Votos por local
            const votosPorLocal = {};
            dadosVotosFiltrados.forEach(registro => {
                const local = registro.localVotacao;
                votosPorLocal[local] = (votosPorLocal[local] || 0) + registro.quantidadeVotos;
            });
            
            const locaisOrdenados = Object.entries(votosPorLocal)
                .sort(([,a], [,b]) => b - a)
                .slice(0, 10); // Top 10 locais
            
            chartVotosBarras.data.labels = locaisOrdenados.map(([local]) => local);
            chartVotosBarras.data.datasets[0].data = locaisOrdenados.map(([,votos]) => votos);
            chartVotosBarras.update();
            
            // Atualizar gráfico de pizza - Votos por candidato
            const votosPorCandidato = {};
            dadosVotosFiltrados.forEach(registro => {
                const candidato = registro.candidatoNome;
                if (candidato !== 'Não informado') {
                    votosPorCandidato[candidato] = (votosPorCandidato[candidato] || 0) + registro.quantidadeVotos;
                }
            });
            
            if (Object.keys(votosPorCandidato).length === 0) {
                chartVotosPizza.data.labels = ['Sem dados'];
                chartVotosPizza.data.datasets[0].data = [1];
            } else {
                chartVotosPizza.data.labels = Object.keys(votosPorCandidato);
                chartVotosPizza.data.datasets[0].data = Object.values(votosPorCandidato);
            }
            chartVotosPizza.update();
        }

        function atualizarTotalizadores() {
            const totalVotosFiltrados = dadosVotosFiltrados.reduce((sum, r) => sum + r.quantidadeVotos, 0);
            const totalRegistrosFiltrados = dadosVotosFiltrados.length;
            
            document.getElementById('totalVotosFiltrados').textContent = totalVotosFiltrados.toLocaleString();
            document.getElementById('totalRegistrosFiltrados').textContent = totalRegistrosFiltrados;
        }

        function buscarVotos() {
            const termo = document.getElementById('buscaVotos').value.toLowerCase();
            const dadosVotos = JSON.parse(localStorage.getItem('dadosVotosAnalise')) || [];
            
            if (!termo) {
                dadosVotosFiltrados = [...dadosVotos];
            } else {
                dadosVotosFiltrados = dadosVotos.filter(registro => 
                    registro.municipio.toLowerCase().includes(termo) ||
                    registro.zonaEleitoral.toLowerCase().includes(termo) ||
                    registro.bairroVotacao.toLowerCase().includes(termo) ||
                    registro.localVotacao.toLowerCase().includes(termo) ||
                    registro.secaoEleitoral.toLowerCase().includes(termo) ||
                    registro.candidatoNome.toLowerCase().includes(termo)
                );
            }
            
            carregarDadosVotos();
            atualizarChartsVotos();
        }

        function ordenarVotos() {
            const criterio = document.getElementById('ordenarVotos').value;
            
            dadosVotosFiltrados.sort((a, b) => {
                switch(criterio) {
                    case 'votos':
                        return b.quantidadeVotos - a.quantidadeVotos;
                    case 'municipio':
                        return a.municipio.localeCompare(b.municipio);
                    case 'candidato':
                        return a.candidatoNome.localeCompare(b.candidatoNome);
                    case 'data':
                        return new Date(b.dataCadastro) - new Date(a.dataCadastro);
                    default:
                        return 0;
                }
            });
            
            carregarDadosVotos();
        }

        function editarRegistroVotos(id) {
            const dadosVotos = JSON.parse(localStorage.getItem('dadosVotosAnalise')) || [];
            const registro = dadosVotos.find(r => r.id === id);
            
            if (!registro) return;
            
            const novoMunicipio = prompt('Município:', registro.municipio);
            if (!novoMunicipio || novoMunicipio.trim() === '') return;
            
            const novaZona = prompt('Zona Eleitoral:', registro.zonaEleitoral);
            if (!novaZona || novaZona.trim() === '') return;
            
            const novoBairro = prompt('Bairro:', registro.bairroVotacao);
            if (!novoBairro || novoBairro.trim() === '') return;
            
            const novoLocal = prompt('Local de Votação:', registro.localVotacao);
            if (!novoLocal || novoLocal.trim() === '') return;
            
            const novaSecao = prompt('Seção Eleitoral:', registro.secaoEleitoral);
            if (!novaSecao || novaSecao.trim() === '') return;
            
            const novoCandidato = prompt('Candidato:', registro.candidatoNome === 'Não informado' ? '' : registro.candidatoNome);
            
            const novosVotos = prompt('Quantidade de Votos:', registro.quantidadeVotos);
            if (!novosVotos || isNaN(novosVotos) || parseInt(novosVotos) < 0) return;
            
            registro.municipio = novoMunicipio.trim();
            registro.zonaEleitoral = novaZona.trim();
            registro.bairroVotacao = novoBairro.trim();
            registro.localVotacao = novoLocal.trim();
            registro.secaoEleitoral = novaSecao.trim();
            registro.candidatoNome = novoCandidato.trim() || 'Não informado';
            registro.quantidadeVotos = parseInt(novosVotos);
            
            localStorage.setItem('dadosVotosAnalise', JSON.stringify(dadosVotos));
            carregarDadosVotos();
            atualizarEstatisticasVotos();
            atualizarChartsVotos();
            carregarOpcoesFiltragem();
            
            alert('✅ Registro atualizado com sucesso!');
        }

        function removerRegistroVotos(id) {
            if (!confirm('Tem certeza que deseja remover este registro?')) return;
            
            const dadosVotos = JSON.parse(localStorage.getItem('dadosVotosAnalise')) || [];
            const dadosAtualizados = dadosVotos.filter(r => r.id !== id);
            
            localStorage.setItem('dadosVotosAnalise', JSON.stringify(dadosAtualizados));
            carregarDadosVotos();
            atualizarEstatisticasVotos();
            atualizarChartsVotos();
            carregarOpcoesFiltragem();
            
            alert('✅ Registro removido com sucesso!');
        }

        function exportarVotosJSON() {
            const dadosVotos = JSON.parse(localStorage.getItem('dadosVotosAnalise')) || [];
            
            if (dadosVotos.length === 0) {
                alert('❌ Não há dados para exportar.');
                return;
            }
            
            const dadosExportacao = {
                versao: '1.0',
                dataExportacao: new Date().toISOString(),
                totalRegistros: dadosVotos.length,
                totalVotos: dadosVotos.reduce((sum, r) => sum + r.quantidadeVotos, 0),
                dados: dadosVotos
            };
            
            const blob = new Blob([JSON.stringify(dadosExportacao, null, 2)], {
                type: 'application/json'
            });
            
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `analise-votos-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            alert('✅ Dados exportados em JSON com sucesso!');
        }

        function exportarVotosCSV() {
            const dadosVotos = JSON.parse(localStorage.getItem('dadosVotosAnalise')) || [];
            
            if (dadosVotos.length === 0) {
                alert('❌ Não há dados para exportar.');
                return;
            }
            
            const headers = ['Município', 'Zona Eleitoral', 'Bairro', 'Local de Votação', 'Seção Eleitoral', 'Candidato', 'Quantidade de Votos', 'Data da Eleição', 'Data de Cadastro'];
            const csvContent = [
                headers.join(','),
                ...dadosVotos.map(registro => [
                    `"${registro.municipio}"`,
                    `"${registro.zonaEleitoral}"`,
                    `"${registro.bairroVotacao}"`,
                    `"${registro.localVotacao}"`,
                    `"${registro.secaoEleitoral}"`,
                    `"${registro.candidatoNome}"`,
                    registro.quantidadeVotos,
                    `"${registro.dataEleicao || ''}"`,
                    `"${registro.dataCadastro}"`
                ].join(','))
            ].join('\n');
            
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `analise-votos-${new Date().toISOString().split('T')[0]}.csv`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            alert('✅ Dados exportados em CSV com sucesso!');
        }

        function importarVotosJSON(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            if (file.type !== 'application/json') {
                alert('❌ Por favor, selecione apenas arquivos JSON.');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const dadosImportados = JSON.parse(e.target.result);
                    
                    if (!dadosImportados.dados || !Array.isArray(dadosImportados.dados)) {
                        throw new Error('Formato de arquivo inválido.');
                    }
                    
                    if (confirm(`Importar ${dadosImportados.dados.length} registros? Isso substituirá todos os dados atuais.`)) {
                        localStorage.setItem('dadosVotosAnalise', JSON.stringify(dadosImportados.dados));
                        carregarDadosVotos();
                        atualizarEstatisticasVotos();
                        atualizarChartsVotos();
                        carregarOpcoesFiltragem();
                        alert('✅ Dados JSON importados com sucesso!');
                    }
                } catch (error) {
                    alert('❌ Erro ao importar arquivo: ' + error.message);
                }
            };
            reader.readAsText(file);
            
            event.target.value = '';
        }

        function importarVotosCSV(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            if (file.type !== 'text/csv' && !file.name.endsWith('.csv')) {
                alert('❌ Por favor, selecione apenas arquivos CSV.');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const csvContent = e.target.result;
                    const lines = csvContent.split('\n');
                    const headers = lines[0].split(',');
                    
                    if (headers.length < 7) {
                        throw new Error('Formato de CSV inválido. Verifique se possui todas as colunas necessárias.');
                    }
                    
                    const dadosImportados = [];
                    for (let i = 1; i < lines.length; i++) {
                        const line = lines[i].trim();
                        if (!line) continue;
                        
                        const values = line.split(',').map(v => v.replace(/^"|"$/g, ''));
                        
                        if (values.length >= 7) {
                            dadosImportados.push({
                                id: Date.now() + i,
                                municipio: values[0] || '',
                                zonaEleitoral: values[1] || '',
                                bairroVotacao: values[2] || '',
                                localVotacao: values[3] || '',
                                secaoEleitoral: values[4] || '',
                                candidatoNome: values[5] || 'Não informado',
                                quantidadeVotos: parseInt(values[6]) || 0,
                                dataEleicao: values[7] || null,
                                dataCadastro: new Date().toISOString()
                            });
                        }
                    }
                    
                    if (dadosImportados.length === 0) {
                        throw new Error('Nenhum dado válido encontrado no arquivo.');
                    }
                    
                    if (confirm(`Importar ${dadosImportados.length} registros? Isso substituirá todos os dados atuais.`)) {
                        localStorage.setItem('dadosVotosAnalise', JSON.stringify(dadosImportados));
                        carregarDadosVotos();
                        atualizarEstatisticasVotos();
                        atualizarChartsVotos();
                        carregarOpcoesFiltragem();
                        alert('✅ Dados CSV importados com sucesso!');
                    }
                } catch (error) {
                    alert('❌ Erro ao importar arquivo CSV: ' + error.message);
                }
            };
            reader.readAsText(file);
            
            event.target.value = '';
        }

        function resetarDadosVotos() {
            if (!confirm('⚠️ Tem certeza que deseja limpar TODOS os dados de análise de votos? Esta ação não pode ser desfeita.')) {
                return;
            }
            
            localStorage.removeItem('dadosVotosAnalise');
            carregarDadosVotos();
            atualizarEstatisticasVotos();
            atualizarChartsVotos();
            carregarOpcoesFiltragem();
            
            alert('✅ Todos os dados foram limpos.');
        }

        // ===== SISTEMA MAPA ELEITORAL =====
        
        var mapaEleitoral = null;
        var chartDistribuicaoMapa = null;
        var marcadoresMapa = [];
        var marcadoresVisiveis = true;
        var dadosMapaFiltrados = [];
        
        const CORES_MAPA = [
            '#1e40af', '#dc2626', '#059669', '#7c3aed', '#ea580c',
            '#0891b2', '#be185d', '#4338ca', '#16a34a', '#c2410c',
            '#7c2d12', '#166534', '#0c4a6e', '#581c87', '#92400e'
        ];

        function inicializarMapaEleitoral() {
            if (!document.getElementById('mapaEleitoral')) {
                return;
            }
            
            setTimeout(() => {
                if (typeof L !== 'undefined' && typeof Chart !== 'undefined') {
                    inicializarMapa();
                    inicializarChartDistribuicao();
                    carregarBairrosMapa();
                    atualizarEstatisticasMapa();
                    carregarFiltrosMapa();
                    console.log('✅ Mapa Eleitoral inicializado');
                } else {
                    setTimeout(inicializarMapaEleitoral, 1000);
                }
            }, 500);
        }

        function inicializarMapa() {
            const mapaContainer = document.getElementById('mapaEleitoral');
            const loading = document.getElementById('mapaLoading');
            
            if (!mapaContainer) return;
            
            try {
                // Coordenadas de Monte Santo-BA
                const coordenadasMonteSanto = [-10.4372, -39.3320];
                
                mapaEleitoral = L.map('mapaEleitoral').setView(coordenadasMonteSanto, 13);
                
                // Adicionar camada do mapa
                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    attribution: '© OpenStreetMap contributors',
                    maxZoom: 18
                }).addTo(mapaEleitoral);
                
                // Inicializar array de marcadores
                if (!marcadoresMapa) {
                    marcadoresMapa = [];
                }
                
                // Adicionar marcador da sede do município
                L.marker(coordenadasMonteSanto)
                    .addTo(mapaEleitoral)
                    .bindPopup('<b>Monte Santo - BA</b><br>Sede do Município')
                    .openPopup();
                
                // Ocultar loading
                if (loading) {
                    loading.classList.add('hidden');
                }
                
                // Forçar redimensionamento para responsividade
                setTimeout(() => {
                    if (mapaEleitoral) {
                        mapaEleitoral.invalidateSize();
                    }
                }, 100);
                
                console.log('✅ Mapa Leaflet inicializado');
            } catch (error) {
                console.error('❌ Erro ao inicializar mapa:', error);
                loading.innerHTML = '<p style="color: #ef4444;">Erro ao carregar mapa</p>';
            }
        }

        function inicializarChartDistribuicao() {
            const ctx = document.getElementById('chartDistribuicaoMapa');
            if (!ctx) return;
            
            if (chartDistribuicaoMapa) {
                chartDistribuicaoMapa.destroy();
            }
            
            try {
                chartDistribuicaoMapa = new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: [],
                        datasets: [{
                            data: [],
                            backgroundColor: [],
                            borderWidth: 2,
                            borderColor: '#ffffff'
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    padding: 20,
                                    usePointStyle: true,
                                    font: { size: 12 }
                                }
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        const label = context.label || '';
                                        const value = context.parsed;
                                        const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                        const percentage = ((value / total) * 100).toFixed(1);
                                        return `${label}: ${value.toLocaleString()} eleitores (${percentage}%)`;
                                    }
                                }
                            }
                        }
                    }
                });
            } catch (error) {
                console.error('❌ Erro no gráfico de distribuição:', error);
            }
        }

        function carregarBairrosMapa() {
            const bairros = JSON.parse(localStorage.getItem('bairrosMapaEleitoral')) || [];
            
            // Atualizar lista visual
            atualizarListaBairrosMapa(bairros);
            
            // Atualizar marcadores no mapa
            atualizarMarcadoresMapa(bairros);
            
            // Atualizar opções de filtros
            atualizarFiltrosBairroMapa(bairros);
        }

        function atualizarListaBairrosMapa(bairros) {
            const container = document.getElementById('listaBairrosMapa');
            if (!container) return;
            
            if (bairros.length === 0) {
                container.innerHTML = '<div class="no-items" style="text-align: center; padding: 2rem; color: var(--text-secondary);">Nenhum bairro cadastrado.</div>';
                return;
            }
            
            container.innerHTML = bairros.map(bairro => `
                <div class="bairro-card" data-id="${bairro.id}">
                    <div class="bairro-card-header">
                        <div class="bairro-info">
                            <div class="bairro-nome">
                                <div class="bairro-cor-indicator" style="background-color: ${bairro.cor}"></div>
                                ${bairro.nome}
                            </div>
                            <div class="bairro-stats">
                                <div class="bairro-stat">
                                    <i class="fas fa-users"></i>
                                    <span>${bairro.eleitores.toLocaleString()} eleitores</span>
                                </div>
                                <div class="bairro-stat">
                                    <i class="fas fa-calendar-plus"></i>
                                    <span>Cadastrado em ${formatarDataBR(bairro.dataCadastro.split('T')[0])}</span>
                                </div>
                                ${bairro.coordenadas ? `
                                <div class="bairro-stat">
                                    <i class="fas fa-map-marker-alt"></i>
                                    <span>${bairro.coordenadas}</span>
                                </div>
                                ` : ''}
                            </div>
                            ${bairro.observacoes ? `<div style="margin-top: 0.5rem; font-size: 0.85rem; color: var(--text-secondary);">${bairro.observacoes}</div>` : ''}
                        </div>
                        <div class="bairro-acoes">
                            <button class="btn-item edit" onclick="editarBairroMapa(${bairro.id})" title="Editar">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn-item delete" onclick="removerBairroMapa(${bairro.id})" title="Remover">
                                <i class="fas fa-trash"></i>
                            </button>
                            ${bairro.coordenadas ? `
                            <button class="btn-item info" onclick="centralizarNoBairro(${bairro.id})" title="Ver no Mapa">
                                <i class="fas fa-map-marker-alt"></i>
                            </button>
                            ` : ''}
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function atualizarMarcadoresMapa(bairros) {
            if (!mapaEleitoral) return;
            
            // Limpar marcadores existentes
            if (marcadoresMapa && marcadoresMapa.length > 0) {
                marcadoresMapa.forEach(marcador => mapaEleitoral.removeLayer(marcador));
            }
            marcadoresMapa = [];
            
            // Adicionar novos marcadores
            bairros.forEach(bairro => {
                if (bairro.coordenadas) {
                    try {
                        const [lat, lng] = bairro.coordenadas.split(',').map(coord => parseFloat(coord.trim()));
                        
                        if (!isNaN(lat) && !isNaN(lng)) {
                            const marcador = L.marker([lat, lng], {
                                icon: L.divIcon({
                                    className: 'custom-marker',
                                    html: `<div style="background-color: ${bairro.cor}; width: 20px; height: 20px; border-radius: 50%; border: 2px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.3);"></div>`,
                                    iconSize: [20, 20],
                                    iconAnchor: [10, 10]
                                })
                            });
                            
                            marcador.bindPopup(`
                                <div style="min-width: 200px;">
                                    <h4 style="margin: 0 0 8px 0; color: ${bairro.cor};">${bairro.nome}</h4>
                                    <p style="margin: 4px 0;"><strong>Eleitores:</strong> ${bairro.eleitores.toLocaleString()}</p>
                                    <p style="margin: 4px 0;"><strong>Coordenadas:</strong> ${bairro.coordenadas}</p>
                                    ${bairro.observacoes ? `<p style="margin: 4px 0;"><strong>Observações:</strong> ${bairro.observacoes}</p>` : ''}
                                    <small style="color: #64748b;">Cadastrado em ${formatarDataBR(bairro.dataCadastro.split('T')[0])}</small>
                                </div>
                            `);
                            
                            marcador.addTo(mapaEleitoral);
                            marcadoresMapa.push(marcador);
                        }
                    } catch (error) {
                        console.warn(`❌ Erro ao processar coordenadas do bairro ${bairro.nome}:`, error);
                    }
                }
            });
        }

        function atualizarFiltrosBairroMapa(bairros) {
            const selectBairro = document.getElementById('filtroBairroMapa');
            const selectSecao = document.getElementById('filtroSecaoMapa');
            
            if (selectBairro) {
                selectBairro.innerHTML = '<option value="">Todos os bairros</option>';
                bairros.forEach(bairro => {
                    selectBairro.innerHTML += `<option value="${bairro.id}">${bairro.nome}</option>`;
                });
            }
            
            if (selectSecao) {
                selectSecao.innerHTML = '<option value="">Todas as seções</option>';
                // Gerar seções eleitorais baseadas nos bairros
                for (let i = 1; i <= Math.max(5, bairros.length); i++) {
                    const secao = String(i).padStart(4, '0');
                    selectSecao.innerHTML += `<option value="${secao}">Seção ${secao}</option>`;
                }
            }
        }

        function atualizarEstatisticasMapa() {
            const bairros = JSON.parse(localStorage.getItem('bairrosMapaEleitoral')) || [];
            
            const totalEleitores = bairros.reduce((sum, b) => sum + b.eleitores, 0);
            const totalBairros = bairros.length;
            const maiorBairro = bairros.reduce((max, b) => b.eleitores > (max?.eleitores || 0) ? b : max, null);
            const bairrosMapeados = bairros.filter(b => b.coordenadas).length;
            const percentualMapeado = totalBairros > 0 ? Math.round((bairrosMapeados / totalBairros) * 100) : 0;
            
            // Atualizar elementos
            if (document.getElementById('totalEleitoresMapa'))
                document.getElementById('totalEleitoresMapa').textContent = totalEleitores.toLocaleString();
            if (document.getElementById('totalBairrosMapa'))
                document.getElementById('totalBairrosMapa').textContent = totalBairros;
            if (document.getElementById('maiorConcentracao'))
                document.getElementById('maiorConcentracao').textContent = maiorBairro ? maiorBairro.nome : '-';
            if (document.getElementById('percentualMapeado'))
                document.getElementById('percentualMapeado').textContent = `${percentualMapeado}%`;
            
            // Atualizar gráfico
            atualizarChartDistribuicaoMapa();
        }

        function atualizarChartDistribuicaoMapa() {
            if (!chartDistribuicaoMapa) return;
            
            const bairros = JSON.parse(localStorage.getItem('bairrosMapaEleitoral')) || [];
            
            if (bairros.length === 0) {
                chartDistribuicaoMapa.data.labels = ['Sem dados'];
                chartDistribuicaoMapa.data.datasets[0].data = [1];
                chartDistribuicaoMapa.data.datasets[0].backgroundColor = ['#e2e8f0'];
            } else {
                chartDistribuicaoMapa.data.labels = bairros.map(b => b.nome);
                chartDistribuicaoMapa.data.datasets[0].data = bairros.map(b => b.eleitores);
                chartDistribuicaoMapa.data.datasets[0].backgroundColor = bairros.map(b => b.cor);
            }
            
            chartDistribuicaoMapa.update();
        }

        function gerarCorAutomaticaMapa() {
            const bairros = JSON.parse(localStorage.getItem('bairrosMapaEleitoral')) || [];
            const corUsada = CORES_MAPA[bairros.length % CORES_MAPA.length];
            document.getElementById('corBairroMapa').value = corUsada;
        }

        function adicionarBairroMapa() {
            const nome = document.getElementById('nomeBairroMapa').value.trim();
            const eleitores = parseInt(document.getElementById('eleitoresBairroMapa').value);
            const cor = document.getElementById('corBairroMapa').value;
            const coordenadas = document.getElementById('coordenadasBairroMapa').value.trim();
            const observacoes = document.getElementById('observacoesBairroMapa').value.trim();
            
            if (!nome || !eleitores || eleitores < 0) {
                alert('❌ Preencha nome e número válido de eleitores.');
                return;
            }
            
            // Validar coordenadas se fornecidas
            if (coordenadas) {
                const coordenadasPattern = /^-?\d+\.?\d*\s*,\s*-?\d+\.?\d*$/;
                if (!coordenadasPattern.test(coordenadas)) {
                    alert('❌ Formato de coordenadas inválido. Use: latitude, longitude (ex: -10.4372, -39.3320)');
                    return;
                }
            }
            
            const bairros = JSON.parse(localStorage.getItem('bairrosMapaEleitoral')) || [];
            
            if (bairros.some(b => b.nome.toLowerCase() === nome.toLowerCase())) {
                alert('❌ Já existe um bairro com este nome.');
                return;
            }
            
            const novoBairro = {
                id: Date.now(),
                nome,
                eleitores,
                cor,
                coordenadas: coordenadas || '',
                observacoes: observacoes || '',
                dataCadastro: new Date().toISOString()
            };
            
            bairros.push(novoBairro);
            localStorage.setItem('bairrosMapaEleitoral', JSON.stringify(bairros));
            
            carregarBairrosMapa();
            atualizarEstatisticasMapa();
            limparFormularioBairroMapa();
            
            alert('✅ Bairro adicionado com sucesso!');
        }

        function limparFormularioBairroMapa() {
            document.getElementById('nomeBairroMapa').value = '';
            document.getElementById('eleitoresBairroMapa').value = '';
            document.getElementById('corBairroMapa').value = '#1e40af';
            document.getElementById('coordenadasBairroMapa').value = '';
            document.getElementById('observacoesBairroMapa').value = '';
        }

        function editarBairroMapa(id) {
            const bairros = JSON.parse(localStorage.getItem('bairrosMapaEleitoral')) || [];
            const bairro = bairros.find(b => b.id === id);
            
            if (!bairro) return;
            
            const novoNome = prompt('Nome do bairro:', bairro.nome);
            if (!novoNome || !novoNome.trim()) return;
            
            const novosEleitores = prompt('Número de eleitores:', bairro.eleitores);
            if (!novosEleitores || isNaN(novosEleitores) || parseInt(novosEleitores) < 0) return;
            
            const novaCor = prompt('Cor (formato #hex):', bairro.cor);
            if (!novaCor || !/^#[0-9A-F]{6}$/i.test(novaCor)) return;
            
            const novasCoordenadas = prompt('Coordenadas (latitude, longitude):', bairro.coordenadas);
            if (novasCoordenadas && !/^-?\d+\.?\d*\s*,\s*-?\d+\.?\d*$/.test(novasCoordenadas)) {
                alert('❌ Formato de coordenadas inválido.');
                return;
            }
            
            const novasObservacoes = prompt('Observações:', bairro.observacoes);
            
            bairro.nome = novoNome.trim();
            bairro.eleitores = parseInt(novosEleitores);
            bairro.cor = novaCor;
            bairro.coordenadas = novasCoordenadas || '';
            bairro.observacoes = novasObservacoes || '';
            
            localStorage.setItem('bairrosMapaEleitoral', JSON.stringify(bairros));
            carregarBairrosMapa();
            atualizarEstatisticasMapa();
            
            alert('✅ Bairro atualizado!');
        }

        function removerBairroMapa(id) {
            if (!confirm('Remover este bairro do mapa eleitoral?')) return;
            
            const bairros = JSON.parse(localStorage.getItem('bairrosMapaEleitoral')) || [];
            const bairrosAtualizados = bairros.filter(b => b.id !== id);
            
            localStorage.setItem('bairrosMapaEleitoral', JSON.stringify(bairrosAtualizados));
            carregarBairrosMapa();
            atualizarEstatisticasMapa();
            
            alert('✅ Bairro removido!');
        }

        function centralizarNoBairro(id) {
            const bairros = JSON.parse(localStorage.getItem('bairrosMapaEleitoral')) || [];
            const bairro = bairros.find(b => b.id === id);
            
            if (!bairro || !bairro.coordenadas || !mapaEleitoral) return;
            
            try {
                const [lat, lng] = bairro.coordenadas.split(',').map(coord => parseFloat(coord.trim()));
                if (!isNaN(lat) && !isNaN(lng)) {
                    mapaEleitoral.setView([lat, lng], 15);
                    
                    // Encontrar e abrir popup do marcador
                    const marcador = marcadoresMapa.find(m => 
                        m.getLatLng().lat === lat && m.getLatLng().lng === lng
                    );
                    if (marcador) {
                        marcador.openPopup();
                    }
                }
            } catch (error) {
                console.error('Erro ao centralizar no bairro:', error);
            }
        }

        // Controles do mapa
        function centralizarMapa() {
            if (mapaEleitoral) {
                mapaEleitoral.setView([-10.4372, -39.3320], 13);
            }
        }

        function aumentarZoom() {
            if (mapaEleitoral) {
                mapaEleitoral.zoomIn();
            }
        }

        function diminuirZoom() {
            if (mapaEleitoral) {
                mapaEleitoral.zoomOut();
            }
        }

        function toggleMarcadores() {
            if (!mapaEleitoral) return;
            
            marcadoresVisiveis = !marcadoresVisiveis;
            
            marcadoresMapa.forEach(marcador => {
                if (marcadoresVisiveis) {
                    marcador.addTo(mapaEleitoral);
                } else {
                    mapaEleitoral.removeLayer(marcador);
                }
            });
            
            const btn = document.querySelector('[onclick="toggleMarcadores()"]');
            if (btn) {
                btn.innerHTML = marcadoresVisiveis ? 
                    '<i class="fas fa-eye"></i> Marcadores' : 
                    '<i class="fas fa-eye-slash"></i> Marcadores';
            }
        }

        function alterarTipoGrafico() {
            const tipo = document.getElementById('tipoGraficoMapa').value;
            if (chartDistribuicaoMapa) {
                chartDistribuicaoMapa.config.type = tipo;
                chartDistribuicaoMapa.update();
            }
        }

        // Filtros e busca
        function aplicarFiltrosMapa() {
            // Implementar filtros se necessário
            carregarBairrosMapa();
        }

        function limparFiltrosMapa() {
            document.getElementById('filtroBairroMapa').value = '';
            document.getElementById('filtroCandidatoMapa').value = '';
            document.getElementById('filtroSecaoMapa').value = '';
            document.getElementById('filtroZonaMapa').value = '';
            aplicarFiltrosMapa();
        }

        function buscarBairroMapa() {
            const busca = document.getElementById('buscaBairroMapa').value.toLowerCase();
            const cards = document.querySelectorAll('.bairro-card');
            
            cards.forEach(card => {
                const nome = card.querySelector('.bairro-nome').textContent.toLowerCase();
                card.style.display = nome.includes(busca) ? 'block' : 'none';
            });
        }

        function ordenarBairrosMapa() {
            const criterio = document.getElementById('ordenarBairrosMapa').value;
            const bairros = JSON.parse(localStorage.getItem('bairrosMapaEleitoral')) || [];
            
            bairros.sort((a, b) => {
                switch(criterio) {
                    case 'nome':
                        return a.nome.localeCompare(b.nome);
                    case 'eleitores':
                        return b.eleitores - a.eleitores;
                    case 'data':
                        return new Date(b.dataCadastro) - new Date(a.dataCadastro);
                    default:
                        return 0;
                }
            });
            
            localStorage.setItem('bairrosMapaEleitoral', JSON.stringify(bairros));
            carregarBairrosMapa();
        }

        // Import/Export
        function exportarDadosMapa() {
            const bairros = JSON.parse(localStorage.getItem('bairrosMapaEleitoral')) || [];
            
            if (bairros.length === 0) {
                alert('❌ Não há dados para exportar.');
                return;
            }
            
            const dados = {
                versao: '1.0',
                dataExportacao: new Date().toISOString(),
                totalBairros: bairros.length,
                totalEleitores: bairros.reduce((sum, b) => sum + b.eleitores, 0),
                bairros: bairros
            };
            
            const blob = new Blob([JSON.stringify(dados, null, 2)], {
                type: 'application/json'
            });
            
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `mapa-eleitoral-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            alert('✅ Dados exportados!');
        }

        function importarDadosMapa(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const dados = JSON.parse(e.target.result);
                    
                    if (!dados.bairros || !Array.isArray(dados.bairros)) {
                        throw new Error('Formato inválido.');
                    }
                    
                    if (confirm(`Importar ${dados.bairros.length} bairros?`)) {
                        localStorage.setItem('bairrosMapaEleitoral', JSON.stringify(dados.bairros));
                        carregarBairrosMapa();
                        atualizarEstatisticasMapa();
                        alert('✅ Dados importados!');
                    }
                } catch (error) {
                    alert('❌ Erro: ' + error.message);
                }
            };
            reader.readAsText(file);
            event.target.value = '';
        }

        function resetarDadosMapa() {
            if (!confirm('⚠️ Limpar todos os dados do mapa eleitoral?')) return;
            
            localStorage.removeItem('bairrosMapaEleitoral');
            carregarBairrosMapa();
            atualizarEstatisticasMapa();
            
            alert('✅ Dados limpos.');
        }

        function carregarFiltrosMapa() {
            // Carregar opções iniciais dos filtros
            atualizarFiltrosBairroMapa([]);
        }

        function exportarRelatorioMapaPDF() {
            const bairros = JSON.parse(localStorage.getItem('bairrosMapaEleitoral')) || [];
            
            if (bairros.length === 0) {
                alert('❌ Não há dados para gerar o relatório.');
                return;
            }
            
            try {
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();
                
                // Configurações
                const margemEsquerda = 20;
                const margemTopo = 20;
                const larguraPagina = 170;
                let yAtual = margemTopo;
                
                // Cores do sistema
                const azulPrimario = [30, 64, 175];
                const amareloPrimario = [251, 191, 36];
                const cinzaTexto = [30, 41, 59];
                
                // Cabeçalho do relatório
                doc.setFillColor(...azulPrimario);
                doc.rect(0, 0, 210, 40, 'F');
                
                // Título
                doc.setTextColor(255, 255, 255);
                doc.setFontSize(20);
                doc.setFont('helvetica', 'bold');
                doc.text('RELATÓRIO MAPA ELEITORAL', margemEsquerda, 20);
                
                // Subtítulo
                doc.setFontSize(12);
                doc.setFont('helvetica', 'normal');
                doc.text('Vereador Emicleiton Rubem da Conceição', margemEsquerda, 28);
                doc.text('Monte Santo - Bahia', margemEsquerda, 35);
                
                // Data de geração
                const dataAtual = new Date().toLocaleDateString('pt-BR', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });
                doc.setFontSize(10);
                doc.text(`Gerado em: ${dataAtual}`, 210 - 60, 35);
                
                yAtual = 55;
                
                // Estatísticas gerais
                doc.setTextColor(...cinzaTexto);
                doc.setFontSize(16);
                doc.setFont('helvetica', 'bold');
                doc.text('📊 ESTATÍSTICAS GERAIS', margemEsquerda, yAtual);
                yAtual += 15;
                
                const totalEleitores = bairros.reduce((sum, b) => sum + b.eleitores, 0);
                const totalBairros = bairros.length;
                const maiorBairro = bairros.reduce((max, b) => b.eleitores > (max?.eleitores || 0) ? b : max, null);
                const bairrosMapeados = bairros.filter(b => b.coordenadas).length;
                
                doc.setFontSize(12);
                doc.setFont('helvetica', 'normal');
                doc.text(`• Total de Eleitores: ${totalEleitores.toLocaleString()}`, margemEsquerda, yAtual);
                yAtual += 8;
                doc.text(`• Bairros Cadastrados: ${totalBairros}`, margemEsquerda, yAtual);
                yAtual += 8;
                doc.text(`• Maior Concentração: ${maiorBairro ? maiorBairro.nome + ' (' + maiorBairro.eleitores.toLocaleString() + ' eleitores)' : 'N/A'}`, margemEsquerda, yAtual);
                yAtual += 8;
                doc.text(`• Bairros Mapeados: ${bairrosMapeados} (${Math.round((bairrosMapeados / totalBairros) * 100)}%)`, margemEsquerda, yAtual);
                yAtual += 20;
                
                // Gráfico de barras (simples)
                doc.setFontSize(16);
                doc.setFont('helvetica', 'bold');
                doc.text('📈 DISTRIBUIÇÃO POR BAIRRO', margemEsquerda, yAtual);
                yAtual += 15;
                
                // Ordenar bairros por número de eleitores
                const bairrosOrdenados = [...bairros].sort((a, b) => b.eleitores - a.eleitores).slice(0, 10);
                const maxEleitores = Math.max(...bairrosOrdenados.map(b => b.eleitores));
                const larguraGrafico = 120;
                
                bairrosOrdenados.forEach((bairro, index) => {
                    const larguraBarra = (bairro.eleitores / maxEleitores) * larguraGrafico;
                    const yBarra = yAtual + (index * 12);
                    
                    // Desenhar barra
                    doc.setFillColor(...azulPrimario);
                    doc.rect(margemEsquerda + 50, yBarra - 3, larguraBarra, 8, 'F');
                    
                    // Nome do bairro
                    doc.setTextColor(...cinzaTexto);
                    doc.setFontSize(9);
                    doc.text(bairro.nome.substring(0, 15), margemEsquerda, yBarra + 2);
                    
                    // Número de eleitores
                    doc.text(bairro.eleitores.toLocaleString(), margemEsquerda + 52 + larguraBarra, yBarra + 2);
                });
                
                yAtual += (bairrosOrdenados.length * 12) + 20;
                
                // Nova página se necessário
                if (yAtual > 250) {
                    doc.addPage();
                    yAtual = margemTopo;
                }
                
                // Tabela de dados
                doc.setFontSize(16);
                doc.setFont('helvetica', 'bold');
                doc.text('📋 DADOS DETALHADOS DOS BAIRROS', margemEsquerda, yAtual);
                yAtual += 15;
                
                // Cabeçalho da tabela
                doc.setFillColor(240, 240, 240);
                doc.rect(margemEsquerda, yAtual - 5, larguraPagina, 10, 'F');
                
                doc.setTextColor(...cinzaTexto);
                doc.setFontSize(10);
                doc.setFont('helvetica', 'bold');
                doc.text('BAIRRO', margemEsquerda + 2, yAtual + 2);
                doc.text('ELEITORES', margemEsquerda + 50, yAtual + 2);
                doc.text('COORDENADAS', margemEsquerda + 80, yAtual + 2);
                doc.text('OBSERVAÇÕES', margemEsquerda + 120, yAtual + 2);
                yAtual += 12;
                
                // Dados da tabela
                doc.setFont('helvetica', 'normal');
                bairros.forEach((bairro, index) => {
                    // Nova página se necessário
                    if (yAtual > 270) {
                        doc.addPage();
                        yAtual = margemTopo;
                        
                        // Repetir cabeçalho da tabela
                        doc.setFillColor(240, 240, 240);
                        doc.rect(margemEsquerda, yAtual - 5, larguraPagina, 10, 'F');
                        doc.setFont('helvetica', 'bold');
                        doc.text('BAIRRO', margemEsquerda + 2, yAtual + 2);
                        doc.text('ELEITORES', margemEsquerda + 50, yAtual + 2);
                        doc.text('COORDENADAS', margemEsquerda + 80, yAtual + 2);
                        doc.text('OBSERVAÇÕES', margemEsquerda + 120, yAtual + 2);
                        yAtual += 12;
                        doc.setFont('helvetica', 'normal');
                    }
                    
                    // Linha alternada
                    if (index % 2 === 0) {
                        doc.setFillColor(248, 250, 252);
                        doc.rect(margemEsquerda, yAtual - 5, larguraPagina, 10, 'F');
                    }
                    
                    // Dados do bairro
                    doc.setTextColor(...cinzaTexto);
                    doc.text(bairro.nome.substring(0, 20), margemEsquerda + 2, yAtual + 2);
                    doc.text(bairro.eleitores.toLocaleString(), margemEsquerda + 50, yAtual + 2);
                    doc.text(bairro.coordenadas || 'N/A', margemEsquerda + 80, yAtual + 2);
                    doc.text((bairro.observacoes || 'N/A').substring(0, 25), margemEsquerda + 120, yAtual + 2);
                    
                    yAtual += 10;
                });
                
                // Rodapé
                const totalPaginas = doc.internal.getNumberOfPages();
                for (let i = 1; i <= totalPaginas; i++) {
                    doc.setPage(i);
                    doc.setFontSize(8);
                    doc.setTextColor(100, 100, 100);
                    doc.text(`Página ${i} de ${totalPaginas}`, 210 - 30, 290);
                    doc.text('Gabinete Digital - Vereador Emicleiton Rubem', margemEsquerda, 290);
                }
                
                // Salvar PDF
                const nomeArquivo = `relatorio-mapa-eleitoral-${new Date().toISOString().split('T')[0]}.pdf`;
                doc.save(nomeArquivo);
                
                alert('✅ Relatório PDF gerado com sucesso!');
                
            } catch (error) {
                console.error('Erro ao gerar PDF:', error);
                alert('❌ Erro ao gerar relatório PDF. Verifique se há dados suficientes.');
            }
        }

        // Controle da sidebar mobile
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            
            if (sidebar && overlay) {
                sidebar.classList.toggle('active');
                overlay.classList.toggle('active');
                document.body.style.overflow = sidebar.classList.contains('active') ? 'hidden' : '';
            }
        }

        function closeSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            
            if (sidebar && overlay) {
                sidebar.classList.remove('active');
                overlay.classList.remove('active');
                document.body.style.overflow = '';
            }
        }

        // Fechar sidebar quando clicar em um link de navegação (mobile)
        document.addEventListener('DOMContentLoaded', function() {
            const navLinks = document.querySelectorAll('.nav-link');
            navLinks.forEach(link => {
                link.addEventListener('click', function() {
                    if (window.innerWidth <= 768) {
                        closeSidebar();
                    }
                });
            });
        });

        // ===== FUNÇÃO PARA FORÇAR SINCRONIZAÇÃO DO SITE =====
        async function forcarSincronizacaoSite() {
            const btnSync = document.querySelector('.sync-btn');
            
            try {
                // Animar botão
                btnSync.classList.add('syncing');
                btnSync.disabled = true;
                
                // Forçar atualização através de todas as formas disponíveis
                localStorage.setItem('supabase_update_trigger', Date.now().toString());
                
                // Tentar comunicar com janela pai ou opener
                if (window.parent && window.parent !== window) {
                    window.parent.postMessage({ action: 'reload' }, '*');
                }
                
                if (window.opener) {
                    window.opener.location.reload();
                }
                
                // Simular processo de sincronização
                await new Promise(resolve => setTimeout(resolve, 1500));
                
                alert('✅ Sincronização realizada! O site público deve refletir as mudanças em instantes.');
                console.log('🔄 Sincronização forçada executada');
                
            } catch (error) {
                console.error('❌ Erro na sincronização:', error);
                alert('❌ Erro ao sincronizar. Tente recarregar manualmente a página do site público.');
                
            } finally {
                // Restaurar botão
                btnSync.classList.remove('syncing');
                btnSync.disabled = false;
            }
        }

    </script>
    
    <!-- Scripts necessários para Georreferenciamento -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Admin Panel Auto Save -->
    <script src="painel_supabase_unified.js"></script>
    <!-- Cliente Supabase para Eleitores -->
    <script src="supabase-eleitores-client.js"></script>
    <!-- Painel integrado com Supabase -->
    <script src="painel-supabase-eleitores.js"></script>
</body>
</html>
<script>
// CORREÇÃO PARA CARREGAR ELEITORES CADASTRADOS
function carregarEleitoresCompleto() {
    // Carregar dados de ambos os locais
    let eleitores = JSON.parse(localStorage.getItem('eleitores') || '[]');
    const registeredUsers = JSON.parse(localStorage.getItem('registeredUsers') || '[]');
    
    // Migrar dados se necessário
    if (eleitores.length === 0 && registeredUsers.length > 0) {
        eleitores = registeredUsers.map(user => ({
            nomeCompleto: user.name || user.nomeCompleto || 'Nome não informado',
            email: user.email || 'Email não informado',
            telefone: user.phone || user.telefone || 'N/A',
            bairro: user.neighborhood || user.bairro || 'N/A',
            idade: user.age || user.idade || 'N/A',
            genero: user.gender || user.genero || 'N/A',
            dataCadastro: user.registrationDate || user.dataCadastro || new Date().toISOString(),
            id: user.id || (Date.now() + Math.random()),
            presente: false
        }));
        localStorage.setItem('eleitores', JSON.stringify(eleitores));
    }
    
    const corpoTabela = document.getElementById('corpoTabela');
    const infoTabela = document.getElementById('infoTabela');
    
    if (!corpoTabela) return;
    
    corpoTabela.innerHTML = '';
    
    if (eleitores.length === 0) {
        corpoTabela.innerHTML = `
            <tr>
                <td colspan="6" style="text-align: center; padding: 2rem; color: #666;">
                    <i class="fas fa-users" style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.3;"></i><br>
                    Nenhum eleitor cadastrado ainda.<br>
                    <small>Os cadastros aparecerão aqui automaticamente.</small>
                </td>
            </tr>
        `;
        if (infoTabela) infoTabela.textContent = 'Nenhum eleitor encontrado';
        return;
    }
    
    eleitores.forEach((eleitor, index) => {
        const row = document.createElement('tr');
        const isPresent = eleitor.presente || false;
        
        row.innerHTML = `
            <td>
                <div class="eleitor-info" style="display: flex; align-items: center; gap: 0.75rem;">
                    <div class="eleitor-avatar" style="width: 40px; height: 40px; background: linear-gradient(135deg, #1e40af, #3b82f6); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 1.1rem;">
                        ${eleitor.nomeCompleto.charAt(0).toUpperCase()}
                    </div>
                    <div class="eleitor-dados">
                        <strong style="color: #1e40af; display: block;">${eleitor.nomeCompleto}</strong>
                        <small style="color: #666; font-size: 0.85rem;">${eleitor.email}</small>
                    </div>
                </div>
            </td>
            <td style="color: #374151; font-weight: 500;">${eleitor.idade}</td>
            <td style="color: #374151; font-weight: 500;">${eleitor.genero}</td>
            <td style="color: #374151; font-weight: 500;">${eleitor.bairro}</td>
            <td style="color: #374151; font-weight: 500;">${eleitor.telefone}</td>
            <td>
                <label class="switch" style="position: relative; display: inline-block; width: 44px; height: 24px;">
                    <input type="checkbox" ${isPresent ? 'checked' : ''} onchange="togglePresenca(${index})" style="opacity: 0; width: 0; height: 0;">
                    <span class="slider" style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: 0.4s; border-radius: 24px; ${isPresent ? 'background-color: #10b981;' : ''}"></span>
                </label>
            </td>
        `;
        
        corpoTabela.appendChild(row);
    });
    
    if (infoTabela) {
        infoTabela.textContent = `Total: ${eleitores.length} eleitor(es) cadastrado(s)`;
    }
    
    // Atualizar estatísticas
    document.getElementById('totalExibidos').textContent = eleitores.length;
    document.getElementById('totalPresentes').textContent = eleitores.filter(e => e.presente).length;
    const percentual = eleitores.length > 0 ? ((eleitores.filter(e => e.presente).length / eleitores.length) * 100).toFixed(1) : 0;
    document.getElementById('percentualPresenca').textContent = percentual + '%';
}

// Sobrescrever função existente
window.carregarEleitores = carregarEleitoresCompleto;

// Adicionar evento para recarregar quando a seção de gestão for aberta
document.addEventListener('DOMContentLoaded', function() {
    const observer = new MutationObserver(function(mutations) {
        mutations.forEach(function(mutation) {
            if (mutation.type === 'attributes' && mutation.attributeName === 'style') {
                const target = mutation.target;
                if (target.id === 'gestao-eleitores' && target.style.display !== 'none') {
                    setTimeout(carregarEleitoresCompleto, 100);
                }
            }
        });
    });
    
    const gestaoSection = document.getElementById('gestao-eleitores');
    if (gestaoSection) {
        observer.observe(gestaoSection, { attributes: true });
    }
});
</script>

        // ===== CORREÇÃO DA GESTÃO DE ELEITORES =====
        // Função atualizada para migrar e unificar dados
        async function carregarDadosEleitors() {
            // Buscar dados da nova API do servidor
            let eleitoresDoServidor = [];
            try {
                console.log('🔄 Buscando eleitores da API do servidor...');
                const response = await fetch('/api/eleitores');
                if (response.ok) {
                    const result = await response.json();
                    if (result.success && result.data) {
                        eleitoresDoServidor = result.data;
                        console.log(`✅ ${eleitoresDoServidor.length} eleitores carregados da API`);
                        
                        // Sincronizar com localStorage
                        localStorage.setItem('eleitores', JSON.stringify(eleitoresDoServidor));
                    }
                } else {
                    console.warn('⚠️ API não disponível, usando dados locais');
                }
            } catch (error) {
                console.warn('⚠️ Erro ao conectar com API, usando dados locais:', error.message);
            }
            
            // Buscar dados locais como fallback
            let eleitores = eleitoresDoServidor.length > 0 ? eleitoresDoServidor : JSON.parse(localStorage.getItem('eleitores') || '[]');
            const registeredUsers = JSON.parse(localStorage.getItem('registeredUsers') || '[]');
            
            console.log('📊 Carregando dados dos eleitores...');
            console.log('Eleitores existentes:', eleitores.length);
            console.log('Usuários registrados:', registeredUsers.length);
            
            // Migrar dados de registeredUsers para eleitores
            registeredUsers.forEach(user => {
                const existe = eleitores.find(e => 
                    e.email === user.email || 
                    e.nomeCompleto === user.nomeCompleto ||
                    e.telefone === user.telefone
                );
                
                if (!existe && user.nomeCompleto) {
                    const novoEleitor = {
                        id: user.id || Date.now() + Math.random(),
                        nomeCompleto: user.nomeCompleto || user.name || '',
                        email: user.email || '',
                        telefone: user.telefone || user.phone || '',
                        idade: user.idade || user.age || calcularIdade(user.dataNascimento) || 0,
                        genero: user.genero || user.gender || '',
                        bairro: user.bairro || user.neighborhood || '',
                        cidade: user.cidade || 'Monte Santo',
                        dataCadastro: user.dataCadastro || new Date().toISOString(),
                        status: 'ativo',
                        presenca: false
                    };
                    eleitores.push(novoEleitor);
                }
            });
            
            // Salvar dados unificados
            localStorage.setItem('eleitores', JSON.stringify(eleitores));
            
            const corpoTabela = document.getElementById('corpoTabela');
            
            if (eleitores.length === 0) {
                corpoTabela.innerHTML = `
                    <tr>
                        <td colspan="7" style="text-align: center; padding: 2rem; color: #64748b;">
                            <i class="fas fa-users" style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.3;"></i><br>
                            Nenhum eleitor cadastrado ainda.<br>
                            <small>Os dados aparecerão aqui conforme as pessoas se cadastrarem no formulário.</small>
                        </td>
                    </tr>
                `;
                return;
            }
            
            // Gerar HTML da tabela
            let html = '';
            eleitores.forEach((eleitor, index) => {
                const statusClass = eleitor.status === 'ativo' ? 'ativo' : 'inativo';
                const presencaIcon = eleitor.presenca ? 'fas fa-check-circle' : 'far fa-circle';
                const presencaClass = eleitor.presenca ? 'presente' : 'ausente';
                
                html += `
                    <tr>
                        <td>${index + 1}</td>
                        <td>
                            <strong>${eleitor.nomeCompleto}</strong><br>
                            <small style="color: #64748b;">${eleitor.email || 'Email não informado'}</small>
                        </td>
                        <td>${eleitor.idade || 'N/A'}</td>
                        <td>${eleitor.genero || 'N/A'}</td>
                        <td>${eleitor.bairro || 'N/A'}</td>
                        <td>
                            <a href="tel:${eleitor.telefone}" style="color: #16a34a; text-decoration: none;">
                                <i class="fas fa-phone"></i> ${eleitor.telefone || 'N/A'}
                            </a>
                        </td>
                        <td>
                            <button class="btn-presenca ${presencaClass}" 
                                    onclick="alternarPresenca(${eleitor.id})" 
                                    title="${eleitor.presenca ? 'Marcar como ausente' : 'Marcar como presente'}">
                                <i class="${presencaIcon}"></i>
                            </button>
                        </td>
                    </tr>
                `;
            });
            
            corpoTabela.innerHTML = html;
            
            // Atualizar estatísticas
            const totalEleitores = eleitores.length;
            const presentes = eleitores.filter(e => e.presenca).length;
            
            // Buscar elementos de estatísticas se existirem
            const estatTotal = document.querySelector('#totalEleitores, .stat-number');
            const estatPresentes = document.querySelector('#totalPresentes');
            
            if (estatTotal) estatTotal.textContent = totalEleitores;
            if (estatPresentes) estatPresentes.textContent = presentes;
            
            console.log('✅ Dados carregados:', totalEleitores, 'eleitores encontrados');
        }
        
        // Função auxiliar para calcular idade
        function calcularIdade(dataNascimento) {
            if (!dataNascimento) return null;
            const hoje = new Date();
            const nascimento = new Date(dataNascimento);
            let idade = hoje.getFullYear() - nascimento.getFullYear();
            const mes = hoje.getMonth() - nascimento.getMonth();
            if (mes < 0 || (mes === 0 && hoje.getDate() < nascimento.getDate())) {
                idade--;
            }
            return idade;
        }
        
        // Forçar carregamento dos dados quando a página carregar
        document.addEventListener('DOMContentLoaded', function() {
            console.log('🔄 Carregando dados dos eleitores na inicialização...');
            setTimeout(carregarDadosEleitors, 500);
        });
        
        // Recarregar dados a cada 30 segundos
        setInterval(carregarDadosEleitors, 30000);
